Using TensorFlow backend.
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelDAQMapping found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelFramePosition found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration::DetRegistry found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibrations found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCInfo found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
2024-07-01 17:57:56.889056: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
======
TEST-> bjet_ChargedHadronEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 128)               1280      
_________________________________________________________________
batch_normalization_1 (Batch (None, 128)               512       
_________________________________________________________________
activation_1 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_2 (Batch (None, 128)               512       
_________________________________________________________________
activation_2 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_3 (Batch (None, 128)               512       
_________________________________________________________________
activation_3 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_4 (Activation)    (None, 2)                 0         
=================================================================
Total params: 36,098
Trainable params: 35,330
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 1214414 events
                         : Add Tree OutTree/sig of type Signal with 1201196 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 797707 events
                         : Add Tree OutTree/bkg of type Background with 786930 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 2169106  / sum of weights: 2.16911e+06
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.897954
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 1312594  / sum of weights: 1.31259e+06
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.828325
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 1104058
                         : Signal     -- testing events             : 1065048
                         : Signal     -- training and testing events: 2169106
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.897954
                         : Background -- training events            : 661505
                         : Background -- testing events             : 651089
                         : Background -- training and testing events: 1312594
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.828325
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.142                       -0.060                  -0.100                   -0.303                   +0.014  -0.040    +0.346            +0.170
                         :     bjet_NeutralEmEnergyFraction:                           -0.142                       +1.000                       -0.203                  -0.171                   -0.149                   +0.392  +0.074    -0.137            -0.052
                         :     bjet_ChargedEmEnergyFraction:                           -0.060                       -0.203                       +1.000                  -0.067                   -0.087                   -0.116  -0.023    -0.024            +0.097
                         :          bjet_MuonEnergyFraction:                           -0.100                       -0.171                       -0.067                  +1.000                   -0.077                   -0.111  -0.015    -0.018            +0.181
                         :         bjet_ChargedMultiplicity:                           -0.303                       -0.149                       -0.087                  -0.077                   +1.000                   +0.042  +0.293    -0.045            -0.300
                         :         bjet_NeutralMultiplicity:                           +0.014                       +0.392                       -0.116                  -0.111                   +0.042                   +1.000  +0.253    -0.376            -0.088
                         :                          bjet_pt:                           -0.040                       +0.074                       -0.023                  -0.015                   +0.293                   +0.253  +1.000    -0.075            +0.017
                         :                        bjet_aeta:                           +0.346                       -0.137                       -0.024                  -0.018                   -0.045                   -0.376  -0.075    +1.000            +0.118
                         :                fabs(bjet_charge):                           +0.170                       -0.052                       +0.097                  +0.181                   -0.300                   -0.088  +0.017    +0.118            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.164                       -0.066                  -0.092                   -0.375                   -0.012  -0.047    +0.410            +0.312
                         :     bjet_NeutralEmEnergyFraction:                           -0.164                       +1.000                       -0.184                  -0.141                   -0.159                   +0.367  +0.070    -0.134            -0.022
                         :     bjet_ChargedEmEnergyFraction:                           -0.066                       -0.184                       +1.000                  -0.042                   -0.056                   -0.095  -0.001    -0.027            +0.058
                         :          bjet_MuonEnergyFraction:                           -0.092                       -0.141                       -0.042                  +1.000                   -0.047                   -0.085  +0.008    -0.022            +0.126
                         :         bjet_ChargedMultiplicity:                           -0.375                       -0.159                       -0.056                  -0.047                   +1.000                   +0.035  +0.286    -0.106            -0.308
                         :         bjet_NeutralMultiplicity:                           -0.012                       +0.367                       -0.095                  -0.085                   +0.035                   +1.000  +0.248    -0.389            -0.074
                         :                          bjet_pt:                           -0.047                       +0.070                       -0.001                  +0.008                   +0.286                   +0.248  +1.000    -0.074            +0.005
                         :                        bjet_aeta:                           +0.410                       -0.134                       -0.027                  -0.022                   -0.106                   -0.389  -0.074    +1.000            +0.226
                         :                fabs(bjet_charge):                           +0.312                       -0.022                       +0.058                  +0.126                   -0.308                   -0.074  +0.005    +0.226            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12553                           0.15947   [                            0.0000                            1.0000 ]
                         :     bjet_NeutralEmEnergyFraction:                           0.24613                           0.15533   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.035133                           0.10985   [                            0.0000                           0.99390 ]
                         :          bjet_MuonEnergyFraction:                          0.029041                          0.098092   [                            0.0000                           0.99423 ]
                         :         bjet_ChargedMultiplicity:                            11.315                            4.3059   [                            0.0000                            50.000 ]
                         :         bjet_NeutralMultiplicity:                            10.270                            5.1248   [                            0.0000                            53.000 ]
                         :                          bjet_pt:                            60.530                            35.198   [                            30.000                            1378.2 ]
                         :                        bjet_aeta:                            1.1668                           0.79692   [                        5.4463e-07                            3.6598 ]
                         :                fabs(bjet_charge):                           0.26754                           0.20985   [                        3.5766e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.935e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.137e-03
                         :    3 : bjet_NeutralHadronEnergyFraction : 2.562e-03
                         :    4 : bjet_aeta                        : 2.382e-03
                         :    5 : bjet_ChargedMultiplicity         : 1.565e-03
                         :    6 : bjet_ChargedEmEnergyFraction     : 1.316e-03
                         :    7 : bjet_NeutralEmEnergyFraction     : 6.087e-04
                         :    8 : bjet_NeutralMultiplicity         : 2.194e-04
                         :    9 : bjet_pt                          : 8.120e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56359                            1.5187   [                           -3.1879                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                         -0.018871                            1.0272   [                           -3.2680                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2883                            1.0384   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3030                            1.0369   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0056064                            1.0136   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00041960                            1.0032   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                         0.0025117                           0.99537   [                           -3.1280                            5.7307 ]
                         :                        bjet_aeta:                         0.0024863                           0.99569   [                           -3.2515                            5.7307 ]
                         :                fabs(bjet_charge):                          0.056633                            1.1349   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
/cvmfs/cms.cern.ch/slc7_amd64_gcc700/external/py2-Keras/2.1.4-gnimlf2/lib/python2.7/site-packages/keras/models.py:942: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn('The `nb_epoch` argument in `fit` '
Train on 1765563 samples, validate on 1716137 samples
Epoch 1/300
 - 350s - loss: 0.8548 - acc: 0.5613 - val_loss: 0.6783 - val_acc: 0.5597
Epoch 2/300
 - 352s - loss: 0.8478 - acc: 0.5574 - val_loss: 0.6717 - val_acc: 0.5727
Epoch 3/300
 - 347s - loss: 0.8476 - acc: 0.5576 - val_loss: 0.6965 - val_acc: 0.5191
Epoch 4/300
 - 344s - loss: 0.8474 - acc: 0.5559 - val_loss: 0.6943 - val_acc: 0.5302
Epoch 5/300
 - 316s - loss: 0.8473 - acc: 0.5567 - val_loss: 0.6802 - val_acc: 0.5526
Epoch 6/300
 - 313s - loss: 0.8473 - acc: 0.5579 - val_loss: 0.6851 - val_acc: 0.5452
Epoch 7/300
 - 330s - loss: 0.8471 - acc: 0.5577 - val_loss: 0.6837 - val_acc: 0.5377
Epoch 8/300
 - 333s - loss: 0.8471 - acc: 0.5576 - val_loss: 0.6876 - val_acc: 0.5263
Epoch 9/300
 - 327s - loss: 0.8471 - acc: 0.5573 - val_loss: 0.6780 - val_acc: 0.5554
Epoch 10/300
 - 325s - loss: 0.8470 - acc: 0.5580 - val_loss: 0.6898 - val_acc: 0.5164
Epoch 11/300
 - 319s - loss: 0.8469 - acc: 0.5590 - val_loss: 0.6817 - val_acc: 0.5461
Epoch 12/300
 - 327s - loss: 0.8469 - acc: 0.5578 - val_loss: 0.6787 - val_acc: 0.5582
Epoch 13/300
 - 315s - loss: 0.8469 - acc: 0.5574 - val_loss: 0.6730 - val_acc: 0.5613
Epoch 14/300
 - 306s - loss: 0.8469 - acc: 0.5580 - val_loss: 0.6744 - val_acc: 0.5622
Epoch 15/300
 - 334s - loss: 0.8469 - acc: 0.5591 - val_loss: 0.6829 - val_acc: 0.5351
Epoch 16/300
 - 350s - loss: 0.8469 - acc: 0.5587 - val_loss: 0.6862 - val_acc: 0.5368
Epoch 17/300
 - 276s - loss: 0.8469 - acc: 0.5586 - val_loss: 0.6839 - val_acc: 0.5494
Epoch 18/300
 - 309s - loss: 0.8469 - acc: 0.5590 - val_loss: 0.6800 - val_acc: 0.5511
Epoch 19/300
 - 337s - loss: 0.8468 - acc: 0.5592 - val_loss: 0.6801 - val_acc: 0.5542
Epoch 20/300
 - 324s - loss: 0.8469 - acc: 0.5592 - val_loss: 0.6811 - val_acc: 0.5522
Epoch 21/300
 - 223s - loss: 0.8468 - acc: 0.5587 - val_loss: 0.6861 - val_acc: 0.5461
Epoch 22/300
 - 338s - loss: 0.8469 - acc: 0.5582 - val_loss: 0.6787 - val_acc: 0.5555
Epoch 23/300
 - 328s - loss: 0.8467 - acc: 0.5577 - val_loss: 0.6794 - val_acc: 0.5545
Epoch 24/300
 - 289s - loss: 0.8467 - acc: 0.5586 - val_loss: 0.6794 - val_acc: 0.5499
Epoch 25/300
 - 312s - loss: 0.8467 - acc: 0.5586 - val_loss: 0.6794 - val_acc: 0.5497
Epoch 26/300
 - 349s - loss: 0.8467 - acc: 0.5580 - val_loss: 0.6793 - val_acc: 0.5515
Epoch 27/300
 - 264s - loss: 0.8467 - acc: 0.5578 - val_loss: 0.6726 - val_acc: 0.5688
Epoch 28/300
 - 316s - loss: 0.8467 - acc: 0.5586 - val_loss: 0.6775 - val_acc: 0.5594
Epoch 29/300
 - 334s - loss: 0.8468 - acc: 0.5579 - val_loss: 0.6818 - val_acc: 0.5572
Epoch 30/300
 - 268s - loss: 0.8466 - acc: 0.5587 - val_loss: 0.6839 - val_acc: 0.5462
Epoch 31/300
 - 313s - loss: 0.8467 - acc: 0.5594 - val_loss: 0.6663 - val_acc: 0.5877
Epoch 32/300
 - 274s - loss: 0.8467 - acc: 0.5577 - val_loss: 0.6850 - val_acc: 0.5464
Epoch 33/300
 - 338s - loss: 0.8467 - acc: 0.5579 - val_loss: 0.6776 - val_acc: 0.5603
Epoch 34/300
 - 360s - loss: 0.8468 - acc: 0.5583 - val_loss: 0.6789 - val_acc: 0.5547
Epoch 35/300
 - 291s - loss: 0.8467 - acc: 0.5593 - val_loss: 0.6727 - val_acc: 0.5707
Epoch 36/300
 - 262s - loss: 0.8466 - acc: 0.5584 - val_loss: 0.6717 - val_acc: 0.5727
Epoch 37/300
 - 284s - loss: 0.8466 - acc: 0.5582 - val_loss: 0.6865 - val_acc: 0.5381
Epoch 38/300
 - 316s - loss: 0.8467 - acc: 0.5589 - val_loss: 0.6791 - val_acc: 0.5603
Epoch 39/300
 - 289s - loss: 0.8467 - acc: 0.5578 - val_loss: 0.6845 - val_acc: 0.5500
Epoch 40/300
 - 329s - loss: 0.8467 - acc: 0.5588 - val_loss: 0.6730 - val_acc: 0.5682
Epoch 41/300
 - 279s - loss: 0.8466 - acc: 0.5587 - val_loss: 0.6866 - val_acc: 0.5412
Epoch 42/300
 - 269s - loss: 0.8466 - acc: 0.5580 - val_loss: 0.6913 - val_acc: 0.5313
Epoch 43/300
 - 327s - loss: 0.8467 - acc: 0.5575 - val_loss: 0.6880 - val_acc: 0.5469
Epoch 44/300
 - 305s - loss: 0.8467 - acc: 0.5574 - val_loss: 0.6751 - val_acc: 0.5714
Epoch 45/300
 - 277s - loss: 0.8466 - acc: 0.5582 - val_loss: 0.6771 - val_acc: 0.5535
Epoch 46/300
 - 271s - loss: 0.8468 - acc: 0.5570 - val_loss: 0.6786 - val_acc: 0.5537
Epoch 47/300
 - 285s - loss: 0.8467 - acc: 0.5581 - val_loss: 0.6768 - val_acc: 0.5607
Epoch 48/300
 - 306s - loss: 0.8466 - acc: 0.5586 - val_loss: 0.6771 - val_acc: 0.5628
Epoch 49/300
 - 292s - loss: 0.8466 - acc: 0.5585 - val_loss: 0.6871 - val_acc: 0.5391
Epoch 50/300
 - 286s - loss: 0.8466 - acc: 0.5584 - val_loss: 0.6779 - val_acc: 0.5591
Epoch 51/300
 - 296s - loss: 0.8465 - acc: 0.5588 - val_loss: 0.6801 - val_acc: 0.5490
Epoch 52/300
 - 253s - loss: 0.8466 - acc: 0.5591 - val_loss: 0.6797 - val_acc: 0.5492
Epoch 53/300
 - 294s - loss: 0.8466 - acc: 0.5581 - val_loss: 0.6765 - val_acc: 0.5500
Epoch 54/300
 - 313s - loss: 0.8466 - acc: 0.5585 - val_loss: 0.6856 - val_acc: 0.5394
Epoch 55/300
 - 296s - loss: 0.8465 - acc: 0.5586 - val_loss: 0.6815 - val_acc: 0.5492
Epoch 56/300
 - 257s - loss: 0.8466 - acc: 0.5579 - val_loss: 0.6845 - val_acc: 0.5441
Epoch 57/300
 - 234s - loss: 0.8465 - acc: 0.5587 - val_loss: 0.6851 - val_acc: 0.5435
Epoch 58/300
 - 320s - loss: 0.8467 - acc: 0.5585 - val_loss: 0.6841 - val_acc: 0.5493
Epoch 59/300
 - 264s - loss: 0.8466 - acc: 0.5582 - val_loss: 0.6793 - val_acc: 0.5610
Epoch 60/300
 - 328s - loss: 0.8466 - acc: 0.5578 - val_loss: 0.6821 - val_acc: 0.5442
Epoch 61/300
 - 246s - loss: 0.8466 - acc: 0.5580 - val_loss: 0.6831 - val_acc: 0.5475
Epoch 00061: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 1765563 events: 1.87e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                         -0.010467                            1.0319   [                           -3.2680                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3782                           0.94131   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                         -0.010467                            1.0319   [                           -3.2680                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3782                           0.94131   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.602
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.029 (0.029)       0.194 (0.198)      0.448 (0.451)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 1716137 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 1765563 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.471451056542
auc= 0.601652230339
0.601652230339
----
bjet_ChargedHadronEnergyFraction does NOT drop AUC. we don't need it
no  bjet_ChargedHadronEnergyFraction -->AUC= 0.601652230339
AUC cut= 0.59
======
TEST-> bjet_NeutralEmEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_5 (Dense)              (None, 128)               1152      
_________________________________________________________________
batch_normalization_4 (Batch (None, 128)               512       
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_5 (Batch (None, 128)               512       
_________________________________________________________________
activation_6 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_6 (Batch (None, 128)               512       
_________________________________________________________________
activation_7 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_8 (Activation)    (None, 2)                 0         
=================================================================
Total params: 35,970
Trainable params: 35,202
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 1214414 events
                         : Add Tree OutTree/sig of type Signal with 1201196 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 797707 events
                         : Add Tree OutTree/bkg of type Background with 786930 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 2169106  / sum of weights: 2.16911e+06
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.897954
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 1312594  / sum of weights: 1.31259e+06
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.828325
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 1104058
                         : Signal     -- testing events             : 1065048
                         : Signal     -- training and testing events: 2169106
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.897954
                         : Background -- training events            : 661505
                         : Background -- testing events             : 651089
                         : Background -- training and testing events: 1312594
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.828325
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.060                  -0.100                   -0.303                   +0.014  -0.040    +0.346            +0.170
                         :     bjet_ChargedEmEnergyFraction:                           -0.060                       +1.000                  -0.067                   -0.087                   -0.116  -0.023    -0.024            +0.097
                         :          bjet_MuonEnergyFraction:                           -0.100                       -0.067                  +1.000                   -0.077                   -0.111  -0.015    -0.018            +0.181
                         :         bjet_ChargedMultiplicity:                           -0.303                       -0.087                  -0.077                   +1.000                   +0.042  +0.293    -0.045            -0.300
                         :         bjet_NeutralMultiplicity:                           +0.014                       -0.116                  -0.111                   +0.042                   +1.000  +0.253    -0.376            -0.088
                         :                          bjet_pt:                           -0.040                       -0.023                  -0.015                   +0.293                   +0.253  +1.000    -0.075            +0.017
                         :                        bjet_aeta:                           +0.346                       -0.024                  -0.018                   -0.045                   -0.376  -0.075    +1.000            +0.118
                         :                fabs(bjet_charge):                           +0.170                       +0.097                  +0.181                   -0.300                   -0.088  +0.017    +0.118            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.066                  -0.092                   -0.375                   -0.012  -0.047    +0.410            +0.312
                         :     bjet_ChargedEmEnergyFraction:                           -0.066                       +1.000                  -0.042                   -0.056                   -0.095  -0.001    -0.027            +0.058
                         :          bjet_MuonEnergyFraction:                           -0.092                       -0.042                  +1.000                   -0.047                   -0.085  +0.008    -0.022            +0.126
                         :         bjet_ChargedMultiplicity:                           -0.375                       -0.056                  -0.047                   +1.000                   +0.035  +0.286    -0.106            -0.308
                         :         bjet_NeutralMultiplicity:                           -0.012                       -0.095                  -0.085                   +0.035                   +1.000  +0.248    -0.389            -0.074
                         :                          bjet_pt:                           -0.047                       -0.001                  +0.008                   +0.286                   +0.248  +1.000    -0.074            +0.005
                         :                        bjet_aeta:                           +0.410                       -0.027                  -0.022                   -0.106                   -0.389  -0.074    +1.000            +0.226
                         :                fabs(bjet_charge):                           +0.312                       +0.058                  +0.126                   -0.308                   -0.074  +0.005    +0.226            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12553                           0.15947   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.035133                           0.10985   [                            0.0000                           0.99390 ]
                         :          bjet_MuonEnergyFraction:                          0.029041                          0.098092   [                            0.0000                           0.99423 ]
                         :         bjet_ChargedMultiplicity:                            11.315                            4.3059   [                            0.0000                            50.000 ]
                         :         bjet_NeutralMultiplicity:                            10.270                            5.1248   [                            0.0000                            53.000 ]
                         :                          bjet_pt:                            60.530                            35.198   [                            30.000                            1378.2 ]
                         :                        bjet_aeta:                            1.1668                           0.79692   [                        5.4463e-07                            3.6598 ]
                         :                fabs(bjet_charge):                           0.26754                           0.20985   [                        3.5766e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.935e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.137e-03
                         :    3 : bjet_NeutralHadronEnergyFraction : 2.562e-03
                         :    4 : bjet_aeta                        : 2.382e-03
                         :    5 : bjet_ChargedMultiplicity         : 1.565e-03
                         :    6 : bjet_ChargedEmEnergyFraction     : 1.316e-03
                         :    7 : bjet_NeutralMultiplicity         : 2.194e-04
                         :    8 : bjet_pt                          : 8.120e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56359                            1.5187   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2883                            1.0384   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3030                            1.0369   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0056064                            1.0136   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00041960                            1.0032   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                         0.0025117                           0.99537   [                           -3.1280                            5.7307 ]
                         :                        bjet_aeta:                         0.0024863                           0.99569   [                           -3.2515                            5.7307 ]
                         :                fabs(bjet_charge):                          0.056633                            1.1349   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 1765563 samples, validate on 1716137 samples
Epoch 1/300
 - 269s - loss: 0.8546 - acc: 0.5626 - val_loss: 0.6776 - val_acc: 0.5596
Epoch 2/300
 - 267s - loss: 0.8480 - acc: 0.5594 - val_loss: 0.7133 - val_acc: 0.5274
Epoch 3/300
 - 309s - loss: 0.8477 - acc: 0.5561 - val_loss: 0.6771 - val_acc: 0.5622
Epoch 4/300
 - 327s - loss: 0.8475 - acc: 0.5569 - val_loss: 0.6801 - val_acc: 0.5493
Epoch 5/300
 - 243s - loss: 0.8474 - acc: 0.5579 - val_loss: 0.6894 - val_acc: 0.5422
Epoch 6/300
 - 262s - loss: 0.8473 - acc: 0.5572 - val_loss: 0.6831 - val_acc: 0.5428
Epoch 7/300
 - 254s - loss: 0.8473 - acc: 0.5586 - val_loss: 0.6870 - val_acc: 0.5380
Epoch 8/300
 - 219s - loss: 0.8473 - acc: 0.5583 - val_loss: 0.6885 - val_acc: 0.5396
Epoch 9/300
 - 202s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6787 - val_acc: 0.5579
Epoch 10/300
 - 183s - loss: 0.8471 - acc: 0.5584 - val_loss: 0.6919 - val_acc: 0.5229
Epoch 11/300
 - 203s - loss: 0.8471 - acc: 0.5586 - val_loss: 0.6792 - val_acc: 0.5570
Epoch 12/300
 - 203s - loss: 0.8470 - acc: 0.5592 - val_loss: 0.6858 - val_acc: 0.5409
Epoch 13/300
 - 222s - loss: 0.8470 - acc: 0.5579 - val_loss: 0.6776 - val_acc: 0.5649
Epoch 14/300
 - 182s - loss: 0.8470 - acc: 0.5586 - val_loss: 0.6849 - val_acc: 0.5560
Epoch 15/300
 - 157s - loss: 0.8471 - acc: 0.5584 - val_loss: 0.6701 - val_acc: 0.5768
Epoch 16/300
 - 152s - loss: 0.8469 - acc: 0.5578 - val_loss: 0.6720 - val_acc: 0.5654
Epoch 17/300
 - 184s - loss: 0.8469 - acc: 0.5580 - val_loss: 0.6716 - val_acc: 0.5715
Epoch 18/300
 - 158s - loss: 0.8469 - acc: 0.5595 - val_loss: 0.6848 - val_acc: 0.5496
Epoch 19/300
 - 158s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6924 - val_acc: 0.5281
Epoch 20/300
 - 143s - loss: 0.8469 - acc: 0.5580 - val_loss: 0.6717 - val_acc: 0.5671
Epoch 21/300
 - 167s - loss: 0.8468 - acc: 0.5582 - val_loss: 0.6698 - val_acc: 0.5740
Epoch 22/300
 - 180s - loss: 0.8468 - acc: 0.5591 - val_loss: 0.6854 - val_acc: 0.5569
Epoch 23/300
 - 161s - loss: 0.8468 - acc: 0.5591 - val_loss: 0.6759 - val_acc: 0.5618
Epoch 24/300
 - 143s - loss: 0.8468 - acc: 0.5588 - val_loss: 0.6786 - val_acc: 0.5514
Epoch 25/300
 - 128s - loss: 0.8468 - acc: 0.5587 - val_loss: 0.6764 - val_acc: 0.5622
Epoch 26/300
 - 141s - loss: 0.8468 - acc: 0.5580 - val_loss: 0.6871 - val_acc: 0.5420
Epoch 27/300
 - 155s - loss: 0.8468 - acc: 0.5584 - val_loss: 0.6939 - val_acc: 0.5166
Epoch 28/300
 - 138s - loss: 0.8468 - acc: 0.5588 - val_loss: 0.6739 - val_acc: 0.5644
Epoch 29/300
 - 132s - loss: 0.8468 - acc: 0.5594 - val_loss: 0.6840 - val_acc: 0.5465
Epoch 30/300
 - 142s - loss: 0.8468 - acc: 0.5597 - val_loss: 0.6815 - val_acc: 0.5472
Epoch 31/300
 - 158s - loss: 0.8469 - acc: 0.5585 - val_loss: 0.6825 - val_acc: 0.5484
Epoch 32/300
 - 144s - loss: 0.8469 - acc: 0.5590 - val_loss: 0.6822 - val_acc: 0.5438
Epoch 33/300
 - 139s - loss: 0.8468 - acc: 0.5580 - val_loss: 0.6769 - val_acc: 0.5569
Epoch 34/300
 - 148s - loss: 0.8468 - acc: 0.5594 - val_loss: 0.6816 - val_acc: 0.5489
Epoch 35/300
 - 134s - loss: 0.8467 - acc: 0.5589 - val_loss: 0.6764 - val_acc: 0.5558
Epoch 36/300
 - 135s - loss: 0.8468 - acc: 0.5582 - val_loss: 0.6883 - val_acc: 0.5379
Epoch 37/300
 - 160s - loss: 0.8467 - acc: 0.5586 - val_loss: 0.6838 - val_acc: 0.5449
Epoch 38/300
 - 145s - loss: 0.8467 - acc: 0.5590 - val_loss: 0.6835 - val_acc: 0.5386
Epoch 39/300
 - 133s - loss: 0.8468 - acc: 0.5578 - val_loss: 0.6875 - val_acc: 0.5284
Epoch 40/300
 - 131s - loss: 0.8468 - acc: 0.5580 - val_loss: 0.6725 - val_acc: 0.5690
Epoch 41/300
 - 144s - loss: 0.8467 - acc: 0.5591 - val_loss: 0.6832 - val_acc: 0.5455
Epoch 42/300
 - 155s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6685 - val_acc: 0.5776
Epoch 43/300
 - 142s - loss: 0.8468 - acc: 0.5583 - val_loss: 0.6791 - val_acc: 0.5542
Epoch 44/300
 - 131s - loss: 0.8468 - acc: 0.5587 - val_loss: 0.6892 - val_acc: 0.5338
Epoch 45/300
 - 136s - loss: 0.8468 - acc: 0.5583 - val_loss: 0.6817 - val_acc: 0.5519
Epoch 46/300
 - 215s - loss: 0.8468 - acc: 0.5582 - val_loss: 0.6750 - val_acc: 0.5628
Epoch 47/300
 - 263s - loss: 0.8467 - acc: 0.5582 - val_loss: 0.6810 - val_acc: 0.5525
Epoch 48/300
 - 513s - loss: 0.8468 - acc: 0.5589 - val_loss: 0.6807 - val_acc: 0.5517
Epoch 49/300
 - 475s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6980 - val_acc: 0.5277
Epoch 50/300
 - 415s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6781 - val_acc: 0.5593
Epoch 51/300
 - 449s - loss: 0.8469 - acc: 0.5580 - val_loss: 0.6801 - val_acc: 0.5537
Epoch 52/300
 - 486s - loss: 0.8469 - acc: 0.5586 - val_loss: 0.6805 - val_acc: 0.5534
Epoch 53/300
 - 473s - loss: 0.8469 - acc: 0.5585 - val_loss: 0.6800 - val_acc: 0.5551
Epoch 54/300
 - 436s - loss: 0.8469 - acc: 0.5580 - val_loss: 0.6852 - val_acc: 0.5412
Epoch 55/300
 - 498s - loss: 0.8469 - acc: 0.5581 - val_loss: 0.6750 - val_acc: 0.5672
Epoch 56/300
 - 387s - loss: 0.8469 - acc: 0.5575 - val_loss: 0.6805 - val_acc: 0.5523
Epoch 57/300
 - 451s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6830 - val_acc: 0.5488
Epoch 58/300
 - 512s - loss: 0.8468 - acc: 0.5595 - val_loss: 0.6874 - val_acc: 0.5473
Epoch 59/300
 - 424s - loss: 0.8469 - acc: 0.5582 - val_loss: 0.6752 - val_acc: 0.5620
Epoch 60/300
 - 473s - loss: 0.8469 - acc: 0.5585 - val_loss: 0.6867 - val_acc: 0.5438
Epoch 61/300
 - 404s - loss: 0.8469 - acc: 0.5588 - val_loss: 0.6689 - val_acc: 0.5777
Epoch 62/300
 - 454s - loss: 0.8470 - acc: 0.5590 - val_loss: 0.6775 - val_acc: 0.5637
Epoch 63/300
 - 445s - loss: 0.8468 - acc: 0.5581 - val_loss: 0.6749 - val_acc: 0.5622
Epoch 64/300
 - 436s - loss: 0.8468 - acc: 0.5581 - val_loss: 0.6715 - val_acc: 0.5754
Epoch 65/300
 - 465s - loss: 0.8468 - acc: 0.5586 - val_loss: 0.6749 - val_acc: 0.5674
Epoch 66/300
 - 434s - loss: 0.8468 - acc: 0.5585 - val_loss: 0.6889 - val_acc: 0.5378
Epoch 67/300
 - 447s - loss: 0.8468 - acc: 0.5584 - val_loss: 0.6818 - val_acc: 0.5438
Epoch 68/300
 - 439s - loss: 0.8468 - acc: 0.5585 - val_loss: 0.6823 - val_acc: 0.5486
Epoch 69/300
 - 416s - loss: 0.8469 - acc: 0.5578 - val_loss: 0.6879 - val_acc: 0.5578
Epoch 70/300
 - 382s - loss: 0.8469 - acc: 0.5586 - val_loss: 0.6835 - val_acc: 0.5475
Epoch 71/300
 - 378s - loss: 0.8469 - acc: 0.5578 - val_loss: 0.6770 - val_acc: 0.5548
Epoch 72/300
 - 373s - loss: 0.8468 - acc: 0.5581 - val_loss: 0.6826 - val_acc: 0.5422
Epoch 00072: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 1765563 events: 1.95e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3782                           0.94131   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3782                           0.94131   [                           -2.7039                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.602
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.028 (0.028)       0.196 (0.201)      0.448 (0.456)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 1716137 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 1765563 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.468187448362
auc= 0.601845257108
0.601845257108
----
bjet_NeutralEmEnergyFraction does NOT drop AUC. we don't need it
no  bjet_NeutralEmEnergyFraction -->AUC= 0.601845257108
AUC cut= 0.59
======
TEST-> bjet_MuonEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_9 (Dense)              (None, 128)               1024      
_________________________________________________________________
batch_normalization_7 (Batch (None, 128)               512       
_________________________________________________________________
activation_9 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_10 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_8 (Batch (None, 128)               512       
_________________________________________________________________
activation_10 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_11 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
activation_11 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_12 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,842
Trainable params: 35,074
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 1214414 events
                         : Add Tree OutTree/sig of type Signal with 1201196 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 797707 events
                         : Add Tree OutTree/bkg of type Background with 786930 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 2169106  / sum of weights: 2.16911e+06
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.897954
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 1312594  / sum of weights: 1.31259e+06
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.828325
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 1104058
                         : Signal     -- testing events             : 1065048
                         : Signal     -- training and testing events: 2169106
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.897954
                         : Background -- training events            : 661505
                         : Background -- testing events             : 651089
                         : Background -- training and testing events: 1312594
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.828325
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.060                   -0.303                   +0.014  -0.040    +0.346            +0.170
                         :     bjet_ChargedEmEnergyFraction:                           -0.060                       +1.000                   -0.087                   -0.116  -0.023    -0.024            +0.097
                         :         bjet_ChargedMultiplicity:                           -0.303                       -0.087                   +1.000                   +0.042  +0.293    -0.045            -0.300
                         :         bjet_NeutralMultiplicity:                           +0.014                       -0.116                   +0.042                   +1.000  +0.253    -0.376            -0.088
                         :                          bjet_pt:                           -0.040                       -0.023                   +0.293                   +0.253  +1.000    -0.075            +0.017
                         :                        bjet_aeta:                           +0.346                       -0.024                   -0.045                   -0.376  -0.075    +1.000            +0.118
                         :                fabs(bjet_charge):                           +0.170                       +0.097                   -0.300                   -0.088  +0.017    +0.118            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.066                   -0.375                   -0.012  -0.047    +0.410            +0.312
                         :     bjet_ChargedEmEnergyFraction:                           -0.066                       +1.000                   -0.056                   -0.095  -0.001    -0.027            +0.058
                         :         bjet_ChargedMultiplicity:                           -0.375                       -0.056                   +1.000                   +0.035  +0.286    -0.106            -0.308
                         :         bjet_NeutralMultiplicity:                           -0.012                       -0.095                   +0.035                   +1.000  +0.248    -0.389            -0.074
                         :                          bjet_pt:                           -0.047                       -0.001                   +0.286                   +0.248  +1.000    -0.074            +0.005
                         :                        bjet_aeta:                           +0.410                       -0.027                   -0.106                   -0.389  -0.074    +1.000            +0.226
                         :                fabs(bjet_charge):                           +0.312                       +0.058                   -0.308                   -0.074  +0.005    +0.226            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12553                           0.15947   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.035133                           0.10985   [                            0.0000                           0.99390 ]
                         :         bjet_ChargedMultiplicity:                            11.315                            4.3059   [                            0.0000                            50.000 ]
                         :         bjet_NeutralMultiplicity:                            10.270                            5.1248   [                            0.0000                            53.000 ]
                         :                          bjet_pt:                            60.530                            35.198   [                            30.000                            1378.2 ]
                         :                        bjet_aeta:                            1.1668                           0.79692   [                        5.4463e-07                            3.6598 ]
                         :                fabs(bjet_charge):                           0.26754                           0.20985   [                        3.5766e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.935e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.562e-03
                         :    3 : bjet_aeta                        : 2.382e-03
                         :    4 : bjet_ChargedMultiplicity         : 1.565e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.316e-03
                         :    6 : bjet_NeutralMultiplicity         : 2.194e-04
                         :    7 : bjet_pt                          : 8.120e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56359                            1.5187   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2883                            1.0384   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0056064                            1.0136   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00041960                            1.0032   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                         0.0025117                           0.99537   [                           -3.1280                            5.7307 ]
                         :                        bjet_aeta:                         0.0024863                           0.99569   [                           -3.2515                            5.7307 ]
                         :                fabs(bjet_charge):                          0.056633                            1.1349   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 1765563 samples, validate on 1716137 samples
Epoch 1/300
 - 295s - loss: 0.8549 - acc: 0.5629 - val_loss: 0.6994 - val_acc: 0.5234
Epoch 2/300
 - 391s - loss: 0.8483 - acc: 0.5596 - val_loss: 0.6834 - val_acc: 0.5518
Epoch 3/300
 - 368s - loss: 0.8480 - acc: 0.5589 - val_loss: 0.6912 - val_acc: 0.5435
Epoch 4/300
 - 334s - loss: 0.8479 - acc: 0.5579 - val_loss: 0.6785 - val_acc: 0.5531
Epoch 5/300
 - 329s - loss: 0.8477 - acc: 0.5582 - val_loss: 0.6708 - val_acc: 0.5786
Epoch 6/300
 - 337s - loss: 0.8477 - acc: 0.5578 - val_loss: 0.6812 - val_acc: 0.5559
Epoch 7/300
 - 359s - loss: 0.8476 - acc: 0.5582 - val_loss: 0.6815 - val_acc: 0.5480
Epoch 8/300
 - 359s - loss: 0.8475 - acc: 0.5587 - val_loss: 0.6838 - val_acc: 0.5453
Epoch 9/300
 - 316s - loss: 0.8475 - acc: 0.5581 - val_loss: 0.6717 - val_acc: 0.5715
Epoch 10/300
 - 337s - loss: 0.8474 - acc: 0.5585 - val_loss: 0.6808 - val_acc: 0.5564
Epoch 11/300
 - 364s - loss: 0.8474 - acc: 0.5582 - val_loss: 0.6746 - val_acc: 0.5647
Epoch 12/300
 - 346s - loss: 0.8474 - acc: 0.5584 - val_loss: 0.6847 - val_acc: 0.5431
Epoch 13/300
 - 305s - loss: 0.8474 - acc: 0.5590 - val_loss: 0.6816 - val_acc: 0.5537
Epoch 14/300
 - 322s - loss: 0.8473 - acc: 0.5590 - val_loss: 0.6710 - val_acc: 0.5641
Epoch 15/300
 - 321s - loss: 0.8473 - acc: 0.5589 - val_loss: 0.6814 - val_acc: 0.5485
Epoch 16/300
 - 353s - loss: 0.8474 - acc: 0.5601 - val_loss: 0.6741 - val_acc: 0.5634
Epoch 17/300
 - 326s - loss: 0.8474 - acc: 0.5589 - val_loss: 0.6787 - val_acc: 0.5590
Epoch 18/300
 - 294s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6896 - val_acc: 0.5366
Epoch 19/300
 - 298s - loss: 0.8472 - acc: 0.5606 - val_loss: 0.6925 - val_acc: 0.5409
Epoch 20/300
 - 358s - loss: 0.8473 - acc: 0.5590 - val_loss: 0.6786 - val_acc: 0.5636
Epoch 21/300
 - 298s - loss: 0.8473 - acc: 0.5593 - val_loss: 0.6787 - val_acc: 0.5653
Epoch 22/300
 - 356s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6733 - val_acc: 0.5625
Epoch 23/300
 - 291s - loss: 0.8473 - acc: 0.5585 - val_loss: 0.6815 - val_acc: 0.5486
Epoch 24/300
 - 330s - loss: 0.8473 - acc: 0.5587 - val_loss: 0.6801 - val_acc: 0.5556
Epoch 25/300
 - 304s - loss: 0.8472 - acc: 0.5592 - val_loss: 0.6864 - val_acc: 0.5386
Epoch 26/300
 - 327s - loss: 0.8472 - acc: 0.5590 - val_loss: 0.6717 - val_acc: 0.5721
Epoch 27/300
 - 314s - loss: 0.8471 - acc: 0.5587 - val_loss: 0.6863 - val_acc: 0.5421
Epoch 28/300
 - 275s - loss: 0.8473 - acc: 0.5587 - val_loss: 0.6771 - val_acc: 0.5715
Epoch 29/300
 - 303s - loss: 0.8471 - acc: 0.5596 - val_loss: 0.6856 - val_acc: 0.5434
Epoch 30/300
 - 317s - loss: 0.8473 - acc: 0.5593 - val_loss: 0.6872 - val_acc: 0.5368
Epoch 31/300
 - 318s - loss: 0.8472 - acc: 0.5585 - val_loss: 0.6799 - val_acc: 0.5596
Epoch 32/300
 - 346s - loss: 0.8473 - acc: 0.5592 - val_loss: 0.6793 - val_acc: 0.5544
Epoch 33/300
 - 278s - loss: 0.8472 - acc: 0.5587 - val_loss: 0.6787 - val_acc: 0.5604
Epoch 34/300
 - 316s - loss: 0.8470 - acc: 0.5586 - val_loss: 0.6826 - val_acc: 0.5530
Epoch 35/300
 - 283s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6940 - val_acc: 0.5336
Epoch 00035: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 1765563 events: 1.14e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.024605                            1.0172   [                           -4.3947                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.601
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.025 (0.027)       0.193 (0.199)      0.448 (0.453)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 1716137 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 1765563 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.452342588573
auc= 0.601088648898
0.601088648898
----
bjet_MuonEnergyFraction does NOT drop AUC. we don't need it
no  bjet_MuonEnergyFraction -->AUC= 0.601088648898
AUC cut= 0.59
======
TEST-> bjet_NeutralMultiplicity
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_13 (Dense)             (None, 128)               896       
_________________________________________________________________
batch_normalization_10 (Batc (None, 128)               512       
_________________________________________________________________
activation_13 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_14 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_11 (Batc (None, 128)               512       
_________________________________________________________________
activation_14 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_15 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_12 (Batc (None, 128)               512       
_________________________________________________________________
activation_15 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_16 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_16 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,714
Trainable params: 34,946
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 1214414 events
                         : Add Tree OutTree/sig of type Signal with 1201196 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 797707 events
                         : Add Tree OutTree/bkg of type Background with 786930 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 2169106  / sum of weights: 2.16911e+06
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.897954
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 1312594  / sum of weights: 1.31259e+06
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.828325
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 1104058
                         : Signal     -- testing events             : 1065048
                         : Signal     -- training and testing events: 2169106
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.897954
                         : Background -- training events            : 661505
                         : Background -- testing events             : 651089
                         : Background -- training and testing events: 1312594
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.828325
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.060                   -0.303  -0.040    +0.346            +0.170
                         :     bjet_ChargedEmEnergyFraction:                           -0.060                       +1.000                   -0.087  -0.023    -0.024            +0.097
                         :         bjet_ChargedMultiplicity:                           -0.303                       -0.087                   +1.000  +0.293    -0.045            -0.300
                         :                          bjet_pt:                           -0.040                       -0.023                   +0.293  +1.000    -0.075            +0.017
                         :                        bjet_aeta:                           +0.346                       -0.024                   -0.045  -0.075    +1.000            +0.118
                         :                fabs(bjet_charge):                           +0.170                       +0.097                   -0.300  +0.017    +0.118            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.066                   -0.375  -0.047    +0.410            +0.312
                         :     bjet_ChargedEmEnergyFraction:                           -0.066                       +1.000                   -0.056  -0.001    -0.027            +0.058
                         :         bjet_ChargedMultiplicity:                           -0.375                       -0.056                   +1.000  +0.286    -0.106            -0.308
                         :                          bjet_pt:                           -0.047                       -0.001                   +0.286  +1.000    -0.074            +0.005
                         :                        bjet_aeta:                           +0.410                       -0.027                   -0.106  -0.074    +1.000            +0.226
                         :                fabs(bjet_charge):                           +0.312                       +0.058                   -0.308  +0.005    +0.226            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12553                           0.15947   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.035133                           0.10985   [                            0.0000                           0.99390 ]
                         :         bjet_ChargedMultiplicity:                            11.315                            4.3059   [                            0.0000                            50.000 ]
                         :                          bjet_pt:                            60.530                            35.198   [                            30.000                            1378.2 ]
                         :                        bjet_aeta:                            1.1668                           0.79692   [                        5.4463e-07                            3.6598 ]
                         :                fabs(bjet_charge):                           0.26754                           0.20985   [                        3.5766e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.935e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.562e-03
                         :    3 : bjet_aeta                        : 2.382e-03
                         :    4 : bjet_ChargedMultiplicity         : 1.565e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.316e-03
                         :    6 : bjet_pt                          : 8.120e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56359                            1.5187   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2883                            1.0384   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0056064                            1.0136   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                         0.0025117                           0.99537   [                           -3.1280                            5.7307 ]
                         :                        bjet_aeta:                         0.0024863                           0.99569   [                           -3.2515                            5.7307 ]
                         :                fabs(bjet_charge):                          0.056633                            1.1349   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 1765563 samples, validate on 1716137 samples
Epoch 1/300
 - 333s - loss: 0.8549 - acc: 0.5627 - val_loss: 0.6848 - val_acc: 0.5456
Epoch 2/300
 - 243s - loss: 0.8484 - acc: 0.5590 - val_loss: 0.7017 - val_acc: 0.5191
Epoch 3/300
 - 317s - loss: 0.8480 - acc: 0.5573 - val_loss: 0.6850 - val_acc: 0.5425
Epoch 4/300
 - 292s - loss: 0.8479 - acc: 0.5577 - val_loss: 0.6828 - val_acc: 0.5434
Epoch 5/300
 - 317s - loss: 0.8479 - acc: 0.5578 - val_loss: 0.6848 - val_acc: 0.5440
Epoch 6/300
 - 334s - loss: 0.8477 - acc: 0.5578 - val_loss: 0.6686 - val_acc: 0.5813
Epoch 7/300
 - 295s - loss: 0.8477 - acc: 0.5579 - val_loss: 0.6810 - val_acc: 0.5495
Epoch 8/300
 - 311s - loss: 0.8476 - acc: 0.5584 - val_loss: 0.6725 - val_acc: 0.5842
Epoch 9/300
 - 240s - loss: 0.8477 - acc: 0.5581 - val_loss: 0.6722 - val_acc: 0.5724
Epoch 10/300
 - 347s - loss: 0.8476 - acc: 0.5576 - val_loss: 0.6948 - val_acc: 0.5158
Epoch 11/300
 - 309s - loss: 0.8475 - acc: 0.5578 - val_loss: 0.6853 - val_acc: 0.5364
Epoch 12/300
 - 296s - loss: 0.8475 - acc: 0.5585 - val_loss: 0.6782 - val_acc: 0.5605
Epoch 13/300
 - 298s - loss: 0.8474 - acc: 0.5584 - val_loss: 0.6736 - val_acc: 0.5685
Epoch 14/300
 - 291s - loss: 0.8475 - acc: 0.5596 - val_loss: 0.7078 - val_acc: 0.5204
Epoch 15/300
 - 307s - loss: 0.8474 - acc: 0.5590 - val_loss: 0.6718 - val_acc: 0.5741
Epoch 16/300
 - 288s - loss: 0.8473 - acc: 0.5581 - val_loss: 0.6809 - val_acc: 0.5525
Epoch 17/300
 - 340s - loss: 0.8473 - acc: 0.5592 - val_loss: 0.6764 - val_acc: 0.5675
Epoch 18/300
 - 294s - loss: 0.8475 - acc: 0.5575 - val_loss: 0.6766 - val_acc: 0.5549
Epoch 19/300
 - 293s - loss: 0.8474 - acc: 0.5580 - val_loss: 0.6768 - val_acc: 0.5547
Epoch 20/300
 - 290s - loss: 0.8474 - acc: 0.5577 - val_loss: 0.6771 - val_acc: 0.5587
Epoch 21/300
 - 274s - loss: 0.8473 - acc: 0.5587 - val_loss: 0.6802 - val_acc: 0.5519
Epoch 22/300
 - 260s - loss: 0.8473 - acc: 0.5578 - val_loss: 0.6673 - val_acc: 0.5865
Epoch 23/300
 - 319s - loss: 0.8473 - acc: 0.5589 - val_loss: 0.6746 - val_acc: 0.5669
Epoch 24/300
 - 297s - loss: 0.8473 - acc: 0.5584 - val_loss: 0.6821 - val_acc: 0.5499
Epoch 25/300
 - 265s - loss: 0.8472 - acc: 0.5579 - val_loss: 0.6751 - val_acc: 0.5747
Epoch 26/300
 - 285s - loss: 0.8473 - acc: 0.5577 - val_loss: 0.6692 - val_acc: 0.5808
Epoch 27/300
 - 284s - loss: 0.8473 - acc: 0.5584 - val_loss: 0.6813 - val_acc: 0.5470
Epoch 28/300
 - 323s - loss: 0.8473 - acc: 0.5584 - val_loss: 0.6778 - val_acc: 0.5633
Epoch 29/300
 - 328s - loss: 0.8474 - acc: 0.5579 - val_loss: 0.6802 - val_acc: 0.5549
Epoch 30/300
 - 287s - loss: 0.8473 - acc: 0.5586 - val_loss: 0.6851 - val_acc: 0.5381
Epoch 31/300
 - 260s - loss: 0.8474 - acc: 0.5584 - val_loss: 0.6865 - val_acc: 0.5413
Epoch 32/300
 - 339s - loss: 0.8473 - acc: 0.5586 - val_loss: 0.6772 - val_acc: 0.5626
Epoch 33/300
 - 313s - loss: 0.8472 - acc: 0.5592 - val_loss: 0.6742 - val_acc: 0.5717
Epoch 34/300
 - 211s - loss: 0.8472 - acc: 0.5580 - val_loss: 0.6801 - val_acc: 0.5492
Epoch 35/300
 - 303s - loss: 0.8472 - acc: 0.5587 - val_loss: 0.6819 - val_acc: 0.5393
Epoch 36/300
 - 346s - loss: 0.8472 - acc: 0.5600 - val_loss: 0.6763 - val_acc: 0.5627
Epoch 37/300
 - 276s - loss: 0.8472 - acc: 0.5593 - val_loss: 0.6955 - val_acc: 0.5442
Epoch 38/300
 - 267s - loss: 0.8473 - acc: 0.5595 - val_loss: 0.6815 - val_acc: 0.5536
Epoch 39/300
 - 305s - loss: 0.8472 - acc: 0.5584 - val_loss: 0.6819 - val_acc: 0.5509
Epoch 40/300
 - 226s - loss: 0.8472 - acc: 0.5590 - val_loss: 0.6889 - val_acc: 0.5367
Epoch 41/300
 - 251s - loss: 0.8472 - acc: 0.5596 - val_loss: 0.6835 - val_acc: 0.5452
Epoch 42/300
 - 316s - loss: 0.8472 - acc: 0.5597 - val_loss: 0.6763 - val_acc: 0.5597
Epoch 43/300
 - 304s - loss: 0.8472 - acc: 0.5593 - val_loss: 0.6781 - val_acc: 0.5554
Epoch 44/300
 - 205s - loss: 0.8472 - acc: 0.5584 - val_loss: 0.6818 - val_acc: 0.5353
Epoch 45/300
 - 262s - loss: 0.8473 - acc: 0.5589 - val_loss: 0.6800 - val_acc: 0.5590
Epoch 46/300
 - 332s - loss: 0.8472 - acc: 0.5594 - val_loss: 0.6828 - val_acc: 0.5437
Epoch 47/300
 - 353s - loss: 0.8472 - acc: 0.5587 - val_loss: 0.6848 - val_acc: 0.5364
Epoch 48/300
 - 235s - loss: 0.8473 - acc: 0.5591 - val_loss: 0.6976 - val_acc: 0.5244
Epoch 49/300
 - 212s - loss: 0.8472 - acc: 0.5580 - val_loss: 0.6844 - val_acc: 0.5387
Epoch 50/300
 - 298s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6789 - val_acc: 0.5615
Epoch 51/300
 - 323s - loss: 0.8472 - acc: 0.5591 - val_loss: 0.6783 - val_acc: 0.5544
Epoch 52/300
 - 251s - loss: 0.8472 - acc: 0.5588 - val_loss: 0.6839 - val_acc: 0.5413
Epoch 00052: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 1765563 events: 1.52e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                        bjet_aeta:                         -0.010163                           0.99092   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.600
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.023 (0.027)       0.190 (0.200)      0.447 (0.456)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 1716137 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 1765563 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.458197010249
auc= 0.599908471868
0.599908471868
----
bjet_NeutralMultiplicity does NOT drop AUC. we don't need it
no  bjet_NeutralMultiplicity -->AUC= 0.599908471868
AUC cut= 0.59
======
TEST-> bjet_aeta
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity', 'bjet_aeta']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_17 (Dense)             (None, 128)               768       
_________________________________________________________________
batch_normalization_13 (Batc (None, 128)               512       
_________________________________________________________________
activation_17 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_18 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_14 (Batc (None, 128)               512       
_________________________________________________________________
activation_18 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_19 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_15 (Batc (None, 128)               512       
_________________________________________________________________
activation_19 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_20 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_20 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,586
Trainable params: 34,818
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2018/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 1214414 events
                         : Add Tree OutTree/sig of type Signal with 1201196 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 797707 events
                         : Add Tree OutTree/bkg of type Background with 786930 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 2169106  / sum of weights: 2.16911e+06
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.897954
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 1312594  / sum of weights: 1.31259e+06
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.828325
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 1104058
                         : Signal     -- testing events             : 1065048
                         : Signal     -- training and testing events: 2169106
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.897954
                         : Background -- training events            : 661505
                         : Background -- testing events             : 651089
                         : Background -- training and testing events: 1312594
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.828325
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.060                   -0.303  -0.040            +0.170
                         :     bjet_ChargedEmEnergyFraction:                           -0.060                       +1.000                   -0.087  -0.023            +0.097
                         :         bjet_ChargedMultiplicity:                           -0.303                       -0.087                   +1.000  +0.293            -0.300
                         :                          bjet_pt:                           -0.040                       -0.023                   +0.293  +1.000            +0.017
                         :                fabs(bjet_charge):                           +0.170                       +0.097                   -0.300  +0.017            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.066                   -0.375  -0.047            +0.312
                         :     bjet_ChargedEmEnergyFraction:                           -0.066                       +1.000                   -0.056  -0.001            +0.058
                         :         bjet_ChargedMultiplicity:                           -0.375                       -0.056                   +1.000  +0.286            -0.308
                         :                          bjet_pt:                           -0.047                       -0.001                   +0.286  +1.000            +0.005
                         :                fabs(bjet_charge):                           +0.312                       +0.058                   -0.308  +0.005            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12553                           0.15947   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.035133                           0.10985   [                            0.0000                           0.99390 ]
                         :         bjet_ChargedMultiplicity:                            11.315                            4.3059   [                            0.0000                            50.000 ]
                         :                          bjet_pt:                            60.530                            35.198   [                            30.000                            1378.2 ]
                         :                fabs(bjet_charge):                           0.26754                           0.20985   [                        3.5766e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.935e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.562e-03
                         :    3 : bjet_ChargedMultiplicity         : 1.565e-03
                         :    4 : bjet_ChargedEmEnergyFraction     : 1.316e-03
                         :    5 : bjet_pt                          : 8.120e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56359                            1.5187   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2883                            1.0384   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0056064                            1.0136   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                         0.0025117                           0.99537   [                           -3.1280                            5.7307 ]
                         :                fabs(bjet_charge):                          0.056633                            1.1349   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 1765563 samples, validate on 1716137 samples
Epoch 1/300
 - 259s - loss: 0.8551 - acc: 0.5624 - val_loss: 0.6830 - val_acc: 0.5532
Epoch 2/300
 - 181s - loss: 0.8489 - acc: 0.5588 - val_loss: 0.6922 - val_acc: 0.5382
Epoch 3/300
 - 300s - loss: 0.8488 - acc: 0.5568 - val_loss: 0.6812 - val_acc: 0.5497
Epoch 4/300
 - 307s - loss: 0.8485 - acc: 0.5582 - val_loss: 0.6860 - val_acc: 0.5481
Epoch 5/300
 - 292s - loss: 0.8485 - acc: 0.5571 - val_loss: 0.6848 - val_acc: 0.5444
Epoch 6/300
 - 175s - loss: 0.8485 - acc: 0.5569 - val_loss: 0.6810 - val_acc: 0.5569
Epoch 7/300
 - 236s - loss: 0.8484 - acc: 0.5564 - val_loss: 0.6790 - val_acc: 0.5599
Epoch 8/300
 - 340s - loss: 0.8485 - acc: 0.5577 - val_loss: 0.6745 - val_acc: 0.5702
Epoch 9/300
 - 279s - loss: 0.8484 - acc: 0.5572 - val_loss: 0.6746 - val_acc: 0.5647
Epoch 10/300
 - 228s - loss: 0.8483 - acc: 0.5577 - val_loss: 0.6781 - val_acc: 0.5499
Epoch 11/300
 - 240s - loss: 0.8484 - acc: 0.5567 - val_loss: 0.6860 - val_acc: 0.5483
Epoch 12/300
 - 280s - loss: 0.8483 - acc: 0.5576 - val_loss: 0.6846 - val_acc: 0.5369
Epoch 13/300
 - 262s - loss: 0.8485 - acc: 0.5574 - val_loss: 0.6765 - val_acc: 0.5643
Epoch 14/300
 - 239s - loss: 0.8483 - acc: 0.5578 - val_loss: 0.6891 - val_acc: 0.5373
Epoch 15/300
 - 299s - loss: 0.8483 - acc: 0.5566 - val_loss: 0.6743 - val_acc: 0.5738
Epoch 16/300
 - 229s - loss: 0.8482 - acc: 0.5577 - val_loss: 0.6774 - val_acc: 0.5597
Epoch 17/300
 - 186s - loss: 0.8481 - acc: 0.5579 - val_loss: 0.6789 - val_acc: 0.5507
Epoch 18/300
 - 277s - loss: 0.8482 - acc: 0.5580 - val_loss: 0.6846 - val_acc: 0.5463
Epoch 19/300
 - 306s - loss: 0.8482 - acc: 0.5588 - val_loss: 0.6847 - val_acc: 0.5530
Epoch 20/300
 - 253s - loss: 0.8482 - acc: 0.5583 - val_loss: 0.6838 - val_acc: 0.5513
Epoch 21/300
 - 215s - loss: 0.8482 - acc: 0.5585 - val_loss: 0.6844 - val_acc: 0.5366
Epoch 22/300
 - 206s - loss: 0.8481 - acc: 0.5583 - val_loss: 0.6833 - val_acc: 0.5481
Epoch 23/300
 - 231s - loss: 0.8481 - acc: 0.5579 - val_loss: 0.6892 - val_acc: 0.5398
Epoch 24/300
 - 314s - loss: 0.8481 - acc: 0.5580 - val_loss: 0.6800 - val_acc: 0.5540
Epoch 25/300
 - 282s - loss: 0.8482 - acc: 0.5589 - val_loss: 0.6741 - val_acc: 0.5610
Epoch 26/300
 - 260s - loss: 0.8481 - acc: 0.5582 - val_loss: 0.6794 - val_acc: 0.5520
Epoch 27/300
 - 196s - loss: 0.8481 - acc: 0.5570 - val_loss: 0.6750 - val_acc: 0.5626
Epoch 28/300
 - 199s - loss: 0.8482 - acc: 0.5581 - val_loss: 0.6715 - val_acc: 0.5791
Epoch 29/300
 - 279s - loss: 0.8482 - acc: 0.5582 - val_loss: 0.6875 - val_acc: 0.5302
Epoch 30/300
 - 246s - loss: 0.8481 - acc: 0.5583 - val_loss: 0.6876 - val_acc: 0.5426
Epoch 31/300
 - 175s - loss: 0.8481 - acc: 0.5578 - val_loss: 0.6747 - val_acc: 0.5650
Epoch 32/300
 - 179s - loss: 0.8480 - acc: 0.5573 - val_loss: 0.6774 - val_acc: 0.5665
Epoch 33/300
 - 200s - loss: 0.8481 - acc: 0.5584 - val_loss: 0.6775 - val_acc: 0.5637
Epoch 34/300
 - 264s - loss: 0.8481 - acc: 0.5587 - val_loss: 0.6884 - val_acc: 0.5390
Epoch 35/300
 - 230s - loss: 0.8481 - acc: 0.5576 - val_loss: 0.6678 - val_acc: 0.5966
Epoch 36/300
 - 193s - loss: 0.8480 - acc: 0.5584 - val_loss: 0.6786 - val_acc: 0.5601
Epoch 37/300
 - 192s - loss: 0.8480 - acc: 0.5575 - val_loss: 0.6822 - val_acc: 0.5480
Epoch 38/300
 - 215s - loss: 0.8479 - acc: 0.5587 - val_loss: 0.6818 - val_acc: 0.5522
Epoch 39/300
 - 259s - loss: 0.8480 - acc: 0.5584 - val_loss: 0.6879 - val_acc: 0.5428
Epoch 40/300
 - 222s - loss: 0.8480 - acc: 0.5591 - val_loss: 0.6822 - val_acc: 0.5502
Epoch 41/300
 - 194s - loss: 0.8481 - acc: 0.5581 - val_loss: 0.6832 - val_acc: 0.5519
Epoch 42/300
 - 173s - loss: 0.8482 - acc: 0.5580 - val_loss: 0.6797 - val_acc: 0.5520
Epoch 43/300
 - 192s - loss: 0.8481 - acc: 0.5581 - val_loss: 0.6840 - val_acc: 0.5476
Epoch 44/300
 - 208s - loss: 0.8481 - acc: 0.5580 - val_loss: 0.6777 - val_acc: 0.5578
Epoch 45/300
 - 207s - loss: 0.8480 - acc: 0.5576 - val_loss: 0.6828 - val_acc: 0.5485
Epoch 46/300
 - 244s - loss: 0.8480 - acc: 0.5574 - val_loss: 0.6915 - val_acc: 0.5390
Epoch 47/300
 - 249s - loss: 0.8480 - acc: 0.5583 - val_loss: 0.6864 - val_acc: 0.5445
Epoch 48/300
 - 193s - loss: 0.8481 - acc: 0.5579 - val_loss: 0.6778 - val_acc: 0.5578
Epoch 49/300
 - 163s - loss: 0.8480 - acc: 0.5580 - val_loss: 0.6897 - val_acc: 0.5376
Epoch 50/300
 - 156s - loss: 0.8480 - acc: 0.5578 - val_loss: 0.6791 - val_acc: 0.5536
Epoch 51/300
 - 177s - loss: 0.8480 - acc: 0.5577 - val_loss: 0.6762 - val_acc: 0.5609
Epoch 52/300
 - 202s - loss: 0.8480 - acc: 0.5577 - val_loss: 0.6938 - val_acc: 0.5277
Epoch 53/300
 - 219s - loss: 0.8481 - acc: 0.5575 - val_loss: 0.6820 - val_acc: 0.5481
Epoch 54/300
 - 177s - loss: 0.8480 - acc: 0.5569 - val_loss: 0.6752 - val_acc: 0.5677
Epoch 55/300
 - 142s - loss: 0.8480 - acc: 0.5576 - val_loss: 0.6787 - val_acc: 0.5590
Epoch 56/300
 - 149s - loss: 0.8480 - acc: 0.5580 - val_loss: 0.6830 - val_acc: 0.5520
Epoch 57/300
 - 179s - loss: 0.8481 - acc: 0.5572 - val_loss: 0.6813 - val_acc: 0.5480
Epoch 58/300
 - 184s - loss: 0.8481 - acc: 0.5578 - val_loss: 0.6806 - val_acc: 0.5471
Epoch 59/300
 - 155s - loss: 0.8481 - acc: 0.5582 - val_loss: 0.6806 - val_acc: 0.5507
Epoch 60/300
 - 160s - loss: 0.8480 - acc: 0.5579 - val_loss: 0.6733 - val_acc: 0.5649
Epoch 61/300
 - 159s - loss: 0.8480 - acc: 0.5577 - val_loss: 0.6790 - val_acc: 0.5512
Epoch 62/300
 - 156s - loss: 0.8479 - acc: 0.5586 - val_loss: 0.6866 - val_acc: 0.5497
Epoch 63/300
 - 144s - loss: 0.8479 - acc: 0.5585 - val_loss: 0.6886 - val_acc: 0.5362
Epoch 64/300
 - 173s - loss: 0.8478 - acc: 0.5580 - val_loss: 0.6967 - val_acc: 0.5171
Epoch 65/300
 - 190s - loss: 0.8480 - acc: 0.5573 - val_loss: 0.6723 - val_acc: 0.5659
Epoch 00065: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 1765563 events: 1.43e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.58187                            1.5082   [                           -3.1879                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2678                            1.0780   [                           -2.6944                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.029823                            1.0267   [                           -4.3436                            5.7307 ]
                         :                          bjet_pt:                          0.095204                            1.0247   [                           -3.1287                            5.7307 ]
                         :                fabs(bjet_charge):                          0.091846                            1.1282   [                           -3.2388                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.599
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.025 (0.026)       0.190 (0.195)      0.444 (0.451)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 1716137 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 1765563 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.492661389971
auc= 0.599085423832
0.599085423832
----
bjet_aeta does NOT drop AUC. we don't need it
no  bjet_aeta -->AUC= 0.599085423832
AUC cut= 0.59
rmlist=> ['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity', 'bjet_aeta']
/data6/Users/jhchoi/TMVA/TMVA_TOOL/Remove_Unnecessary
