Using TensorFlow backend.
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelDAQMapping found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelFramePosition found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration::DetRegistry found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibrations found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCInfo found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
2024-07-01 17:57:56.458064: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
======
TEST-> bjet_ChargedHadronEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 128)               1280      
_________________________________________________________________
batch_normalization_1 (Batch (None, 128)               512       
_________________________________________________________________
activation_1 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_2 (Batch (None, 128)               512       
_________________________________________________________________
activation_2 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_3 (Batch (None, 128)               512       
_________________________________________________________________
activation_3 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_4 (Activation)    (None, 2)                 0         
=================================================================
Total params: 36,098
Trainable params: 35,330
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 387726 events
                         : Add Tree OutTree/sig of type Signal with 440734 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 273702 events
                         : Add Tree OutTree/bkg of type Background with 310379 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 741265  / sum of weights: 741265
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89475
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 449586  / sum of weights: 449586
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.769732
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 403391
                         : Signal     -- testing events             : 337874
                         : Signal     -- training and testing events: 741265
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89475
                         : Background -- training events            : 242119
                         : Background -- testing events             : 207467
                         : Background -- training and testing events: 449586
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.769732
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.049                       -0.054                  -0.103                   -0.350                   +0.022  -0.035    +0.297            +0.169
                         :     bjet_NeutralEmEnergyFraction:                           -0.049                       +1.000                       -0.222                  -0.184                   -0.196                   +0.344  +0.062    -0.014            +0.020
                         :     bjet_ChargedEmEnergyFraction:                           -0.054                       -0.222                       +1.000                  -0.070                   -0.084                   -0.141  -0.028    -0.006            +0.086
                         :          bjet_MuonEnergyFraction:                           -0.103                       -0.184                       -0.070                  +1.000                   -0.076                   -0.133  -0.018    -0.002            +0.174
                         :         bjet_ChargedMultiplicity:                           -0.350                       -0.196                       -0.084                  -0.076                   +1.000                   +0.227  +0.323    -0.245            -0.343
                         :         bjet_NeutralMultiplicity:                           +0.022                       +0.344                       -0.141                  -0.133                   +0.227                   +1.000  +0.262    -0.253            -0.121
                         :                          bjet_pt:                           -0.035                       +0.062                       -0.028                  -0.018                   +0.323                   +0.262  +1.000    -0.070            -0.002
                         :                        bjet_aeta:                           +0.297                       -0.014                       -0.006                  -0.002                   -0.245                   -0.253  -0.070    +1.000            +0.152
                         :                fabs(bjet_charge):                           +0.169                       +0.020                       +0.086                  +0.174                   -0.343                   -0.121  -0.002    +0.152            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.027                       -0.059                  -0.090                   -0.427                   -0.020  -0.044    +0.360            +0.307
                         :     bjet_NeutralEmEnergyFraction:                           -0.027                       +1.000                       -0.211                  -0.157                   -0.247                   +0.305  +0.052    +0.034            +0.102
                         :     bjet_ChargedEmEnergyFraction:                           -0.059                       -0.211                       +1.000                  -0.044                   -0.056                   -0.119  -0.006    -0.004            +0.052
                         :          bjet_MuonEnergyFraction:                           -0.090                       -0.157                       -0.044                  +1.000                   -0.044                   -0.099  +0.000    -0.011            +0.111
                         :         bjet_ChargedMultiplicity:                           -0.427                       -0.247                       -0.056                  -0.044                   +1.000                   +0.238  +0.315    -0.314            -0.368
                         :         bjet_NeutralMultiplicity:                           -0.020                       +0.305                       -0.119                  -0.099                   +0.238                   +1.000  +0.262    -0.279            -0.113
                         :                          bjet_pt:                           -0.044                       +0.052                       -0.006                  +0.000                   +0.315                   +0.262  +1.000    -0.073            -0.009
                         :                        bjet_aeta:                           +0.360                       +0.034                       -0.004                  -0.011                   -0.314                   -0.279  -0.073    +1.000            +0.259
                         :                fabs(bjet_charge):                           +0.307                       +0.102                       +0.052                  +0.111                   -0.368                   -0.113  -0.009    +0.259            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.11750                           0.14215   [                            0.0000                            1.0000 ]
                         :     bjet_NeutralEmEnergyFraction:                           0.25969                           0.16123   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038398                           0.11532   [                            0.0000                            1.0000 ]
                         :          bjet_MuonEnergyFraction:                          0.029673                           0.10067   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            10.371                            4.1624   [                            0.0000                            44.000 ]
                         :         bjet_NeutralMultiplicity:                            10.091                            4.8707   [                            0.0000                            50.000 ]
                         :                          bjet_pt:                            60.465                            35.491   [                            30.000                            1568.3 ]
                         :                        bjet_aeta:                            1.1204                           0.74794   [                        1.4975e-06                            3.1285 ]
                         :                fabs(bjet_charge):                           0.28828                           0.22597   [                        4.3649e-06                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.999e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.411e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.506e-03
                         :    4 : bjet_aeta                        : 2.488e-03
                         :    5 : bjet_NeutralHadronEnergyFraction : 2.368e-03
                         :    6 : bjet_NeutralEmEnergyFraction     : 1.429e-03
                         :    7 : bjet_ChargedEmEnergyFraction     : 1.009e-03
                         :    8 : bjet_NeutralMultiplicity         : 4.157e-04
                         :    9 : bjet_pt                          : 1.161e-04
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61256                            1.5521   [                           -3.2251                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                        -0.0077665                            1.0129   [                           -3.2727                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2874                            1.0859   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3066                            1.0078   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0093385                            1.0090   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00013250                           0.99484   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                         0.0020690                           0.99447   [                           -3.1252                            5.7307 ]
                         :                        bjet_aeta:                         0.0020022                           0.99497   [                           -3.2529                            5.7307 ]
                         :                fabs(bjet_charge):                           0.10622                            1.2344   [                           -3.2381                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
/cvmfs/cms.cern.ch/slc7_amd64_gcc700/external/py2-Keras/2.1.4-gnimlf2/lib/python2.7/site-packages/keras/models.py:942: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn('The `nb_epoch` argument in `fit` '
Train on 645510 samples, validate on 545341 samples
Epoch 1/300
 - 128s - loss: 0.8638 - acc: 0.5632 - val_loss: 0.6915 - val_acc: 0.5469
Epoch 2/300
 - 128s - loss: 0.8493 - acc: 0.5607 - val_loss: 0.6761 - val_acc: 0.5631
Epoch 3/300
 - 130s - loss: 0.8480 - acc: 0.5610 - val_loss: 0.6883 - val_acc: 0.5381
Epoch 4/300
 - 110s - loss: 0.8476 - acc: 0.5597 - val_loss: 0.6812 - val_acc: 0.5565
Epoch 5/300
 - 125s - loss: 0.8473 - acc: 0.5586 - val_loss: 0.6710 - val_acc: 0.5752
Epoch 6/300
 - 119s - loss: 0.8472 - acc: 0.5583 - val_loss: 0.6814 - val_acc: 0.5499
Epoch 7/300
 - 127s - loss: 0.8471 - acc: 0.5588 - val_loss: 0.6891 - val_acc: 0.5350
Epoch 8/300
 - 118s - loss: 0.8473 - acc: 0.5577 - val_loss: 0.6831 - val_acc: 0.5470
Epoch 9/300
 - 127s - loss: 0.8471 - acc: 0.5583 - val_loss: 0.6839 - val_acc: 0.5558
Epoch 10/300
 - 120s - loss: 0.8472 - acc: 0.5581 - val_loss: 0.6786 - val_acc: 0.5578
Epoch 11/300
 - 122s - loss: 0.8470 - acc: 0.5574 - val_loss: 0.6841 - val_acc: 0.5410
Epoch 12/300
 - 121s - loss: 0.8468 - acc: 0.5583 - val_loss: 0.6798 - val_acc: 0.5583
Epoch 13/300
 - 125s - loss: 0.8469 - acc: 0.5591 - val_loss: 0.6761 - val_acc: 0.5538
Epoch 14/300
 - 109s - loss: 0.8469 - acc: 0.5577 - val_loss: 0.6827 - val_acc: 0.5524
Epoch 15/300
 - 112s - loss: 0.8468 - acc: 0.5587 - val_loss: 0.6943 - val_acc: 0.5289
Epoch 16/300
 - 110s - loss: 0.8468 - acc: 0.5591 - val_loss: 0.6801 - val_acc: 0.5611
Epoch 17/300
 - 97s - loss: 0.8468 - acc: 0.5592 - val_loss: 0.6805 - val_acc: 0.5524
Epoch 18/300
 - 116s - loss: 0.8467 - acc: 0.5604 - val_loss: 0.6766 - val_acc: 0.5652
Epoch 19/300
 - 119s - loss: 0.8468 - acc: 0.5606 - val_loss: 0.6735 - val_acc: 0.5691
Epoch 20/300
 - 113s - loss: 0.8467 - acc: 0.5592 - val_loss: 0.6810 - val_acc: 0.5493
Epoch 21/300
 - 120s - loss: 0.8466 - acc: 0.5594 - val_loss: 0.6777 - val_acc: 0.5628
Epoch 22/300
 - 129s - loss: 0.8467 - acc: 0.5592 - val_loss: 0.6923 - val_acc: 0.5219
Epoch 23/300
 - 105s - loss: 0.8467 - acc: 0.5595 - val_loss: 0.6877 - val_acc: 0.5506
Epoch 24/300
 - 114s - loss: 0.8467 - acc: 0.5597 - val_loss: 0.6826 - val_acc: 0.5508
Epoch 25/300
 - 105s - loss: 0.8468 - acc: 0.5592 - val_loss: 0.6807 - val_acc: 0.5524
Epoch 26/300
 - 118s - loss: 0.8466 - acc: 0.5588 - val_loss: 0.6818 - val_acc: 0.5589
Epoch 27/300
 - 129s - loss: 0.8467 - acc: 0.5595 - val_loss: 0.6849 - val_acc: 0.5419
Epoch 28/300
 - 107s - loss: 0.8467 - acc: 0.5605 - val_loss: 0.6772 - val_acc: 0.5631
Epoch 29/300
 - 117s - loss: 0.8465 - acc: 0.5596 - val_loss: 0.6761 - val_acc: 0.5686
Epoch 30/300
 - 118s - loss: 0.8464 - acc: 0.5611 - val_loss: 0.6796 - val_acc: 0.5595
Epoch 31/300
 - 93s - loss: 0.8465 - acc: 0.5609 - val_loss: 0.6757 - val_acc: 0.5667
Epoch 32/300
 - 119s - loss: 0.8467 - acc: 0.5608 - val_loss: 0.6834 - val_acc: 0.5515
Epoch 33/300
 - 127s - loss: 0.8464 - acc: 0.5615 - val_loss: 0.6770 - val_acc: 0.5652
Epoch 34/300
 - 113s - loss: 0.8465 - acc: 0.5612 - val_loss: 0.6866 - val_acc: 0.5343
Epoch 35/300
 - 114s - loss: 0.8465 - acc: 0.5603 - val_loss: 0.6800 - val_acc: 0.5608
Epoch 00035: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 645510 events: 4.13e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                         0.0038719                            1.0167   [                           -3.2727                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3491                           0.96267   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                         0.0038719                            1.0167   [                           -3.2727                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3491                           0.96267   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.598
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.027 (0.030)       0.191 (0.198)      0.444 (0.451)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 545341 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 645510 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.481152242869
auc= 0.598174059536
0.598174059536
----
bjet_ChargedHadronEnergyFraction does NOT drop AUC. we don't need it
no  bjet_ChargedHadronEnergyFraction -->AUC= 0.598174059536
AUC cut= 0.59
======
TEST-> bjet_NeutralEmEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_5 (Dense)              (None, 128)               1152      
_________________________________________________________________
batch_normalization_4 (Batch (None, 128)               512       
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_5 (Batch (None, 128)               512       
_________________________________________________________________
activation_6 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_6 (Batch (None, 128)               512       
_________________________________________________________________
activation_7 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_8 (Activation)    (None, 2)                 0         
=================================================================
Total params: 35,970
Trainable params: 35,202
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 387726 events
                         : Add Tree OutTree/sig of type Signal with 440734 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 273702 events
                         : Add Tree OutTree/bkg of type Background with 310379 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 741265  / sum of weights: 741265
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89475
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 449586  / sum of weights: 449586
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.769732
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 403391
                         : Signal     -- testing events             : 337874
                         : Signal     -- training and testing events: 741265
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89475
                         : Background -- training events            : 242119
                         : Background -- testing events             : 207467
                         : Background -- training and testing events: 449586
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.769732
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.054                  -0.103                   -0.350                   +0.022  -0.035    +0.297            +0.169
                         :     bjet_ChargedEmEnergyFraction:                           -0.054                       +1.000                  -0.070                   -0.084                   -0.141  -0.028    -0.006            +0.086
                         :          bjet_MuonEnergyFraction:                           -0.103                       -0.070                  +1.000                   -0.076                   -0.133  -0.018    -0.002            +0.174
                         :         bjet_ChargedMultiplicity:                           -0.350                       -0.084                  -0.076                   +1.000                   +0.227  +0.323    -0.245            -0.343
                         :         bjet_NeutralMultiplicity:                           +0.022                       -0.141                  -0.133                   +0.227                   +1.000  +0.262    -0.253            -0.121
                         :                          bjet_pt:                           -0.035                       -0.028                  -0.018                   +0.323                   +0.262  +1.000    -0.070            -0.002
                         :                        bjet_aeta:                           +0.297                       -0.006                  -0.002                   -0.245                   -0.253  -0.070    +1.000            +0.152
                         :                fabs(bjet_charge):                           +0.169                       +0.086                  +0.174                   -0.343                   -0.121  -0.002    +0.152            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.059                  -0.090                   -0.427                   -0.020  -0.044    +0.360            +0.307
                         :     bjet_ChargedEmEnergyFraction:                           -0.059                       +1.000                  -0.044                   -0.056                   -0.119  -0.006    -0.004            +0.052
                         :          bjet_MuonEnergyFraction:                           -0.090                       -0.044                  +1.000                   -0.044                   -0.099  +0.000    -0.011            +0.111
                         :         bjet_ChargedMultiplicity:                           -0.427                       -0.056                  -0.044                   +1.000                   +0.238  +0.315    -0.314            -0.368
                         :         bjet_NeutralMultiplicity:                           -0.020                       -0.119                  -0.099                   +0.238                   +1.000  +0.262    -0.279            -0.113
                         :                          bjet_pt:                           -0.044                       -0.006                  +0.000                   +0.315                   +0.262  +1.000    -0.073            -0.009
                         :                        bjet_aeta:                           +0.360                       -0.004                  -0.011                   -0.314                   -0.279  -0.073    +1.000            +0.259
                         :                fabs(bjet_charge):                           +0.307                       +0.052                  +0.111                   -0.368                   -0.113  -0.009    +0.259            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.11750                           0.14215   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038398                           0.11532   [                            0.0000                            1.0000 ]
                         :          bjet_MuonEnergyFraction:                          0.029673                           0.10067   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            10.371                            4.1624   [                            0.0000                            44.000 ]
                         :         bjet_NeutralMultiplicity:                            10.091                            4.8707   [                            0.0000                            50.000 ]
                         :                          bjet_pt:                            60.465                            35.491   [                            30.000                            1568.3 ]
                         :                        bjet_aeta:                            1.1204                           0.74794   [                        1.4975e-06                            3.1285 ]
                         :                fabs(bjet_charge):                           0.28828                           0.22597   [                        4.3649e-06                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.999e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.411e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.506e-03
                         :    4 : bjet_aeta                        : 2.488e-03
                         :    5 : bjet_NeutralHadronEnergyFraction : 2.368e-03
                         :    6 : bjet_ChargedEmEnergyFraction     : 1.009e-03
                         :    7 : bjet_NeutralMultiplicity         : 4.157e-04
                         :    8 : bjet_pt                          : 1.161e-04
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61256                            1.5521   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2874                            1.0859   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3066                            1.0078   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0093385                            1.0090   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00013250                           0.99484   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                         0.0020690                           0.99447   [                           -3.1252                            5.7307 ]
                         :                        bjet_aeta:                         0.0020022                           0.99497   [                           -3.2529                            5.7307 ]
                         :                fabs(bjet_charge):                           0.10622                            1.2344   [                           -3.2381                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 645510 samples, validate on 545341 samples
Epoch 1/300
 - 107s - loss: 0.8640 - acc: 0.5644 - val_loss: 0.6885 - val_acc: 0.5541
Epoch 2/300
 - 107s - loss: 0.8495 - acc: 0.5613 - val_loss: 0.6916 - val_acc: 0.5433
Epoch 3/300
 - 119s - loss: 0.8481 - acc: 0.5610 - val_loss: 0.6692 - val_acc: 0.5776
Epoch 4/300
 - 128s - loss: 0.8476 - acc: 0.5604 - val_loss: 0.6844 - val_acc: 0.5508
Epoch 5/300
 - 119s - loss: 0.8476 - acc: 0.5593 - val_loss: 0.6707 - val_acc: 0.5844
Epoch 6/300
 - 103s - loss: 0.8476 - acc: 0.5587 - val_loss: 0.6735 - val_acc: 0.5723
Epoch 7/300
 - 128s - loss: 0.8475 - acc: 0.5575 - val_loss: 0.6760 - val_acc: 0.5642
Epoch 8/300
 - 126s - loss: 0.8474 - acc: 0.5579 - val_loss: 0.6839 - val_acc: 0.5448
Epoch 9/300
 - 114s - loss: 0.8473 - acc: 0.5593 - val_loss: 0.6756 - val_acc: 0.5704
Epoch 10/300
 - 116s - loss: 0.8473 - acc: 0.5586 - val_loss: 0.6899 - val_acc: 0.5342
Epoch 11/300
 - 81s - loss: 0.8472 - acc: 0.5595 - val_loss: 0.6765 - val_acc: 0.5572
Epoch 12/300
 - 75s - loss: 0.8472 - acc: 0.5600 - val_loss: 0.6784 - val_acc: 0.5562
Epoch 13/300
 - 117s - loss: 0.8472 - acc: 0.5598 - val_loss: 0.6832 - val_acc: 0.5470
Epoch 14/300
 - 125s - loss: 0.8472 - acc: 0.5593 - val_loss: 0.6791 - val_acc: 0.5616
Epoch 15/300
 - 117s - loss: 0.8470 - acc: 0.5603 - val_loss: 0.6755 - val_acc: 0.5658
Epoch 16/300
 - 119s - loss: 0.8471 - acc: 0.5598 - val_loss: 0.6805 - val_acc: 0.5633
Epoch 17/300
 - 126s - loss: 0.8471 - acc: 0.5598 - val_loss: 0.6916 - val_acc: 0.5394
Epoch 18/300
 - 112s - loss: 0.8470 - acc: 0.5602 - val_loss: 0.6831 - val_acc: 0.5486
Epoch 19/300
 - 121s - loss: 0.8471 - acc: 0.5596 - val_loss: 0.6771 - val_acc: 0.5670
Epoch 20/300
 - 106s - loss: 0.8471 - acc: 0.5603 - val_loss: 0.6814 - val_acc: 0.5592
Epoch 21/300
 - 85s - loss: 0.8471 - acc: 0.5601 - val_loss: 0.6878 - val_acc: 0.5390
Epoch 22/300
 - 74s - loss: 0.8471 - acc: 0.5595 - val_loss: 0.6878 - val_acc: 0.5470
Epoch 23/300
 - 104s - loss: 0.8470 - acc: 0.5593 - val_loss: 0.6842 - val_acc: 0.5535
Epoch 24/300
 - 126s - loss: 0.8470 - acc: 0.5590 - val_loss: 0.6775 - val_acc: 0.5662
Epoch 25/300
 - 126s - loss: 0.8470 - acc: 0.5606 - val_loss: 0.6935 - val_acc: 0.5329
Epoch 26/300
 - 113s - loss: 0.8470 - acc: 0.5601 - val_loss: 0.6738 - val_acc: 0.5800
Epoch 27/300
 - 121s - loss: 0.8470 - acc: 0.5605 - val_loss: 0.6837 - val_acc: 0.5555
Epoch 28/300
 - 118s - loss: 0.8470 - acc: 0.5620 - val_loss: 0.6828 - val_acc: 0.5482
Epoch 29/300
 - 116s - loss: 0.8470 - acc: 0.5601 - val_loss: 0.6813 - val_acc: 0.5505
Epoch 30/300
 - 104s - loss: 0.8471 - acc: 0.5591 - val_loss: 0.6817 - val_acc: 0.5567
Epoch 31/300
 - 95s - loss: 0.8469 - acc: 0.5604 - val_loss: 0.6914 - val_acc: 0.5195
Epoch 32/300
 - 120s - loss: 0.8469 - acc: 0.5601 - val_loss: 0.6791 - val_acc: 0.5649
Epoch 33/300
 - 104s - loss: 0.8469 - acc: 0.5605 - val_loss: 0.6884 - val_acc: 0.5379
Epoch 00033: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 645510 events: 3.69e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3491                           0.96267   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3491                           0.96267   [                           -2.6852                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.599
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.026 (0.028)       0.191 (0.194)      0.444 (0.446)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 545341 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 645510 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.465534166943
auc= 0.599184569164
0.599184569164
----
bjet_NeutralEmEnergyFraction does NOT drop AUC. we don't need it
no  bjet_NeutralEmEnergyFraction -->AUC= 0.599184569164
AUC cut= 0.59
======
TEST-> bjet_MuonEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_9 (Dense)              (None, 128)               1024      
_________________________________________________________________
batch_normalization_7 (Batch (None, 128)               512       
_________________________________________________________________
activation_9 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_10 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_8 (Batch (None, 128)               512       
_________________________________________________________________
activation_10 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_11 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
activation_11 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_12 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,842
Trainable params: 35,074
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 387726 events
                         : Add Tree OutTree/sig of type Signal with 440734 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 273702 events
                         : Add Tree OutTree/bkg of type Background with 310379 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 741265  / sum of weights: 741265
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89475
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 449586  / sum of weights: 449586
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.769732
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 403391
                         : Signal     -- testing events             : 337874
                         : Signal     -- training and testing events: 741265
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89475
                         : Background -- training events            : 242119
                         : Background -- testing events             : 207467
                         : Background -- training and testing events: 449586
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.769732
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.054                   -0.350                   +0.022  -0.035    +0.297            +0.169
                         :     bjet_ChargedEmEnergyFraction:                           -0.054                       +1.000                   -0.084                   -0.141  -0.028    -0.006            +0.086
                         :         bjet_ChargedMultiplicity:                           -0.350                       -0.084                   +1.000                   +0.227  +0.323    -0.245            -0.343
                         :         bjet_NeutralMultiplicity:                           +0.022                       -0.141                   +0.227                   +1.000  +0.262    -0.253            -0.121
                         :                          bjet_pt:                           -0.035                       -0.028                   +0.323                   +0.262  +1.000    -0.070            -0.002
                         :                        bjet_aeta:                           +0.297                       -0.006                   -0.245                   -0.253  -0.070    +1.000            +0.152
                         :                fabs(bjet_charge):                           +0.169                       +0.086                   -0.343                   -0.121  -0.002    +0.152            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.059                   -0.427                   -0.020  -0.044    +0.360            +0.307
                         :     bjet_ChargedEmEnergyFraction:                           -0.059                       +1.000                   -0.056                   -0.119  -0.006    -0.004            +0.052
                         :         bjet_ChargedMultiplicity:                           -0.427                       -0.056                   +1.000                   +0.238  +0.315    -0.314            -0.368
                         :         bjet_NeutralMultiplicity:                           -0.020                       -0.119                   +0.238                   +1.000  +0.262    -0.279            -0.113
                         :                          bjet_pt:                           -0.044                       -0.006                   +0.315                   +0.262  +1.000    -0.073            -0.009
                         :                        bjet_aeta:                           +0.360                       -0.004                   -0.314                   -0.279  -0.073    +1.000            +0.259
                         :                fabs(bjet_charge):                           +0.307                       +0.052                   -0.368                   -0.113  -0.009    +0.259            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.11750                           0.14215   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038398                           0.11532   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            10.371                            4.1624   [                            0.0000                            44.000 ]
                         :         bjet_NeutralMultiplicity:                            10.091                            4.8707   [                            0.0000                            50.000 ]
                         :                          bjet_pt:                            60.465                            35.491   [                            30.000                            1568.3 ]
                         :                        bjet_aeta:                            1.1204                           0.74794   [                        1.4975e-06                            3.1285 ]
                         :                fabs(bjet_charge):                           0.28828                           0.22597   [                        4.3649e-06                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.999e-02
                         :    2 : bjet_ChargedMultiplicity         : 2.506e-03
                         :    3 : bjet_aeta                        : 2.488e-03
                         :    4 : bjet_NeutralHadronEnergyFraction : 2.368e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.009e-03
                         :    6 : bjet_NeutralMultiplicity         : 4.157e-04
                         :    7 : bjet_pt                          : 1.161e-04
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61256                            1.5521   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2874                            1.0859   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0093385                            1.0090   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                        0.00013250                           0.99484   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                         0.0020690                           0.99447   [                           -3.1252                            5.7307 ]
                         :                        bjet_aeta:                         0.0020022                           0.99497   [                           -3.2529                            5.7307 ]
                         :                fabs(bjet_charge):                           0.10622                            1.2344   [                           -3.2381                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 645510 samples, validate on 545341 samples
Epoch 1/300
 - 116s - loss: 0.8639 - acc: 0.5637 - val_loss: 0.6805 - val_acc: 0.5634
Epoch 2/300
 - 99s - loss: 0.8495 - acc: 0.5622 - val_loss: 0.6848 - val_acc: 0.5510
Epoch 3/300
 - 86s - loss: 0.8485 - acc: 0.5609 - val_loss: 0.6809 - val_acc: 0.5581
Epoch 4/300
 - 108s - loss: 0.8482 - acc: 0.5612 - val_loss: 0.6786 - val_acc: 0.5589
Epoch 5/300
 - 116s - loss: 0.8480 - acc: 0.5596 - val_loss: 0.6783 - val_acc: 0.5647
Epoch 6/300
 - 121s - loss: 0.8479 - acc: 0.5606 - val_loss: 0.6789 - val_acc: 0.5604
Epoch 7/300
 - 115s - loss: 0.8480 - acc: 0.5592 - val_loss: 0.6829 - val_acc: 0.5524
Epoch 8/300
 - 130s - loss: 0.8477 - acc: 0.5590 - val_loss: 0.6898 - val_acc: 0.5384
Epoch 9/300
 - 107s - loss: 0.8478 - acc: 0.5585 - val_loss: 0.6721 - val_acc: 0.5758
Epoch 10/300
 - 80s - loss: 0.8475 - acc: 0.5588 - val_loss: 0.6742 - val_acc: 0.5673
Epoch 11/300
 - 111s - loss: 0.8476 - acc: 0.5584 - val_loss: 0.6848 - val_acc: 0.5443
Epoch 12/300
 - 127s - loss: 0.8476 - acc: 0.5587 - val_loss: 0.6836 - val_acc: 0.5505
Epoch 13/300
 - 106s - loss: 0.8476 - acc: 0.5596 - val_loss: 0.6899 - val_acc: 0.5391
Epoch 14/300
 - 108s - loss: 0.8475 - acc: 0.5607 - val_loss: 0.6811 - val_acc: 0.5567
Epoch 15/300
 - 124s - loss: 0.8475 - acc: 0.5603 - val_loss: 0.6753 - val_acc: 0.5653
Epoch 16/300
 - 94s - loss: 0.8474 - acc: 0.5595 - val_loss: 0.6795 - val_acc: 0.5576
Epoch 17/300
 - 84s - loss: 0.8475 - acc: 0.5606 - val_loss: 0.6802 - val_acc: 0.5549
Epoch 18/300
 - 120s - loss: 0.8474 - acc: 0.5599 - val_loss: 0.6679 - val_acc: 0.5900
Epoch 19/300
 - 130s - loss: 0.8473 - acc: 0.5587 - val_loss: 0.6841 - val_acc: 0.5406
Epoch 20/300
 - 129s - loss: 0.8473 - acc: 0.5598 - val_loss: 0.6772 - val_acc: 0.5656
Epoch 21/300
 - 131s - loss: 0.8473 - acc: 0.5600 - val_loss: 0.6772 - val_acc: 0.5616
Epoch 22/300
 - 128s - loss: 0.8474 - acc: 0.5602 - val_loss: 0.6820 - val_acc: 0.5523
Epoch 23/300
 - 126s - loss: 0.8475 - acc: 0.5603 - val_loss: 0.6795 - val_acc: 0.5592
Epoch 24/300
 - 99s - loss: 0.8474 - acc: 0.5608 - val_loss: 0.6825 - val_acc: 0.5605
Epoch 25/300
 - 95s - loss: 0.8473 - acc: 0.5609 - val_loss: 0.6848 - val_acc: 0.5469
Epoch 26/300
 - 104s - loss: 0.8474 - acc: 0.5597 - val_loss: 0.6771 - val_acc: 0.5589
Epoch 27/300
 - 93s - loss: 0.8473 - acc: 0.5596 - val_loss: 0.6775 - val_acc: 0.5630
Epoch 28/300
 - 81s - loss: 0.8472 - acc: 0.5589 - val_loss: 0.6810 - val_acc: 0.5656
Epoch 29/300
 - 78s - loss: 0.8471 - acc: 0.5607 - val_loss: 0.6868 - val_acc: 0.5492
Epoch 30/300
 - 108s - loss: 0.8471 - acc: 0.5610 - val_loss: 0.6736 - val_acc: 0.5764
Epoch 31/300
 - 126s - loss: 0.8471 - acc: 0.5597 - val_loss: 0.6858 - val_acc: 0.5441
Epoch 32/300
 - 120s - loss: 0.8471 - acc: 0.5615 - val_loss: 0.6772 - val_acc: 0.5646
Epoch 33/300
 - 107s - loss: 0.8471 - acc: 0.5594 - val_loss: 0.6804 - val_acc: 0.5586
Epoch 34/300
 - 91s - loss: 0.8472 - acc: 0.5607 - val_loss: 0.6775 - val_acc: 0.5600
Epoch 35/300
 - 80s - loss: 0.8473 - acc: 0.5606 - val_loss: 0.6812 - val_acc: 0.5540
Epoch 36/300
 - 117s - loss: 0.8472 - acc: 0.5593 - val_loss: 0.6872 - val_acc: 0.5400
Epoch 37/300
 - 125s - loss: 0.8472 - acc: 0.5595 - val_loss: 0.6798 - val_acc: 0.5579
Epoch 38/300
 - 110s - loss: 0.8474 - acc: 0.5609 - val_loss: 0.6777 - val_acc: 0.5648
Epoch 39/300
 - 116s - loss: 0.8473 - acc: 0.5600 - val_loss: 0.6754 - val_acc: 0.5673
Epoch 40/300
 - 115s - loss: 0.8472 - acc: 0.5599 - val_loss: 0.6752 - val_acc: 0.5704
Epoch 41/300
 - 95s - loss: 0.8472 - acc: 0.5599 - val_loss: 0.6761 - val_acc: 0.5688
Epoch 42/300
 - 91s - loss: 0.8473 - acc: 0.5597 - val_loss: 0.6840 - val_acc: 0.5445
Epoch 43/300
 - 84s - loss: 0.8472 - acc: 0.5598 - val_loss: 0.6820 - val_acc: 0.5585
Epoch 44/300
 - 89s - loss: 0.8472 - acc: 0.5599 - val_loss: 0.6872 - val_acc: 0.5457
Epoch 45/300
 - 113s - loss: 0.8472 - acc: 0.5602 - val_loss: 0.6848 - val_acc: 0.5463
Epoch 46/300
 - 122s - loss: 0.8471 - acc: 0.5608 - val_loss: 0.6769 - val_acc: 0.5691
Epoch 47/300
 - 114s - loss: 0.8472 - acc: 0.5615 - val_loss: 0.6859 - val_acc: 0.5445
Epoch 48/300
 - 118s - loss: 0.8472 - acc: 0.5617 - val_loss: 0.6786 - val_acc: 0.5599
Epoch 00048: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 645510 events: 5.21e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030402                            1.0076   [                           -4.5261                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.598
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.023 (0.029)       0.187 (0.198)      0.443 (0.450)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 545341 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 645510 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.482346424775
auc= 0.598162576742
0.598162576742
----
bjet_MuonEnergyFraction does NOT drop AUC. we don't need it
no  bjet_MuonEnergyFraction -->AUC= 0.598162576742
AUC cut= 0.59
======
TEST-> bjet_NeutralMultiplicity
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_13 (Dense)             (None, 128)               896       
_________________________________________________________________
batch_normalization_10 (Batc (None, 128)               512       
_________________________________________________________________
activation_13 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_14 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_11 (Batc (None, 128)               512       
_________________________________________________________________
activation_14 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_15 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_12 (Batc (None, 128)               512       
_________________________________________________________________
activation_15 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_16 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_16 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,714
Trainable params: 34,946
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 387726 events
                         : Add Tree OutTree/sig of type Signal with 440734 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 273702 events
                         : Add Tree OutTree/bkg of type Background with 310379 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 741265  / sum of weights: 741265
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89475
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 449586  / sum of weights: 449586
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.769732
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 403391
                         : Signal     -- testing events             : 337874
                         : Signal     -- training and testing events: 741265
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89475
                         : Background -- training events            : 242119
                         : Background -- testing events             : 207467
                         : Background -- training and testing events: 449586
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.769732
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.054                   -0.350  -0.035    +0.297            +0.169
                         :     bjet_ChargedEmEnergyFraction:                           -0.054                       +1.000                   -0.084  -0.028    -0.006            +0.086
                         :         bjet_ChargedMultiplicity:                           -0.350                       -0.084                   +1.000  +0.323    -0.245            -0.343
                         :                          bjet_pt:                           -0.035                       -0.028                   +0.323  +1.000    -0.070            -0.002
                         :                        bjet_aeta:                           +0.297                       -0.006                   -0.245  -0.070    +1.000            +0.152
                         :                fabs(bjet_charge):                           +0.169                       +0.086                   -0.343  -0.002    +0.152            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.059                   -0.427  -0.044    +0.360            +0.307
                         :     bjet_ChargedEmEnergyFraction:                           -0.059                       +1.000                   -0.056  -0.006    -0.004            +0.052
                         :         bjet_ChargedMultiplicity:                           -0.427                       -0.056                   +1.000  +0.315    -0.314            -0.368
                         :                          bjet_pt:                           -0.044                       -0.006                   +0.315  +1.000    -0.073            -0.009
                         :                        bjet_aeta:                           +0.360                       -0.004                   -0.314  -0.073    +1.000            +0.259
                         :                fabs(bjet_charge):                           +0.307                       +0.052                   -0.368  -0.009    +0.259            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.11750                           0.14215   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038398                           0.11532   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            10.371                            4.1624   [                            0.0000                            44.000 ]
                         :                          bjet_pt:                            60.465                            35.491   [                            30.000                            1568.3 ]
                         :                        bjet_aeta:                            1.1204                           0.74794   [                        1.4975e-06                            3.1285 ]
                         :                fabs(bjet_charge):                           0.28828                           0.22597   [                        4.3649e-06                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.999e-02
                         :    2 : bjet_ChargedMultiplicity         : 2.506e-03
                         :    3 : bjet_aeta                        : 2.488e-03
                         :    4 : bjet_NeutralHadronEnergyFraction : 2.368e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.009e-03
                         :    6 : bjet_pt                          : 1.161e-04
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61256                            1.5521   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2874                            1.0859   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0093385                            1.0090   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                         0.0020690                           0.99447   [                           -3.1252                            5.7307 ]
                         :                        bjet_aeta:                         0.0020022                           0.99497   [                           -3.2529                            5.7307 ]
                         :                fabs(bjet_charge):                           0.10622                            1.2344   [                           -3.2381                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 645510 samples, validate on 545341 samples
Epoch 1/300
 - 110s - loss: 0.8639 - acc: 0.5635 - val_loss: 0.6807 - val_acc: 0.5637
Epoch 2/300
 - 102s - loss: 0.8498 - acc: 0.5624 - val_loss: 0.6784 - val_acc: 0.5578
Epoch 3/300
 - 93s - loss: 0.8486 - acc: 0.5618 - val_loss: 0.6877 - val_acc: 0.5431
Epoch 4/300
 - 101s - loss: 0.8484 - acc: 0.5605 - val_loss: 0.6712 - val_acc: 0.5743
Epoch 5/300
 - 101s - loss: 0.8481 - acc: 0.5609 - val_loss: 0.6894 - val_acc: 0.5367
Epoch 6/300
 - 95s - loss: 0.8479 - acc: 0.5598 - val_loss: 0.6728 - val_acc: 0.5714
Epoch 7/300
 - 103s - loss: 0.8479 - acc: 0.5592 - val_loss: 0.6898 - val_acc: 0.5366
Epoch 8/300
 - 111s - loss: 0.8479 - acc: 0.5579 - val_loss: 0.6806 - val_acc: 0.5481
Epoch 9/300
 - 120s - loss: 0.8478 - acc: 0.5592 - val_loss: 0.6762 - val_acc: 0.5623
Epoch 10/300
 - 112s - loss: 0.8477 - acc: 0.5591 - val_loss: 0.6746 - val_acc: 0.5640
Epoch 11/300
 - 95s - loss: 0.8478 - acc: 0.5589 - val_loss: 0.6750 - val_acc: 0.5786
Epoch 12/300
 - 97s - loss: 0.8476 - acc: 0.5587 - val_loss: 0.6768 - val_acc: 0.5672
Epoch 13/300
 - 121s - loss: 0.8475 - acc: 0.5576 - val_loss: 0.6866 - val_acc: 0.5338
Epoch 14/300
 - 112s - loss: 0.8476 - acc: 0.5586 - val_loss: 0.6745 - val_acc: 0.6194
Epoch 15/300
 - 102s - loss: 0.8476 - acc: 0.5585 - val_loss: 0.6775 - val_acc: 0.5590
Epoch 16/300
 - 100s - loss: 0.8476 - acc: 0.5588 - val_loss: 0.6877 - val_acc: 0.5397
Epoch 17/300
 - 98s - loss: 0.8476 - acc: 0.5589 - val_loss: 0.6809 - val_acc: 0.5517
Epoch 18/300
 - 109s - loss: 0.8476 - acc: 0.5593 - val_loss: 0.6854 - val_acc: 0.5460
Epoch 19/300
 - 116s - loss: 0.8475 - acc: 0.5594 - val_loss: 0.6775 - val_acc: 0.5651
Epoch 20/300
 - 91s - loss: 0.8476 - acc: 0.5583 - val_loss: 0.6932 - val_acc: 0.5338
Epoch 21/300
 - 90s - loss: 0.8476 - acc: 0.5591 - val_loss: 0.6795 - val_acc: 0.5658
Epoch 22/300
 - 103s - loss: 0.8474 - acc: 0.5587 - val_loss: 0.6738 - val_acc: 0.5672
Epoch 23/300
 - 114s - loss: 0.8475 - acc: 0.5589 - val_loss: 0.6854 - val_acc: 0.5437
Epoch 24/300
 - 101s - loss: 0.8474 - acc: 0.5599 - val_loss: 0.6829 - val_acc: 0.5541
Epoch 25/300
 - 98s - loss: 0.8476 - acc: 0.5590 - val_loss: 0.6763 - val_acc: 0.5710
Epoch 26/300
 - 122s - loss: 0.8476 - acc: 0.5588 - val_loss: 0.6889 - val_acc: 0.5402
Epoch 27/300
 - 114s - loss: 0.8475 - acc: 0.5591 - val_loss: 0.6851 - val_acc: 0.5429
Epoch 28/300
 - 102s - loss: 0.8474 - acc: 0.5600 - val_loss: 0.6782 - val_acc: 0.5595
Epoch 29/300
 - 104s - loss: 0.8474 - acc: 0.5589 - val_loss: 0.6860 - val_acc: 0.5391
Epoch 30/300
 - 120s - loss: 0.8472 - acc: 0.5586 - val_loss: 0.6747 - val_acc: 0.5710
Epoch 31/300
 - 107s - loss: 0.8473 - acc: 0.5593 - val_loss: 0.7056 - val_acc: 0.5138
Epoch 32/300
 - 85s - loss: 0.8473 - acc: 0.5591 - val_loss: 0.6847 - val_acc: 0.5395
Epoch 33/300
 - 79s - loss: 0.8475 - acc: 0.5590 - val_loss: 0.6806 - val_acc: 0.5558
Epoch 34/300
 - 79s - loss: 0.8473 - acc: 0.5597 - val_loss: 0.6884 - val_acc: 0.5277
Epoch 00034: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 645510 events: 3.52e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                        bjet_aeta:                        -0.0083245                           0.98836   [                           -3.2516                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.598
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.023 (0.027)       0.188 (0.195)      0.442 (0.447)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 545341 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 645510 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.46670924848
auc= 0.597558033913
0.597558033913
----
bjet_NeutralMultiplicity does NOT drop AUC. we don't need it
no  bjet_NeutralMultiplicity -->AUC= 0.597558033913
AUC cut= 0.59
======
TEST-> bjet_aeta
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity', 'bjet_aeta']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_17 (Dense)             (None, 128)               768       
_________________________________________________________________
batch_normalization_13 (Batc (None, 128)               512       
_________________________________________________________________
activation_17 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_18 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_14 (Batc (None, 128)               512       
_________________________________________________________________
activation_18 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_19 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_15 (Batc (None, 128)               512       
_________________________________________________________________
activation_19 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_20 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_20 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,586
Trainable params: 34,818
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016postVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 387726 events
                         : Add Tree OutTree/sig of type Signal with 440734 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 273702 events
                         : Add Tree OutTree/bkg of type Background with 310379 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 741265  / sum of weights: 741265
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89475
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 449586  / sum of weights: 449586
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.769732
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 403391
                         : Signal     -- testing events             : 337874
                         : Signal     -- training and testing events: 741265
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89475
                         : Background -- training events            : 242119
                         : Background -- testing events             : 207467
                         : Background -- training and testing events: 449586
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.769732
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.054                   -0.350  -0.035            +0.169
                         :     bjet_ChargedEmEnergyFraction:                           -0.054                       +1.000                   -0.084  -0.028            +0.086
                         :         bjet_ChargedMultiplicity:                           -0.350                       -0.084                   +1.000  +0.323            -0.343
                         :                          bjet_pt:                           -0.035                       -0.028                   +0.323  +1.000            -0.002
                         :                fabs(bjet_charge):                           +0.169                       +0.086                   -0.343  -0.002            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.059                   -0.427  -0.044            +0.307
                         :     bjet_ChargedEmEnergyFraction:                           -0.059                       +1.000                   -0.056  -0.006            +0.052
                         :         bjet_ChargedMultiplicity:                           -0.427                       -0.056                   +1.000  +0.315            -0.368
                         :                          bjet_pt:                           -0.044                       -0.006                   +0.315  +1.000            -0.009
                         :                fabs(bjet_charge):                           +0.307                       +0.052                   -0.368  -0.009            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.11750                           0.14215   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038398                           0.11532   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            10.371                            4.1624   [                            0.0000                            44.000 ]
                         :                          bjet_pt:                            60.465                            35.491   [                            30.000                            1568.3 ]
                         :                fabs(bjet_charge):                           0.28828                           0.22597   [                        4.3649e-06                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.999e-02
                         :    2 : bjet_ChargedMultiplicity         : 2.506e-03
                         :    3 : bjet_NeutralHadronEnergyFraction : 2.368e-03
                         :    4 : bjet_ChargedEmEnergyFraction     : 1.009e-03
                         :    5 : bjet_pt                          : 1.161e-04
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61256                            1.5521   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2874                            1.0859   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0093385                            1.0090   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                         0.0020690                           0.99447   [                           -3.1252                            5.7307 ]
                         :                fabs(bjet_charge):                           0.10622                            1.2344   [                           -3.2381                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 645510 samples, validate on 545341 samples
Epoch 1/300
 - 124s - loss: 0.8643 - acc: 0.5640 - val_loss: 0.6852 - val_acc: 0.5615
Epoch 2/300
 - 84s - loss: 0.8502 - acc: 0.5629 - val_loss: 0.6889 - val_acc: 0.5579
Epoch 3/300
 - 88s - loss: 0.8493 - acc: 0.5618 - val_loss: 0.6845 - val_acc: 0.5520
Epoch 4/300
 - 124s - loss: 0.8491 - acc: 0.5598 - val_loss: 0.6873 - val_acc: 0.5443
Epoch 5/300
 - 129s - loss: 0.8487 - acc: 0.5594 - val_loss: 0.6790 - val_acc: 0.5662
Epoch 6/300
 - 126s - loss: 0.8486 - acc: 0.5603 - val_loss: 0.6833 - val_acc: 0.5468
Epoch 7/300
 - 98s - loss: 0.8486 - acc: 0.5591 - val_loss: 0.6751 - val_acc: 0.5732
Epoch 8/300
 - 86s - loss: 0.8484 - acc: 0.5591 - val_loss: 0.6827 - val_acc: 0.5469
Epoch 9/300
 - 102s - loss: 0.8485 - acc: 0.5587 - val_loss: 0.6800 - val_acc: 0.5567
Epoch 10/300
 - 84s - loss: 0.8483 - acc: 0.5588 - val_loss: 0.6826 - val_acc: 0.5531
Epoch 11/300
 - 82s - loss: 0.8482 - acc: 0.5584 - val_loss: 0.6780 - val_acc: 0.5629
Epoch 12/300
 - 106s - loss: 0.8483 - acc: 0.5572 - val_loss: 0.6907 - val_acc: 0.5282
Epoch 13/300
 - 101s - loss: 0.8482 - acc: 0.5571 - val_loss: 0.6861 - val_acc: 0.5419
Epoch 14/300
 - 89s - loss: 0.8482 - acc: 0.5568 - val_loss: 0.6907 - val_acc: 0.5391
Epoch 15/300
 - 97s - loss: 0.8482 - acc: 0.5585 - val_loss: 0.6830 - val_acc: 0.5420
Epoch 16/300
 - 113s - loss: 0.8481 - acc: 0.5581 - val_loss: 0.6837 - val_acc: 0.5527
Epoch 17/300
 - 104s - loss: 0.8481 - acc: 0.5577 - val_loss: 0.6846 - val_acc: 0.5456
Epoch 18/300
 - 82s - loss: 0.8481 - acc: 0.5577 - val_loss: 0.6866 - val_acc: 0.5546
Epoch 19/300
 - 93s - loss: 0.8481 - acc: 0.5574 - val_loss: 0.6833 - val_acc: 0.5481
Epoch 20/300
 - 111s - loss: 0.8482 - acc: 0.5584 - val_loss: 0.6730 - val_acc: 0.5712
Epoch 21/300
 - 103s - loss: 0.8481 - acc: 0.5602 - val_loss: 0.6864 - val_acc: 0.5388
Epoch 22/300
 - 94s - loss: 0.8482 - acc: 0.5575 - val_loss: 0.6839 - val_acc: 0.5551
Epoch 23/300
 - 101s - loss: 0.8480 - acc: 0.5576 - val_loss: 0.6856 - val_acc: 0.5456
Epoch 24/300
 - 115s - loss: 0.8481 - acc: 0.5588 - val_loss: 0.6780 - val_acc: 0.5662
Epoch 25/300
 - 111s - loss: 0.8480 - acc: 0.5601 - val_loss: 0.6949 - val_acc: 0.5222
Epoch 26/300
 - 114s - loss: 0.8480 - acc: 0.5594 - val_loss: 0.6986 - val_acc: 0.5241
Epoch 27/300
 - 128s - loss: 0.8480 - acc: 0.5590 - val_loss: 0.6864 - val_acc: 0.5300
Epoch 28/300
 - 121s - loss: 0.8480 - acc: 0.5587 - val_loss: 0.6806 - val_acc: 0.5565
Epoch 29/300
 - 88s - loss: 0.8481 - acc: 0.5578 - val_loss: 0.6752 - val_acc: 0.5641
Epoch 30/300
 - 81s - loss: 0.8481 - acc: 0.5578 - val_loss: 0.6823 - val_acc: 0.5463
Epoch 31/300
 - 101s - loss: 0.8478 - acc: 0.5594 - val_loss: 0.6828 - val_acc: 0.5492
Epoch 32/300
 - 101s - loss: 0.8479 - acc: 0.5573 - val_loss: 0.6900 - val_acc: 0.5382
Epoch 33/300
 - 99s - loss: 0.8480 - acc: 0.5589 - val_loss: 0.6911 - val_acc: 0.5350
Epoch 34/300
 - 90s - loss: 0.8479 - acc: 0.5578 - val_loss: 0.6815 - val_acc: 0.5586
Epoch 35/300
 - 92s - loss: 0.8479 - acc: 0.5598 - val_loss: 0.6757 - val_acc: 0.5661
Epoch 36/300
 - 96s - loss: 0.8479 - acc: 0.5587 - val_loss: 0.6726 - val_acc: 0.5793
Epoch 37/300
 - 80s - loss: 0.8481 - acc: 0.5592 - val_loss: 0.6798 - val_acc: 0.5600
Epoch 38/300
 - 78s - loss: 0.8479 - acc: 0.5590 - val_loss: 0.6762 - val_acc: 0.5654
Epoch 39/300
 - 76s - loss: 0.8479 - acc: 0.5604 - val_loss: 0.6787 - val_acc: 0.5565
Epoch 40/300
 - 70s - loss: 0.8478 - acc: 0.5594 - val_loss: 0.6891 - val_acc: 0.5411
Epoch 41/300
 - 67s - loss: 0.8479 - acc: 0.5586 - val_loss: 0.6736 - val_acc: 0.5727
Epoch 42/300
 - 75s - loss: 0.8478 - acc: 0.5581 - val_loss: 0.6860 - val_acc: 0.5449
Epoch 43/300
 - 68s - loss: 0.8478 - acc: 0.5589 - val_loss: 0.6730 - val_acc: 0.5730
Epoch 44/300
 - 63s - loss: 0.8476 - acc: 0.5587 - val_loss: 0.6789 - val_acc: 0.5596
Epoch 45/300
 - 58s - loss: 0.8477 - acc: 0.5585 - val_loss: 0.6800 - val_acc: 0.5475
Epoch 46/300
 - 78s - loss: 0.8478 - acc: 0.5595 - val_loss: 0.6782 - val_acc: 0.5677
Epoch 47/300
 - 77s - loss: 0.8477 - acc: 0.5601 - val_loss: 0.6770 - val_acc: 0.5596
Epoch 48/300
 - 65s - loss: 0.8478 - acc: 0.5596 - val_loss: 0.6913 - val_acc: 0.5410
Epoch 49/300
 - 63s - loss: 0.8477 - acc: 0.5585 - val_loss: 0.6885 - val_acc: 0.5373
Epoch 50/300
 - 71s - loss: 0.8477 - acc: 0.5582 - val_loss: 0.6780 - val_acc: 0.5580
Epoch 51/300
 - 88s - loss: 0.8479 - acc: 0.5591 - val_loss: 0.6861 - val_acc: 0.5519
Epoch 52/300
 - 89s - loss: 0.8476 - acc: 0.5586 - val_loss: 0.6799 - val_acc: 0.5594
Epoch 53/300
 - 79s - loss: 0.8479 - acc: 0.5595 - val_loss: 0.6852 - val_acc: 0.5472
Epoch 54/300
 - 65s - loss: 0.8478 - acc: 0.5580 - val_loss: 0.6745 - val_acc: 0.5675
Epoch 55/300
 - 65s - loss: 0.8479 - acc: 0.5593 - val_loss: 0.6734 - val_acc: 0.5651
Epoch 56/300
 - 71s - loss: 0.8476 - acc: 0.5595 - val_loss: 0.6859 - val_acc: 0.5411
Epoch 57/300
 - 62s - loss: 0.8476 - acc: 0.5585 - val_loss: 0.6868 - val_acc: 0.5417
Epoch 58/300
 - 57s - loss: 0.8478 - acc: 0.5594 - val_loss: 0.6731 - val_acc: 0.5694
Epoch 59/300
 - 52s - loss: 0.8478 - acc: 0.5586 - val_loss: 0.6938 - val_acc: 0.5238
Epoch 60/300
 - 52s - loss: 0.8477 - acc: 0.5590 - val_loss: 0.6830 - val_acc: 0.5435
Epoch 61/300
 - 51s - loss: 0.8478 - acc: 0.5591 - val_loss: 0.6790 - val_acc: 0.5542
Epoch 62/300
 - 62s - loss: 0.8476 - acc: 0.5587 - val_loss: 0.6985 - val_acc: 0.5201
Epoch 63/300
 - 71s - loss: 0.8479 - acc: 0.5602 - val_loss: 0.6811 - val_acc: 0.5566
Epoch 64/300
 - 66s - loss: 0.8477 - acc: 0.5602 - val_loss: 0.6963 - val_acc: 0.5268
Epoch 65/300
 - 60s - loss: 0.8478 - acc: 0.5599 - val_loss: 0.6778 - val_acc: 0.5699
Epoch 66/300
 - 55s - loss: 0.8477 - acc: 0.5597 - val_loss: 0.6931 - val_acc: 0.5291
Epoch 00066: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 645510 events: 5.71e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.61847                            1.5446   [                           -3.2251                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2947                            1.0907   [                           -2.7324                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.017514                            1.0217   [                           -3.2106                            5.7307 ]
                         :                          bjet_pt:                          0.094497                            1.0246   [                           -3.1236                            5.7307 ]
                         :                fabs(bjet_charge):                           0.14039                            1.2255   [                           -3.2410                            5.4200 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.597
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.022 (0.026)       0.184 (0.193)      0.442 (0.446)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 545341 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 645510 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.457138580515
auc= 0.597082495414
0.597082495414
----
bjet_aeta does NOT drop AUC. we don't need it
no  bjet_aeta -->AUC= 0.597082495414
AUC cut= 0.59
rmlist=> ['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity', 'bjet_aeta']
/data6/Users/jhchoi/TMVA/TMVA_TOOL/Remove_Unnecessary
