Using TensorFlow backend.
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelDAQMapping found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelFramePosition found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibration::DetRegistry found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelGainCalibrations found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCAnalysisMask found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
Warning in <TInterpreter::ReadRootmapFile>: class  CTPPSPixelROCInfo found in libCondFormatsPPSObjects.so  is already in libCondFormatsCTPPSReadoutObjects.so 
2024-07-02 01:41:23.093389: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
--testlist--
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_ChargedEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_ChargedMultiplicity', 'bjet_NeutralMultiplicity', 'bjet_pt', 'bjet_aeta', 'fabs(bjet_charge)']
======
TEST-> bjet_ChargedHadronEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 128)               1280      
_________________________________________________________________
batch_normalization_1 (Batch (None, 128)               512       
_________________________________________________________________
activation_1 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_2 (Batch (None, 128)               512       
_________________________________________________________________
activation_2 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_3 (Batch (None, 128)               512       
_________________________________________________________________
activation_3 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_4 (Activation)    (None, 2)                 0         
=================================================================
Total params: 36,098
Trainable params: 35,330
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.061                       -0.063                  -0.105                   -0.355                   +0.028  -0.040    +0.302            +0.162
                         :     bjet_NeutralEmEnergyFraction:                           -0.061                       +1.000                       -0.226                  -0.188                   -0.201                   +0.348  +0.051    -0.012            +0.017
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       -0.226                       +1.000                  -0.070                   -0.083                   -0.146  -0.028    -0.007            +0.089
                         :          bjet_MuonEnergyFraction:                           -0.105                       -0.188                       -0.070                  +1.000                   -0.074                   -0.134  -0.019    -0.002            +0.164
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.201                       -0.083                  -0.074                   +1.000                   +0.218  +0.321    -0.289            -0.338
                         :         bjet_NeutralMultiplicity:                           +0.028                       +0.348                       -0.146                  -0.134                   +0.218                   +1.000  +0.263    -0.240            -0.123
                         :                          bjet_pt:                           -0.040                       +0.051                       -0.028                  -0.019                   +0.321                   +0.263  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.012                       -0.007                  -0.002                   -0.289                   -0.240  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.017                       +0.089                  +0.164                   -0.338                   -0.123  -0.001    +0.154            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_NeutralEmEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.052                       -0.065                  -0.093                   -0.431                   -0.020  -0.048    +0.364            +0.301
                         :     bjet_NeutralEmEnergyFraction:                           -0.052                       +1.000                       -0.213                  -0.158                   -0.245                   +0.313  +0.045    +0.025            +0.094
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       -0.213                       +1.000                  -0.045                   -0.055                   -0.125  -0.007    -0.006            +0.051
                         :          bjet_MuonEnergyFraction:                           -0.093                       -0.158                       -0.045                  +1.000                   -0.038                   -0.098  +0.001    -0.013            +0.099
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.245                       -0.055                  -0.038                   +1.000                   +0.230  +0.316    -0.353            -0.365
                         :         bjet_NeutralMultiplicity:                           -0.020                       +0.313                       -0.125                  -0.098                   +0.230                   +1.000  +0.267    -0.274            -0.109
                         :                          bjet_pt:                           -0.048                       +0.045                       -0.007                  +0.001                   +0.316                   +0.267  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       +0.025                       -0.006                  -0.013                   -0.353                   -0.274  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.094                       +0.051                  +0.099                   -0.365                   -0.109  -0.009    +0.254            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_NeutralEmEnergyFraction' <---> Output : variable 'bjet_NeutralEmEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_NeutralEmEnergyFraction:                           0.27300                           0.16552   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :          bjet_MuonEnergyFraction:                          0.029799                           0.10162   [                            0.0000                           0.98854 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :         bjet_NeutralMultiplicity:                            10.433                            4.9428   [                            0.0000                            48.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.165e-03
                         :    3 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    4 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    5 : bjet_aeta                        : 2.410e-03
                         :    6 : bjet_NeutralEmEnergyFraction     : 1.521e-03
                         :    7 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    8 : bjet_NeutralMultiplicity         : 5.427e-04
                         :    9 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                        -0.0060830                            1.0092   [                           -3.2778                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3091                           0.99867   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                         0.0031244                           0.99607   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
/cvmfs/cms.cern.ch/slc7_amd64_gcc700/external/py2-Keras/2.1.4-gnimlf2/lib/python2.7/site-packages/keras/models.py:942: UserWarning: The `nb_epoch` argument in `fit` has been renamed `epochs`.
  warnings.warn('The `nb_epoch` argument in `fit` '
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 224s - loss: 0.8582 - acc: 0.5629 - val_loss: 0.6836 - val_acc: 0.5599
Epoch 2/300
 - 217s - loss: 0.8455 - acc: 0.5608 - val_loss: 0.6824 - val_acc: 0.5601
Epoch 3/300
 - 220s - loss: 0.8444 - acc: 0.5603 - val_loss: 0.6773 - val_acc: 0.5705
Epoch 4/300
 - 212s - loss: 0.8442 - acc: 0.5590 - val_loss: 0.6833 - val_acc: 0.5516
Epoch 5/300
 - 191s - loss: 0.8442 - acc: 0.5581 - val_loss: 0.6811 - val_acc: 0.5615
Epoch 6/300
 - 189s - loss: 0.8439 - acc: 0.5580 - val_loss: 0.6803 - val_acc: 0.5511
Epoch 7/300
 - 166s - loss: 0.8440 - acc: 0.5575 - val_loss: 0.6712 - val_acc: 0.5713
Epoch 8/300
 - 185s - loss: 0.8441 - acc: 0.5570 - val_loss: 0.6810 - val_acc: 0.5486
Epoch 9/300
 - 184s - loss: 0.8439 - acc: 0.5574 - val_loss: 0.6838 - val_acc: 0.5458
Epoch 10/300
 - 198s - loss: 0.8438 - acc: 0.5584 - val_loss: 0.6894 - val_acc: 0.5348
Epoch 11/300
 - 197s - loss: 0.8439 - acc: 0.5592 - val_loss: 0.6846 - val_acc: 0.5473
Epoch 12/300
 - 215s - loss: 0.8438 - acc: 0.5590 - val_loss: 0.6732 - val_acc: 0.5757
Epoch 13/300
 - 209s - loss: 0.8438 - acc: 0.5596 - val_loss: 0.6816 - val_acc: 0.5508
Epoch 14/300
 - 207s - loss: 0.8437 - acc: 0.5586 - val_loss: 0.6871 - val_acc: 0.5421
Epoch 15/300
 - 184s - loss: 0.8439 - acc: 0.5580 - val_loss: 0.6847 - val_acc: 0.5485
Epoch 16/300
 - 175s - loss: 0.8437 - acc: 0.5578 - val_loss: 0.6787 - val_acc: 0.5647
Epoch 17/300
 - 203s - loss: 0.8435 - acc: 0.5579 - val_loss: 0.6862 - val_acc: 0.5497
Epoch 18/300
 - 221s - loss: 0.8437 - acc: 0.5581 - val_loss: 0.6820 - val_acc: 0.5477
Epoch 19/300
 - 214s - loss: 0.8436 - acc: 0.5569 - val_loss: 0.6797 - val_acc: 0.5568
Epoch 20/300
 - 189s - loss: 0.8436 - acc: 0.5585 - val_loss: 0.6825 - val_acc: 0.5522
Epoch 21/300
 - 161s - loss: 0.8435 - acc: 0.5584 - val_loss: 0.6773 - val_acc: 0.5636
Epoch 22/300
 - 141s - loss: 0.8435 - acc: 0.5582 - val_loss: 0.6766 - val_acc: 0.5629
Epoch 23/300
 - 197s - loss: 0.8435 - acc: 0.5575 - val_loss: 0.6817 - val_acc: 0.5549
Epoch 24/300
 - 216s - loss: 0.8435 - acc: 0.5585 - val_loss: 0.6848 - val_acc: 0.5575
Epoch 25/300
 - 219s - loss: 0.8435 - acc: 0.5579 - val_loss: 0.6812 - val_acc: 0.5535
Epoch 26/300
 - 216s - loss: 0.8434 - acc: 0.5598 - val_loss: 0.6865 - val_acc: 0.5389
Epoch 27/300
 - 191s - loss: 0.8435 - acc: 0.5585 - val_loss: 0.6762 - val_acc: 0.5634
Epoch 28/300
 - 183s - loss: 0.8435 - acc: 0.5586 - val_loss: 0.6718 - val_acc: 0.5741
Epoch 29/300
 - 179s - loss: 0.8435 - acc: 0.5579 - val_loss: 0.6854 - val_acc: 0.5467
Epoch 30/300
 - 202s - loss: 0.8434 - acc: 0.5584 - val_loss: 0.6817 - val_acc: 0.5593
Epoch 31/300
 - 202s - loss: 0.8435 - acc: 0.5584 - val_loss: 0.6822 - val_acc: 0.5550
Epoch 32/300
 - 162s - loss: 0.8435 - acc: 0.5585 - val_loss: 0.6912 - val_acc: 0.5345
Epoch 33/300
 - 175s - loss: 0.8435 - acc: 0.5598 - val_loss: 0.6756 - val_acc: 0.5697
Epoch 34/300
 - 183s - loss: 0.8434 - acc: 0.5592 - val_loss: 0.6845 - val_acc: 0.5404
Epoch 35/300
 - 186s - loss: 0.8434 - acc: 0.5589 - val_loss: 0.6639 - val_acc: 0.5896
Epoch 36/300
 - 198s - loss: 0.8434 - acc: 0.5586 - val_loss: 0.6762 - val_acc: 0.5694
Epoch 37/300
 - 180s - loss: 0.8434 - acc: 0.5601 - val_loss: 0.6796 - val_acc: 0.5624
Epoch 38/300
 - 194s - loss: 0.8435 - acc: 0.5585 - val_loss: 0.6810 - val_acc: 0.5583
Epoch 39/300
 - 182s - loss: 0.8435 - acc: 0.5599 - val_loss: 0.6814 - val_acc: 0.5542
Epoch 40/300
 - 180s - loss: 0.8433 - acc: 0.5592 - val_loss: 0.6746 - val_acc: 0.5698
Epoch 41/300
 - 201s - loss: 0.8434 - acc: 0.5595 - val_loss: 0.6836 - val_acc: 0.5574
Epoch 42/300
 - 203s - loss: 0.8435 - acc: 0.5586 - val_loss: 0.6725 - val_acc: 0.5675
Epoch 43/300
 - 191s - loss: 0.8433 - acc: 0.5592 - val_loss: 0.6758 - val_acc: 0.5655
Epoch 44/300
 - 190s - loss: 0.8433 - acc: 0.5591 - val_loss: 0.6962 - val_acc: 0.5008
Epoch 45/300
 - 185s - loss: 0.8434 - acc: 0.5576 - val_loss: 0.6870 - val_acc: 0.5382
Epoch 46/300
 - 207s - loss: 0.8434 - acc: 0.5576 - val_loss: 0.6781 - val_acc: 0.5564
Epoch 47/300
 - 184s - loss: 0.8434 - acc: 0.5586 - val_loss: 0.6865 - val_acc: 0.5408
Epoch 48/300
 - 178s - loss: 0.8434 - acc: 0.5584 - val_loss: 0.6797 - val_acc: 0.5605
Epoch 49/300
 - 192s - loss: 0.8434 - acc: 0.5593 - val_loss: 0.6747 - val_acc: 0.5683
Epoch 50/300
 - 196s - loss: 0.8433 - acc: 0.5589 - val_loss: 0.6753 - val_acc: 0.5667
Epoch 51/300
 - 187s - loss: 0.8433 - acc: 0.5599 - val_loss: 0.6793 - val_acc: 0.5638
Epoch 52/300
 - 162s - loss: 0.8436 - acc: 0.5595 - val_loss: 0.6787 - val_acc: 0.5617
Epoch 53/300
 - 141s - loss: 0.8434 - acc: 0.5596 - val_loss: 0.6823 - val_acc: 0.5558
Epoch 54/300
 - 174s - loss: 0.8433 - acc: 0.5584 - val_loss: 0.6831 - val_acc: 0.5477
Epoch 55/300
 - 172s - loss: 0.8434 - acc: 0.5586 - val_loss: 0.6854 - val_acc: 0.5501
Epoch 56/300
 - 160s - loss: 0.8435 - acc: 0.5596 - val_loss: 0.6890 - val_acc: 0.5400
Epoch 57/300
 - 156s - loss: 0.8433 - acc: 0.5595 - val_loss: 0.6831 - val_acc: 0.5548
Epoch 58/300
 - 170s - loss: 0.8432 - acc: 0.5592 - val_loss: 0.6742 - val_acc: 0.5667
Epoch 59/300
 - 150s - loss: 0.8431 - acc: 0.5585 - val_loss: 0.6813 - val_acc: 0.5551
Epoch 60/300
 - 152s - loss: 0.8434 - acc: 0.5592 - val_loss: 0.6779 - val_acc: 0.5615
Epoch 61/300
 - 149s - loss: 0.8433 - acc: 0.5591 - val_loss: 0.6744 - val_acc: 0.5690
Epoch 62/300
 - 157s - loss: 0.8433 - acc: 0.5587 - val_loss: 0.6771 - val_acc: 0.5642
Epoch 63/300
 - 182s - loss: 0.8433 - acc: 0.5590 - val_loss: 0.6869 - val_acc: 0.5423
Epoch 64/300
 - 182s - loss: 0.8432 - acc: 0.5586 - val_loss: 0.6854 - val_acc: 0.5487
Epoch 65/300
 - 168s - loss: 0.8432 - acc: 0.5598 - val_loss: 0.6736 - val_acc: 0.5611
Epoch 00065: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 1.22e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                        0.00062100                            1.0119   [                           -3.2778                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3420                           0.96981   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_NeutralEmEnergyFraction:                        0.00062100                            1.0119   [                           -3.2778                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3420                           0.96981   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.598
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.027 (0.029)       0.188 (0.194)      0.443 (0.448)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.489695393805
auc= 0.597613965299
0.597613965299
bjet_ChargedHadronEnergyFraction does NOT drop AUC. we don't need it
no  bjet_ChargedHadronEnergyFraction -->AUC= 0.597613965299
AUC cut= 0.597
======
TEST-> bjet_NeutralEmEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_5 (Dense)              (None, 128)               1152      
_________________________________________________________________
batch_normalization_4 (Batch (None, 128)               512       
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_5 (Batch (None, 128)               512       
_________________________________________________________________
activation_6 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               16512     
_________________________________________________________________
batch_normalization_6 (Batch (None, 128)               512       
_________________________________________________________________
activation_7 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 258       
_________________________________________________________________
activation_8 (Activation)    (None, 2)                 0         
=================================================================
Total params: 35,970
Trainable params: 35,202
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                  -0.105                   -0.355                   +0.028  -0.040    +0.302            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                  -0.070                   -0.083                   -0.146  -0.028    -0.007            +0.089
                         :          bjet_MuonEnergyFraction:                           -0.105                       -0.070                  +1.000                   -0.074                   -0.134  -0.019    -0.002            +0.164
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                  -0.074                   +1.000                   +0.218  +0.321    -0.289            -0.338
                         :         bjet_NeutralMultiplicity:                           +0.028                       -0.146                  -0.134                   +0.218                   +1.000  +0.263    -0.240            -0.123
                         :                          bjet_pt:                           -0.040                       -0.028                  -0.019                   +0.321                   +0.263  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.007                  -0.002                   -0.289                   -0.240  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.089                  +0.164                   -0.338                   -0.123  -0.001    +0.154            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_MuonEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                  -0.093                   -0.431                   -0.020  -0.048    +0.364            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                  -0.045                   -0.055                   -0.125  -0.007    -0.006            +0.051
                         :          bjet_MuonEnergyFraction:                           -0.093                       -0.045                  +1.000                   -0.038                   -0.098  +0.001    -0.013            +0.099
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                  -0.038                   +1.000                   +0.230  +0.316    -0.353            -0.365
                         :         bjet_NeutralMultiplicity:                           -0.020                       -0.125                  -0.098                   +0.230                   +1.000  +0.267    -0.274            -0.109
                         :                          bjet_pt:                           -0.048                       -0.007                  +0.001                   +0.316                   +0.267  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       -0.006                  -0.013                   -0.353                   -0.274  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.051                  +0.099                   -0.365                   -0.109  -0.009    +0.254            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_MuonEnergyFraction' <---> Output : variable 'bjet_MuonEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :          bjet_MuonEnergyFraction:                          0.029799                           0.10162   [                            0.0000                           0.98854 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :         bjet_NeutralMultiplicity:                            10.433                            4.9428   [                            0.0000                            48.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_MuonEnergyFraction          : 3.165e-03
                         :    3 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    4 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    5 : bjet_aeta                        : 2.410e-03
                         :    6 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    7 : bjet_NeutralMultiplicity         : 5.427e-04
                         :    8 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3091                           0.99867   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                         0.0031244                           0.99607   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 147s - loss: 0.8587 - acc: 0.5632 - val_loss: 0.6976 - val_acc: 0.5436
Epoch 2/300
 - 176s - loss: 0.8459 - acc: 0.5618 - val_loss: 0.6787 - val_acc: 0.5593
Epoch 3/300
 - 170s - loss: 0.8451 - acc: 0.5610 - val_loss: 0.6893 - val_acc: 0.5441
Epoch 4/300
 - 166s - loss: 0.8448 - acc: 0.5596 - val_loss: 0.6809 - val_acc: 0.5583
Epoch 5/300
 - 155s - loss: 0.8447 - acc: 0.5578 - val_loss: 0.6837 - val_acc: 0.5528
Epoch 6/300
 - 160s - loss: 0.8445 - acc: 0.5583 - val_loss: 0.6829 - val_acc: 0.5445
Epoch 7/300
 - 143s - loss: 0.8445 - acc: 0.5586 - val_loss: 0.6803 - val_acc: 0.5476
Epoch 8/300
 - 135s - loss: 0.8443 - acc: 0.5581 - val_loss: 0.6811 - val_acc: 0.5423
Epoch 9/300
 - 149s - loss: 0.8444 - acc: 0.5577 - val_loss: 0.6822 - val_acc: 0.5505
Epoch 10/300
 - 131s - loss: 0.8443 - acc: 0.5591 - val_loss: 0.6825 - val_acc: 0.5550
Epoch 11/300
 - 146s - loss: 0.8443 - acc: 0.5577 - val_loss: 0.6831 - val_acc: 0.5531
Epoch 12/300
 - 140s - loss: 0.8441 - acc: 0.5581 - val_loss: 0.6968 - val_acc: 0.5286
Epoch 13/300
 - 158s - loss: 0.8442 - acc: 0.5577 - val_loss: 0.6831 - val_acc: 0.5566
Epoch 14/300
 - 161s - loss: 0.8441 - acc: 0.5586 - val_loss: 0.6712 - val_acc: 0.5734
Epoch 15/300
 - 139s - loss: 0.8441 - acc: 0.5574 - val_loss: 0.6830 - val_acc: 0.5607
Epoch 16/300
 - 156s - loss: 0.8442 - acc: 0.5587 - val_loss: 0.6880 - val_acc: 0.5434
Epoch 17/300
 - 156s - loss: 0.8440 - acc: 0.5571 - val_loss: 0.6874 - val_acc: 0.5400
Epoch 18/300
 - 145s - loss: 0.8441 - acc: 0.5575 - val_loss: 0.6843 - val_acc: 0.5478
Epoch 19/300
 - 134s - loss: 0.8441 - acc: 0.5578 - val_loss: 0.6730 - val_acc: 0.5691
Epoch 20/300
 - 118s - loss: 0.8440 - acc: 0.5571 - val_loss: 0.6811 - val_acc: 0.5589
Epoch 21/300
 - 153s - loss: 0.8441 - acc: 0.5579 - val_loss: 0.6819 - val_acc: 0.5482
Epoch 22/300
 - 155s - loss: 0.8439 - acc: 0.5581 - val_loss: 0.6876 - val_acc: 0.5383
Epoch 23/300
 - 147s - loss: 0.8439 - acc: 0.5579 - val_loss: 0.6931 - val_acc: 0.5297
Epoch 24/300
 - 163s - loss: 0.8441 - acc: 0.5586 - val_loss: 0.6914 - val_acc: 0.5330
Epoch 25/300
 - 149s - loss: 0.8440 - acc: 0.5586 - val_loss: 0.6838 - val_acc: 0.5493
Epoch 26/300
 - 152s - loss: 0.8438 - acc: 0.5589 - val_loss: 0.6808 - val_acc: 0.5588
Epoch 27/300
 - 143s - loss: 0.8438 - acc: 0.5581 - val_loss: 0.6859 - val_acc: 0.5457
Epoch 28/300
 - 124s - loss: 0.8439 - acc: 0.5577 - val_loss: 0.6805 - val_acc: 0.5586
Epoch 29/300
 - 134s - loss: 0.8439 - acc: 0.5578 - val_loss: 0.6833 - val_acc: 0.5474
Epoch 30/300
 - 142s - loss: 0.8439 - acc: 0.5597 - val_loss: 0.6805 - val_acc: 0.5544
Epoch 31/300
 - 132s - loss: 0.8439 - acc: 0.5572 - val_loss: 0.6856 - val_acc: 0.5507
Epoch 32/300
 - 143s - loss: 0.8437 - acc: 0.5591 - val_loss: 0.6758 - val_acc: 0.5708
Epoch 33/300
 - 132s - loss: 0.8438 - acc: 0.5588 - val_loss: 0.6821 - val_acc: 0.5580
Epoch 34/300
 - 153s - loss: 0.8439 - acc: 0.5578 - val_loss: 0.6867 - val_acc: 0.5414
Epoch 35/300
 - 146s - loss: 0.8438 - acc: 0.5586 - val_loss: 0.6813 - val_acc: 0.5581
Epoch 36/300
 - 158s - loss: 0.8438 - acc: 0.5587 - val_loss: 0.6750 - val_acc: 0.5667
Epoch 37/300
 - 157s - loss: 0.8439 - acc: 0.5585 - val_loss: 0.6783 - val_acc: 0.5684
Epoch 38/300
 - 115s - loss: 0.8438 - acc: 0.5575 - val_loss: 0.6771 - val_acc: 0.5718
Epoch 39/300
 - 116s - loss: 0.8439 - acc: 0.5589 - val_loss: 0.6785 - val_acc: 0.5616
Epoch 40/300
 - 146s - loss: 0.8438 - acc: 0.5582 - val_loss: 0.6805 - val_acc: 0.5561
Epoch 41/300
 - 112s - loss: 0.8437 - acc: 0.5592 - val_loss: 0.6848 - val_acc: 0.5518
Epoch 42/300
 - 134s - loss: 0.8438 - acc: 0.5584 - val_loss: 0.6844 - val_acc: 0.5411
Epoch 43/300
 - 157s - loss: 0.8437 - acc: 0.5584 - val_loss: 0.6798 - val_acc: 0.5527
Epoch 44/300
 - 160s - loss: 0.8437 - acc: 0.5582 - val_loss: 0.6793 - val_acc: 0.5580
Epoch 00044: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 6.43e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3420                           0.96981   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :          bjet_MuonEnergyFraction:                           -2.3420                           0.96981   [                           -2.6787                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.598
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.024 (0.025)       0.189 (0.191)      0.444 (0.446)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.484819840663
auc= 0.597719102499
0.597719102499
bjet_NeutralEmEnergyFraction does NOT drop AUC. we don't need it
no  bjet_NeutralEmEnergyFraction -->AUC= 0.597719102499
AUC cut= 0.597
======
TEST-> bjet_MuonEnergyFraction
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_9 (Dense)              (None, 128)               1024      
_________________________________________________________________
batch_normalization_7 (Batch (None, 128)               512       
_________________________________________________________________
activation_9 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_10 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_8 (Batch (None, 128)               512       
_________________________________________________________________
activation_10 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_11 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
activation_11 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_9 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_12 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,842
Trainable params: 35,074
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355                   +0.028  -0.040    +0.302            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083                   -0.146  -0.028    -0.007            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000                   +0.218  +0.321    -0.289            -0.338
                         :         bjet_NeutralMultiplicity:                           +0.028                       -0.146                   +0.218                   +1.000  +0.263    -0.240            -0.123
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321                   +0.263  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.007                   -0.289                   -0.240  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338                   -0.123  -0.001    +0.154            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_NeutralMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431                   -0.020  -0.048    +0.364            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055                   -0.125  -0.007    -0.006            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000                   +0.230  +0.316    -0.353            -0.365
                         :         bjet_NeutralMultiplicity:                           -0.020                       -0.125                   +0.230                   +1.000  +0.267    -0.274            -0.109
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316                   +0.267  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       -0.006                   -0.353                   -0.274  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365                   -0.109  -0.009    +0.254            +1.000
                         : -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_NeutralMultiplicity' <---> Output : variable 'bjet_NeutralMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :         bjet_NeutralMultiplicity:                            10.433                            4.9428   [                            0.0000                            48.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_aeta                        : 2.410e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    6 : bjet_NeutralMultiplicity         : 5.427e-04
                         :    7 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                         0.0031244                           0.99607   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 141s - loss: 0.8586 - acc: 0.5628 - val_loss: 0.6908 - val_acc: 0.5420
Epoch 2/300
 - 167s - loss: 0.8460 - acc: 0.5615 - val_loss: 0.6768 - val_acc: 0.5699
Epoch 3/300
 - 151s - loss: 0.8453 - acc: 0.5604 - val_loss: 0.6859 - val_acc: 0.5415
Epoch 4/300
 - 136s - loss: 0.8450 - acc: 0.5594 - val_loss: 0.6816 - val_acc: 0.5514
Epoch 5/300
 - 113s - loss: 0.8448 - acc: 0.5592 - val_loss: 0.6862 - val_acc: 0.5469
Epoch 6/300
 - 147s - loss: 0.8447 - acc: 0.5583 - val_loss: 0.6876 - val_acc: 0.5536
Epoch 7/300
 - 145s - loss: 0.8446 - acc: 0.5589 - val_loss: 0.6814 - val_acc: 0.5509
Epoch 8/300
 - 143s - loss: 0.8447 - acc: 0.5595 - val_loss: 0.6749 - val_acc: 0.5673
Epoch 9/300
 - 129s - loss: 0.8446 - acc: 0.5588 - val_loss: 0.6828 - val_acc: 0.5533
Epoch 10/300
 - 138s - loss: 0.8444 - acc: 0.5600 - val_loss: 0.6807 - val_acc: 0.5541
Epoch 11/300
 - 146s - loss: 0.8445 - acc: 0.5587 - val_loss: 0.6871 - val_acc: 0.5470
Epoch 12/300
 - 143s - loss: 0.8445 - acc: 0.5580 - val_loss: 0.6782 - val_acc: 0.5595
Epoch 13/300
 - 150s - loss: 0.8444 - acc: 0.5587 - val_loss: 0.6739 - val_acc: 0.5753
Epoch 14/300
 - 125s - loss: 0.8444 - acc: 0.5594 - val_loss: 0.6891 - val_acc: 0.5382
Epoch 15/300
 - 111s - loss: 0.8444 - acc: 0.5594 - val_loss: 0.6776 - val_acc: 0.5606
Epoch 16/300
 - 138s - loss: 0.8444 - acc: 0.5588 - val_loss: 0.6727 - val_acc: 0.5748
Epoch 17/300
 - 138s - loss: 0.8443 - acc: 0.5580 - val_loss: 0.6756 - val_acc: 0.5634
Epoch 18/300
 - 130s - loss: 0.8443 - acc: 0.5581 - val_loss: 0.6814 - val_acc: 0.5518
Epoch 19/300
 - 140s - loss: 0.8444 - acc: 0.5589 - val_loss: 0.6848 - val_acc: 0.5428
Epoch 20/300
 - 146s - loss: 0.8443 - acc: 0.5580 - val_loss: 0.6836 - val_acc: 0.5543
Epoch 21/300
 - 126s - loss: 0.8442 - acc: 0.5576 - val_loss: 0.6794 - val_acc: 0.5646
Epoch 22/300
 - 140s - loss: 0.8442 - acc: 0.5587 - val_loss: 0.6820 - val_acc: 0.5510
Epoch 23/300
 - 143s - loss: 0.8442 - acc: 0.5596 - val_loss: 0.6797 - val_acc: 0.5577
Epoch 24/300
 - 157s - loss: 0.8442 - acc: 0.5596 - val_loss: 0.6764 - val_acc: 0.5683
Epoch 25/300
 - 152s - loss: 0.8443 - acc: 0.5596 - val_loss: 0.6829 - val_acc: 0.5550
Epoch 26/300
 - 129s - loss: 0.8442 - acc: 0.5588 - val_loss: 0.6788 - val_acc: 0.5600
Epoch 27/300
 - 124s - loss: 0.8441 - acc: 0.5590 - val_loss: 0.6888 - val_acc: 0.5452
Epoch 28/300
 - 142s - loss: 0.8441 - acc: 0.5596 - val_loss: 0.6791 - val_acc: 0.5553
Epoch 29/300
 - 140s - loss: 0.8442 - acc: 0.5610 - val_loss: 0.6806 - val_acc: 0.5532
Epoch 30/300
 - 127s - loss: 0.8441 - acc: 0.5607 - val_loss: 0.6952 - val_acc: 0.5323
Epoch 31/300
 - 122s - loss: 0.8440 - acc: 0.5611 - val_loss: 0.6826 - val_acc: 0.5498
Epoch 32/300
 - 127s - loss: 0.8441 - acc: 0.5612 - val_loss: 0.6856 - val_acc: 0.5503
Epoch 33/300
 - 108s - loss: 0.8442 - acc: 0.5612 - val_loss: 0.6744 - val_acc: 0.5676
Epoch 34/300
 - 115s - loss: 0.8441 - acc: 0.5601 - val_loss: 0.6787 - val_acc: 0.5651
Epoch 35/300
 - 149s - loss: 0.8442 - acc: 0.5604 - val_loss: 0.6815 - val_acc: 0.5539
Epoch 36/300
 - 146s - loss: 0.8441 - acc: 0.5604 - val_loss: 0.6784 - val_acc: 0.5556
Epoch 37/300
 - 140s - loss: 0.8440 - acc: 0.5605 - val_loss: 0.6790 - val_acc: 0.5668
Epoch 38/300
 - 156s - loss: 0.8440 - acc: 0.5591 - val_loss: 0.6823 - val_acc: 0.5521
Epoch 39/300
 - 158s - loss: 0.8441 - acc: 0.5605 - val_loss: 0.6819 - val_acc: 0.5557
Epoch 40/300
 - 143s - loss: 0.8441 - acc: 0.5596 - val_loss: 0.6848 - val_acc: 0.5448
Epoch 41/300
 - 128s - loss: 0.8442 - acc: 0.5592 - val_loss: 0.6808 - val_acc: 0.5624
Epoch 42/300
 - 100s - loss: 0.8440 - acc: 0.5596 - val_loss: 0.6824 - val_acc: 0.5561
Epoch 43/300
 - 116s - loss: 0.8440 - acc: 0.5592 - val_loss: 0.6851 - val_acc: 0.5474
Epoch 44/300
 - 154s - loss: 0.8440 - acc: 0.5586 - val_loss: 0.6811 - val_acc: 0.5533
Epoch 45/300
 - 131s - loss: 0.8442 - acc: 0.5585 - val_loss: 0.6826 - val_acc: 0.5591
Epoch 46/300
 - 118s - loss: 0.8440 - acc: 0.5596 - val_loss: 0.6888 - val_acc: 0.5412
Epoch 00046: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 6.29e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :         bjet_NeutralMultiplicity:                          0.030468                            1.0076   [                           -4.5867                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.597
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.022 (0.027)       0.188 (0.193)      0.443 (0.445)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.465703334651
auc= 0.597180968349
0.597180968349
bjet_MuonEnergyFraction does NOT drop AUC. we don't need it
no  bjet_MuonEnergyFraction -->AUC= 0.597180968349
AUC cut= 0.597
======
TEST-> bjet_NeutralMultiplicity
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_13 (Dense)             (None, 128)               896       
_________________________________________________________________
batch_normalization_10 (Batc (None, 128)               512       
_________________________________________________________________
activation_13 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_10 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_14 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_11 (Batc (None, 128)               512       
_________________________________________________________________
activation_14 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_11 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_15 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_12 (Batc (None, 128)               512       
_________________________________________________________________
activation_15 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_12 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_16 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_16 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,714
Trainable params: 34,946
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040    +0.302            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028    -0.007            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321    -0.289            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.007                   -0.289  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001    +0.154            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048    +0.364            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007    -0.006            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316    -0.353            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       -0.006                   -0.353  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009    +0.254            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_aeta                        : 2.410e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    6 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 147s - loss: 0.8585 - acc: 0.5630 - val_loss: 0.6800 - val_acc: 0.5653
Epoch 2/300
 - 152s - loss: 0.8462 - acc: 0.5613 - val_loss: 0.6778 - val_acc: 0.5618
Epoch 3/300
 - 145s - loss: 0.8454 - acc: 0.5607 - val_loss: 0.6778 - val_acc: 0.5682
Epoch 4/300
 - 140s - loss: 0.8452 - acc: 0.5605 - val_loss: 0.6725 - val_acc: 0.5704
Epoch 5/300
 - 130s - loss: 0.8451 - acc: 0.5596 - val_loss: 0.6781 - val_acc: 0.5603
Epoch 6/300
 - 125s - loss: 0.8450 - acc: 0.5585 - val_loss: 0.6840 - val_acc: 0.5475
Epoch 7/300
 - 140s - loss: 0.8450 - acc: 0.5596 - val_loss: 0.6891 - val_acc: 0.5444
Epoch 8/300
 - 136s - loss: 0.8450 - acc: 0.5601 - val_loss: 0.6784 - val_acc: 0.5614
Epoch 9/300
 - 107s - loss: 0.8450 - acc: 0.5592 - val_loss: 0.6738 - val_acc: 0.5709
Epoch 10/300
 - 108s - loss: 0.8449 - acc: 0.5584 - val_loss: 0.6807 - val_acc: 0.5533
Epoch 11/300
 - 148s - loss: 0.8447 - acc: 0.5592 - val_loss: 0.6909 - val_acc: 0.5356
Epoch 12/300
 - 161s - loss: 0.8448 - acc: 0.5584 - val_loss: 0.6879 - val_acc: 0.5421
Epoch 13/300
 - 154s - loss: 0.8447 - acc: 0.5591 - val_loss: 0.6742 - val_acc: 0.5697
Epoch 14/300
 - 126s - loss: 0.8446 - acc: 0.5594 - val_loss: 0.6795 - val_acc: 0.5586
Epoch 15/300
 - 133s - loss: 0.8446 - acc: 0.5604 - val_loss: 0.6861 - val_acc: 0.5419
Epoch 16/300
 - 132s - loss: 0.8447 - acc: 0.5581 - val_loss: 0.6865 - val_acc: 0.5419
Epoch 17/300
 - 122s - loss: 0.8444 - acc: 0.5594 - val_loss: 0.6756 - val_acc: 0.5705
Epoch 18/300
 - 130s - loss: 0.8447 - acc: 0.5611 - val_loss: 0.6821 - val_acc: 0.5501
Epoch 19/300
 - 134s - loss: 0.8447 - acc: 0.5607 - val_loss: 0.6774 - val_acc: 0.5604
Epoch 20/300
 - 122s - loss: 0.8447 - acc: 0.5600 - val_loss: 0.6739 - val_acc: 0.5750
Epoch 21/300
 - 130s - loss: 0.8445 - acc: 0.5598 - val_loss: 0.6802 - val_acc: 0.5598
Epoch 22/300
 - 147s - loss: 0.8446 - acc: 0.5602 - val_loss: 0.6761 - val_acc: 0.5729
Epoch 23/300
 - 136s - loss: 0.8445 - acc: 0.5602 - val_loss: 0.6811 - val_acc: 0.5578
Epoch 24/300
 - 131s - loss: 0.8445 - acc: 0.5603 - val_loss: 0.6863 - val_acc: 0.5472
Epoch 25/300
 - 124s - loss: 0.8446 - acc: 0.5607 - val_loss: 0.6795 - val_acc: 0.5625
Epoch 26/300
 - 127s - loss: 0.8445 - acc: 0.5600 - val_loss: 0.6855 - val_acc: 0.5446
Epoch 27/300
 - 141s - loss: 0.8445 - acc: 0.5605 - val_loss: 0.6776 - val_acc: 0.5689
Epoch 28/300
 - 160s - loss: 0.8445 - acc: 0.5599 - val_loss: 0.6763 - val_acc: 0.5660
Epoch 29/300
 - 151s - loss: 0.8444 - acc: 0.5606 - val_loss: 0.6891 - val_acc: 0.5471
Epoch 30/300
 - 119s - loss: 0.8445 - acc: 0.5616 - val_loss: 0.6819 - val_acc: 0.5528
Epoch 31/300
 - 121s - loss: 0.8445 - acc: 0.5586 - val_loss: 0.6811 - val_acc: 0.5532
Epoch 32/300
 - 137s - loss: 0.8445 - acc: 0.5590 - val_loss: 0.6789 - val_acc: 0.5737
Epoch 33/300
 - 127s - loss: 0.8444 - acc: 0.5597 - val_loss: 0.6714 - val_acc: 0.5701
Epoch 34/300
 - 133s - loss: 0.8444 - acc: 0.5608 - val_loss: 0.6950 - val_acc: 0.5331
Epoch 35/300
 - 126s - loss: 0.8445 - acc: 0.5591 - val_loss: 0.6884 - val_acc: 0.5625
Epoch 36/300
 - 124s - loss: 0.8445 - acc: 0.5590 - val_loss: 0.6721 - val_acc: 0.5728
Epoch 37/300
 - 119s - loss: 0.8444 - acc: 0.5591 - val_loss: 0.6722 - val_acc: 0.5808
Epoch 38/300
 - 119s - loss: 0.8444 - acc: 0.5601 - val_loss: 0.6833 - val_acc: 0.5505
Epoch 39/300
 - 108s - loss: 0.8445 - acc: 0.5606 - val_loss: 0.6762 - val_acc: 0.5666
Epoch 40/300
 - 122s - loss: 0.8444 - acc: 0.5603 - val_loss: 0.6767 - val_acc: 0.5635
Epoch 41/300
 - 137s - loss: 0.8445 - acc: 0.5601 - val_loss: 0.6818 - val_acc: 0.5635
Epoch 42/300
 - 158s - loss: 0.8445 - acc: 0.5597 - val_loss: 0.6837 - val_acc: 0.5569
Epoch 43/300
 - 141s - loss: 0.8445 - acc: 0.5592 - val_loss: 0.6729 - val_acc: 0.5785
Epoch 44/300
 - 113s - loss: 0.8443 - acc: 0.5597 - val_loss: 0.6783 - val_acc: 0.5585
Epoch 45/300
 - 107s - loss: 0.8444 - acc: 0.5601 - val_loss: 0.6795 - val_acc: 0.5613
Epoch 46/300
 - 129s - loss: 0.8445 - acc: 0.5601 - val_loss: 0.6760 - val_acc: 0.5677
Epoch 47/300
 - 128s - loss: 0.8445 - acc: 0.5588 - val_loss: 0.6841 - val_acc: 0.5534
Epoch 48/300
 - 122s - loss: 0.8443 - acc: 0.5601 - val_loss: 0.6677 - val_acc: 0.5812
Epoch 49/300
 - 122s - loss: 0.8444 - acc: 0.5596 - val_loss: 0.6765 - val_acc: 0.5658
Epoch 50/300
 - 131s - loss: 0.8444 - acc: 0.5602 - val_loss: 0.6724 - val_acc: 0.5811
Epoch 51/300
 - 127s - loss: 0.8443 - acc: 0.5609 - val_loss: 0.6857 - val_acc: 0.5422
Epoch 52/300
 - 144s - loss: 0.8444 - acc: 0.5604 - val_loss: 0.6810 - val_acc: 0.5554
Epoch 53/300
 - 146s - loss: 0.8443 - acc: 0.5600 - val_loss: 0.6788 - val_acc: 0.5636
Epoch 54/300
 - 142s - loss: 0.8443 - acc: 0.5610 - val_loss: 0.6793 - val_acc: 0.5539
Epoch 55/300
 - 141s - loss: 0.8444 - acc: 0.5607 - val_loss: 0.6866 - val_acc: 0.5490
Epoch 56/300
 - 131s - loss: 0.8442 - acc: 0.5601 - val_loss: 0.6721 - val_acc: 0.5758
Epoch 57/300
 - 115s - loss: 0.8444 - acc: 0.5605 - val_loss: 0.6761 - val_acc: 0.5729
Epoch 58/300
 - 118s - loss: 0.8445 - acc: 0.5586 - val_loss: 0.6788 - val_acc: 0.5696
Epoch 59/300
 - 109s - loss: 0.8444 - acc: 0.5603 - val_loss: 0.6748 - val_acc: 0.5683
Epoch 60/300
 - 113s - loss: 0.8443 - acc: 0.5609 - val_loss: 0.6834 - val_acc: 0.5503
Epoch 61/300
 - 140s - loss: 0.8444 - acc: 0.5605 - val_loss: 0.6794 - val_acc: 0.5686
Epoch 62/300
 - 156s - loss: 0.8443 - acc: 0.5605 - val_loss: 0.6782 - val_acc: 0.5649
Epoch 63/300
 - 159s - loss: 0.8445 - acc: 0.5610 - val_loss: 0.6975 - val_acc: 0.5027
Epoch 64/300
 - 137s - loss: 0.8444 - acc: 0.5594 - val_loss: 0.6764 - val_acc: 0.5674
Epoch 65/300
 - 96s - loss: 0.8443 - acc: 0.5604 - val_loss: 0.6856 - val_acc: 0.5488
Epoch 66/300
 - 86s - loss: 0.8442 - acc: 0.5605 - val_loss: 0.6868 - val_acc: 0.5463
Epoch 67/300
 - 102s - loss: 0.8443 - acc: 0.5605 - val_loss: 0.6813 - val_acc: 0.5545
Epoch 68/300
 - 126s - loss: 0.8442 - acc: 0.5608 - val_loss: 0.6835 - val_acc: 0.5470
Epoch 69/300
 - 141s - loss: 0.8445 - acc: 0.5604 - val_loss: 0.6768 - val_acc: 0.5653
Epoch 70/300
 - 155s - loss: 0.8444 - acc: 0.5605 - val_loss: 0.6713 - val_acc: 0.5746
Epoch 71/300
 - 150s - loss: 0.8444 - acc: 0.5603 - val_loss: 0.6758 - val_acc: 0.5657
Epoch 72/300
 - 138s - loss: 0.8444 - acc: 0.5595 - val_loss: 0.6717 - val_acc: 0.5713
Epoch 73/300
 - 113s - loss: 0.8444 - acc: 0.5595 - val_loss: 0.6799 - val_acc: 0.5582
Epoch 74/300
 - 111s - loss: 0.8444 - acc: 0.5591 - val_loss: 0.6864 - val_acc: 0.5320
Epoch 75/300
 - 114s - loss: 0.8444 - acc: 0.5579 - val_loss: 0.6835 - val_acc: 0.5530
Epoch 76/300
 - 119s - loss: 0.8443 - acc: 0.5582 - val_loss: 0.6800 - val_acc: 0.5558
Epoch 77/300
 - 139s - loss: 0.8443 - acc: 0.5579 - val_loss: 0.6863 - val_acc: 0.5469
Epoch 78/300
 - 131s - loss: 0.8443 - acc: 0.5592 - val_loss: 0.6740 - val_acc: 0.5709
Epoch 00078: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 1.02e+04 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.596
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.023 (0.025)       0.184 (0.191)      0.441 (0.448)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.499818135614
auc= 0.596238910342
0.596238910342
this variable bjet_NeutralMultiplicity drops the AUC for Trial#== 2
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_17 (Dense)             (None, 128)               896       
_________________________________________________________________
batch_normalization_13 (Batc (None, 128)               512       
_________________________________________________________________
activation_17 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_13 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_18 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_14 (Batc (None, 128)               512       
_________________________________________________________________
activation_18 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_14 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_19 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_15 (Batc (None, 128)               512       
_________________________________________________________________
activation_19 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_15 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_20 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_20 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,714
Trainable params: 34,946
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040    +0.302            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028    -0.007            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321    -0.289            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.007                   -0.289  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001    +0.154            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048    +0.364            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007    -0.006            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316    -0.353            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       -0.006                   -0.353  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009    +0.254            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_aeta                        : 2.410e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    6 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 117s - loss: 0.8584 - acc: 0.5638 - val_loss: 0.6808 - val_acc: 0.5670
Epoch 2/300
 - 103s - loss: 0.8463 - acc: 0.5625 - val_loss: 0.6825 - val_acc: 0.5596
Epoch 3/300
 - 123s - loss: 0.8455 - acc: 0.5627 - val_loss: 0.6847 - val_acc: 0.5546
Epoch 4/300
 - 148s - loss: 0.8453 - acc: 0.5606 - val_loss: 0.6842 - val_acc: 0.5517
Epoch 5/300
 - 154s - loss: 0.8451 - acc: 0.5605 - val_loss: 0.6809 - val_acc: 0.5623
Epoch 6/300
 - 145s - loss: 0.8451 - acc: 0.5595 - val_loss: 0.6742 - val_acc: 0.5676
Epoch 7/300
 - 96s - loss: 0.8449 - acc: 0.5592 - val_loss: 0.6751 - val_acc: 0.5659
Epoch 8/300
 - 97s - loss: 0.8449 - acc: 0.5584 - val_loss: 0.6746 - val_acc: 0.5728
Epoch 9/300
 - 89s - loss: 0.8449 - acc: 0.5596 - val_loss: 0.6813 - val_acc: 0.5582
Epoch 10/300
 - 106s - loss: 0.8449 - acc: 0.5605 - val_loss: 0.6855 - val_acc: 0.5535
Epoch 11/300
 - 127s - loss: 0.8449 - acc: 0.5593 - val_loss: 0.6800 - val_acc: 0.5569
Epoch 12/300
 - 140s - loss: 0.8446 - acc: 0.5592 - val_loss: 0.6830 - val_acc: 0.5522
Epoch 13/300
 - 152s - loss: 0.8448 - acc: 0.5592 - val_loss: 0.6759 - val_acc: 0.5661
Epoch 14/300
 - 158s - loss: 0.8448 - acc: 0.5599 - val_loss: 0.6853 - val_acc: 0.5539
Epoch 15/300
 - 159s - loss: 0.8446 - acc: 0.5585 - val_loss: 0.6823 - val_acc: 0.5540
Epoch 16/300
 - 145s - loss: 0.8446 - acc: 0.5598 - val_loss: 0.6803 - val_acc: 0.5655
Epoch 17/300
 - 106s - loss: 0.8446 - acc: 0.5601 - val_loss: 0.6907 - val_acc: 0.5308
Epoch 18/300
 - 87s - loss: 0.8446 - acc: 0.5600 - val_loss: 0.6866 - val_acc: 0.5408
Epoch 19/300
 - 84s - loss: 0.8446 - acc: 0.5602 - val_loss: 0.6817 - val_acc: 0.5475
Epoch 20/300
 - 108s - loss: 0.8445 - acc: 0.5592 - val_loss: 0.6847 - val_acc: 0.5526
Epoch 21/300
 - 125s - loss: 0.8445 - acc: 0.5602 - val_loss: 0.6847 - val_acc: 0.5478
Epoch 22/300
 - 141s - loss: 0.8446 - acc: 0.5599 - val_loss: 0.6806 - val_acc: 0.5605
Epoch 23/300
 - 137s - loss: 0.8445 - acc: 0.5605 - val_loss: 0.6756 - val_acc: 0.5634
Epoch 24/300
 - 145s - loss: 0.8446 - acc: 0.5612 - val_loss: 0.6816 - val_acc: 0.5607
Epoch 25/300
 - 137s - loss: 0.8446 - acc: 0.5613 - val_loss: 0.6804 - val_acc: 0.5558
Epoch 26/300
 - 115s - loss: 0.8445 - acc: 0.5594 - val_loss: 0.6779 - val_acc: 0.5601
Epoch 27/300
 - 98s - loss: 0.8445 - acc: 0.5595 - val_loss: 0.6842 - val_acc: 0.5431
Epoch 28/300
 - 105s - loss: 0.8444 - acc: 0.5599 - val_loss: 0.6870 - val_acc: 0.5460
Epoch 29/300
 - 98s - loss: 0.8443 - acc: 0.5585 - val_loss: 0.6759 - val_acc: 0.5702
Epoch 30/300
 - 123s - loss: 0.8444 - acc: 0.5604 - val_loss: 0.6916 - val_acc: 0.5341
Epoch 31/300
 - 148s - loss: 0.8446 - acc: 0.5605 - val_loss: 0.6843 - val_acc: 0.5557
Epoch 32/300
 - 153s - loss: 0.8445 - acc: 0.5604 - val_loss: 0.6885 - val_acc: 0.5420
Epoch 33/300
 - 156s - loss: 0.8444 - acc: 0.5602 - val_loss: 0.6810 - val_acc: 0.5535
Epoch 34/300
 - 110s - loss: 0.8444 - acc: 0.5598 - val_loss: 0.6906 - val_acc: 0.5421
Epoch 35/300
 - 89s - loss: 0.8445 - acc: 0.5599 - val_loss: 0.6937 - val_acc: 0.5277
Epoch 36/300
 - 73s - loss: 0.8445 - acc: 0.5592 - val_loss: 0.6809 - val_acc: 0.5590
Epoch 00036: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 4.41e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.596
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.021 (0.025)       0.185 (0.191)      0.441 (0.446)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.487811964891
auc= 0.596291377831
0.596291377831
this variable bjet_NeutralMultiplicity drops the AUC for Trial#== 3
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_NeutralMultiplicity']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_21 (Dense)             (None, 128)               896       
_________________________________________________________________
batch_normalization_16 (Batc (None, 128)               512       
_________________________________________________________________
activation_21 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_16 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_22 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_17 (Batc (None, 128)               512       
_________________________________________________________________
activation_22 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_17 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_23 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_18 (Batc (None, 128)               512       
_________________________________________________________________
activation_23 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_18 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_24 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_24 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,714
Trainable params: 34,946
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040    +0.302            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028    -0.007            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321    -0.289            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000    -0.071            -0.001
                         :                        bjet_aeta:                           +0.302                       -0.007                   -0.289  -0.071    +1.000            +0.154
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001    +0.154            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt bjet_aeta fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048    +0.364            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007    -0.006            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316    -0.353            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000    -0.074            -0.009
                         :                        bjet_aeta:                           +0.364                       -0.006                   -0.353  -0.074    +1.000            +0.254
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009    +0.254            +1.000
                         : ------------------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'bjet_aeta' <---> Output : variable 'bjet_aeta'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                        bjet_aeta:                            1.1195                           0.74606   [                        5.6320e-07                            3.5234 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_aeta                        : 2.410e-03
                         :    5 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    6 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                        bjet_aeta:                         0.0028103                           0.99602   [                           -3.2508                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 135s - loss: 0.8583 - acc: 0.5638 - val_loss: 0.6879 - val_acc: 0.5550
Epoch 2/300
 - 132s - loss: 0.8462 - acc: 0.5628 - val_loss: 0.6797 - val_acc: 0.5682
Epoch 3/300
 - 143s - loss: 0.8455 - acc: 0.5616 - val_loss: 0.6832 - val_acc: 0.5590
Epoch 4/300
 - 146s - loss: 0.8451 - acc: 0.5621 - val_loss: 0.6863 - val_acc: 0.5425
Epoch 5/300
 - 112s - loss: 0.8450 - acc: 0.5605 - val_loss: 0.6892 - val_acc: 0.5419
Epoch 6/300
 - 91s - loss: 0.8448 - acc: 0.5592 - val_loss: 0.6799 - val_acc: 0.5585
Epoch 7/300
 - 66s - loss: 0.8448 - acc: 0.5591 - val_loss: 0.6786 - val_acc: 0.5609
Epoch 8/300
 - 65s - loss: 0.8447 - acc: 0.5577 - val_loss: 0.6831 - val_acc: 0.5497
Epoch 9/300
 - 98s - loss: 0.8447 - acc: 0.5587 - val_loss: 0.6802 - val_acc: 0.5576
Epoch 10/300
 - 109s - loss: 0.8448 - acc: 0.5573 - val_loss: 0.6836 - val_acc: 0.5550
Epoch 11/300
 - 150s - loss: 0.8446 - acc: 0.5573 - val_loss: 0.6929 - val_acc: 0.5341
Epoch 12/300
 - 146s - loss: 0.8444 - acc: 0.5582 - val_loss: 0.6863 - val_acc: 0.5488
Epoch 13/300
 - 143s - loss: 0.8445 - acc: 0.5592 - val_loss: 0.6654 - val_acc: 0.5831
Epoch 14/300
 - 116s - loss: 0.8447 - acc: 0.5581 - val_loss: 0.6741 - val_acc: 0.5674
Epoch 15/300
 - 101s - loss: 0.8445 - acc: 0.5584 - val_loss: 0.6797 - val_acc: 0.5623
Epoch 16/300
 - 96s - loss: 0.8446 - acc: 0.5581 - val_loss: 0.6820 - val_acc: 0.5493
Epoch 17/300
 - 93s - loss: 0.8445 - acc: 0.5594 - val_loss: 0.6921 - val_acc: 0.5297
Epoch 18/300
 - 102s - loss: 0.8445 - acc: 0.5591 - val_loss: 0.6821 - val_acc: 0.5562
Epoch 19/300
 - 106s - loss: 0.8445 - acc: 0.5604 - val_loss: 0.6852 - val_acc: 0.5465
Epoch 20/300
 - 106s - loss: 0.8445 - acc: 0.5602 - val_loss: 0.6829 - val_acc: 0.5583
Epoch 21/300
 - 126s - loss: 0.8445 - acc: 0.5609 - val_loss: 0.6845 - val_acc: 0.5521
Epoch 22/300
 - 119s - loss: 0.8444 - acc: 0.5600 - val_loss: 0.6924 - val_acc: 0.5349
Epoch 23/300
 - 122s - loss: 0.8445 - acc: 0.5591 - val_loss: 0.6752 - val_acc: 0.5773
Epoch 24/300
 - 107s - loss: 0.8443 - acc: 0.5604 - val_loss: 0.6871 - val_acc: 0.5418
Epoch 25/300
 - 92s - loss: 0.8443 - acc: 0.5590 - val_loss: 0.6835 - val_acc: 0.5541
Epoch 26/300
 - 112s - loss: 0.8444 - acc: 0.5596 - val_loss: 0.7022 - val_acc: 0.5270
Epoch 27/300
 - 113s - loss: 0.8445 - acc: 0.5600 - val_loss: 0.6770 - val_acc: 0.5643
Epoch 28/300
 - 127s - loss: 0.8444 - acc: 0.5591 - val_loss: 0.6853 - val_acc: 0.5542
Epoch 29/300
 - 141s - loss: 0.8444 - acc: 0.5599 - val_loss: 0.6866 - val_acc: 0.5425
Epoch 30/300
 - 100s - loss: 0.8444 - acc: 0.5598 - val_loss: 0.6939 - val_acc: 0.5332
Epoch 31/300
 - 84s - loss: 0.8444 - acc: 0.5597 - val_loss: 0.6806 - val_acc: 0.5578
Epoch 32/300
 - 69s - loss: 0.8443 - acc: 0.5588 - val_loss: 0.6884 - val_acc: 0.5444
Epoch 33/300
 - 86s - loss: 0.8444 - acc: 0.5600 - val_loss: 0.6862 - val_acc: 0.5474
Epoch 34/300
 - 116s - loss: 0.8444 - acc: 0.5596 - val_loss: 0.6844 - val_acc: 0.5540
Epoch 35/300
 - 116s - loss: 0.8444 - acc: 0.5597 - val_loss: 0.6772 - val_acc: 0.5677
Epoch 36/300
 - 126s - loss: 0.8444 - acc: 0.5587 - val_loss: 0.6776 - val_acc: 0.5629
Epoch 37/300
 - 129s - loss: 0.8444 - acc: 0.5596 - val_loss: 0.6815 - val_acc: 0.5606
Epoch 38/300
 - 135s - loss: 0.8444 - acc: 0.5600 - val_loss: 0.6789 - val_acc: 0.5656
Epoch 39/300
 - 125s - loss: 0.8444 - acc: 0.5603 - val_loss: 0.6843 - val_acc: 0.5531
Epoch 40/300
 - 97s - loss: 0.8444 - acc: 0.5600 - val_loss: 0.6772 - val_acc: 0.5651
Epoch 41/300
 - 85s - loss: 0.8443 - acc: 0.5604 - val_loss: 0.6800 - val_acc: 0.5628
Epoch 42/300
 - 94s - loss: 0.8444 - acc: 0.5601 - val_loss: 0.6810 - val_acc: 0.5565
Epoch 43/300
 - 93s - loss: 0.8443 - acc: 0.5597 - val_loss: 0.6878 - val_acc: 0.5407
Epoch 00043: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 4.79e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                        bjet_aeta:                        -0.0087922                           0.99242   [                           -3.2510                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.596
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.021 (0.025)       0.182 (0.190)      0.441 (0.447)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.464580277246
auc= 0.596216112061
0.596216112061
this variable bjet_NeutralMultiplicity drops the AUC for Trial#== 4
bjet_NeutralMultiplicity  DROP AUC. we need it. Don't remove it from input variable list
no  bjet_NeutralMultiplicity -->AUC= 0.596216112061
AUC cut= 0.597
======
TEST-> bjet_aeta
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_aeta']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_25 (Dense)             (None, 128)               768       
_________________________________________________________________
batch_normalization_19 (Batc (None, 128)               512       
_________________________________________________________________
activation_25 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_19 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_26 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_20 (Batc (None, 128)               512       
_________________________________________________________________
activation_26 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_20 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_27 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_21 (Batc (None, 128)               512       
_________________________________________________________________
activation_27 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_21 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_28 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_28 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,586
Trainable params: 34,818
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000            -0.001
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000            -0.009
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    5 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 104s - loss: 0.8584 - acc: 0.5638 - val_loss: 0.6796 - val_acc: 0.5650
Epoch 2/300
 - 143s - loss: 0.8466 - acc: 0.5634 - val_loss: 0.6782 - val_acc: 0.5688
Epoch 3/300
 - 134s - loss: 0.8458 - acc: 0.5621 - val_loss: 0.6849 - val_acc: 0.5558
Epoch 4/300
 - 124s - loss: 0.8457 - acc: 0.5615 - val_loss: 0.6832 - val_acc: 0.5527
Epoch 5/300
 - 124s - loss: 0.8455 - acc: 0.5598 - val_loss: 0.6855 - val_acc: 0.5479
Epoch 6/300
 - 116s - loss: 0.8454 - acc: 0.5594 - val_loss: 0.6757 - val_acc: 0.5703
Epoch 7/300
 - 112s - loss: 0.8453 - acc: 0.5583 - val_loss: 0.6765 - val_acc: 0.5672
Epoch 8/300
 - 113s - loss: 0.8453 - acc: 0.5580 - val_loss: 0.6878 - val_acc: 0.5421
Epoch 9/300
 - 105s - loss: 0.8453 - acc: 0.5570 - val_loss: 0.6784 - val_acc: 0.5673
Epoch 10/300
 - 84s - loss: 0.8452 - acc: 0.5581 - val_loss: 0.6861 - val_acc: 0.5410
Epoch 11/300
 - 90s - loss: 0.8450 - acc: 0.5568 - val_loss: 0.6811 - val_acc: 0.5527
Epoch 12/300
 - 93s - loss: 0.8451 - acc: 0.5583 - val_loss: 0.6829 - val_acc: 0.5559
Epoch 13/300
 - 120s - loss: 0.8450 - acc: 0.5572 - val_loss: 0.6755 - val_acc: 0.5705
Epoch 14/300
 - 128s - loss: 0.8451 - acc: 0.5583 - val_loss: 0.6822 - val_acc: 0.5626
Epoch 15/300
 - 126s - loss: 0.8449 - acc: 0.5575 - val_loss: 0.6758 - val_acc: 0.5641
Epoch 16/300
 - 111s - loss: 0.8449 - acc: 0.5578 - val_loss: 0.6721 - val_acc: 0.5789
Epoch 17/300
 - 97s - loss: 0.8449 - acc: 0.5581 - val_loss: 0.6811 - val_acc: 0.5586
Epoch 18/300
 - 79s - loss: 0.8450 - acc: 0.5591 - val_loss: 0.6777 - val_acc: 0.5681
Epoch 19/300
 - 79s - loss: 0.8449 - acc: 0.5570 - val_loss: 0.6767 - val_acc: 0.5591
Epoch 20/300
 - 87s - loss: 0.8448 - acc: 0.5586 - val_loss: 0.6751 - val_acc: 0.5657
Epoch 21/300
 - 80s - loss: 0.8450 - acc: 0.5592 - val_loss: 0.6768 - val_acc: 0.5627
Epoch 22/300
 - 84s - loss: 0.8450 - acc: 0.5588 - val_loss: 0.6783 - val_acc: 0.5664
Epoch 23/300
 - 97s - loss: 0.8449 - acc: 0.5605 - val_loss: 0.6794 - val_acc: 0.5600
Epoch 24/300
 - 109s - loss: 0.8449 - acc: 0.5596 - val_loss: 0.6838 - val_acc: 0.5526
Epoch 25/300
 - 121s - loss: 0.8449 - acc: 0.5597 - val_loss: 0.6819 - val_acc: 0.5639
Epoch 26/300
 - 123s - loss: 0.8449 - acc: 0.5598 - val_loss: 0.6900 - val_acc: 0.5407
Epoch 27/300
 - 103s - loss: 0.8449 - acc: 0.5596 - val_loss: 0.6823 - val_acc: 0.5559
Epoch 28/300
 - 96s - loss: 0.8449 - acc: 0.5585 - val_loss: 0.6779 - val_acc: 0.5632
Epoch 29/300
 - 92s - loss: 0.8448 - acc: 0.5594 - val_loss: 0.6778 - val_acc: 0.5600
Epoch 30/300
 - 80s - loss: 0.8449 - acc: 0.5578 - val_loss: 0.6759 - val_acc: 0.5700
Epoch 31/300
 - 85s - loss: 0.8448 - acc: 0.5601 - val_loss: 0.6758 - val_acc: 0.5687
Epoch 32/300
 - 93s - loss: 0.8448 - acc: 0.5597 - val_loss: 0.6856 - val_acc: 0.5451
Epoch 33/300
 - 98s - loss: 0.8447 - acc: 0.5585 - val_loss: 0.6855 - val_acc: 0.5471
Epoch 34/300
 - 99s - loss: 0.8447 - acc: 0.5596 - val_loss: 0.6836 - val_acc: 0.5463
Epoch 35/300
 - 105s - loss: 0.8447 - acc: 0.5616 - val_loss: 0.6896 - val_acc: 0.5390
Epoch 36/300
 - 127s - loss: 0.8448 - acc: 0.5590 - val_loss: 0.6783 - val_acc: 0.5636
Epoch 37/300
 - 116s - loss: 0.8447 - acc: 0.5590 - val_loss: 0.6835 - val_acc: 0.5493
Epoch 38/300
 - 102s - loss: 0.8447 - acc: 0.5592 - val_loss: 0.6668 - val_acc: 0.5850
Epoch 39/300
 - 87s - loss: 0.8447 - acc: 0.5582 - val_loss: 0.6857 - val_acc: 0.5478
Epoch 40/300
 - 87s - loss: 0.8448 - acc: 0.5600 - val_loss: 0.6698 - val_acc: 0.5783
Epoch 41/300
 - 87s - loss: 0.8448 - acc: 0.5591 - val_loss: 0.6727 - val_acc: 0.5728
Epoch 42/300
 - 76s - loss: 0.8448 - acc: 0.5597 - val_loss: 0.6936 - val_acc: 0.5422
Epoch 43/300
 - 78s - loss: 0.8447 - acc: 0.5609 - val_loss: 0.6768 - val_acc: 0.5672
Epoch 44/300
 - 77s - loss: 0.8447 - acc: 0.5618 - val_loss: 0.6780 - val_acc: 0.5658
Epoch 45/300
 - 96s - loss: 0.8448 - acc: 0.5598 - val_loss: 0.6837 - val_acc: 0.5515
Epoch 46/300
 - 94s - loss: 0.8448 - acc: 0.5600 - val_loss: 0.6826 - val_acc: 0.5560
Epoch 47/300
 - 96s - loss: 0.8447 - acc: 0.5592 - val_loss: 0.6845 - val_acc: 0.5525
Epoch 48/300
 - 98s - loss: 0.8447 - acc: 0.5592 - val_loss: 0.6993 - val_acc: 0.5381
Epoch 49/300
 - 91s - loss: 0.8447 - acc: 0.5600 - val_loss: 0.6735 - val_acc: 0.5706
Epoch 50/300
 - 97s - loss: 0.8447 - acc: 0.5588 - val_loss: 0.6799 - val_acc: 0.5668
Epoch 51/300
 - 108s - loss: 0.8447 - acc: 0.5595 - val_loss: 0.6814 - val_acc: 0.5612
Epoch 52/300
 - 120s - loss: 0.8447 - acc: 0.5594 - val_loss: 0.6847 - val_acc: 0.5497
Epoch 53/300
 - 114s - loss: 0.8448 - acc: 0.5605 - val_loss: 0.6748 - val_acc: 0.5764
Epoch 54/300
 - 113s - loss: 0.8446 - acc: 0.5593 - val_loss: 0.6804 - val_acc: 0.5542
Epoch 55/300
 - 99s - loss: 0.8448 - acc: 0.5601 - val_loss: 0.6714 - val_acc: 0.5872
Epoch 56/300
 - 82s - loss: 0.8446 - acc: 0.5597 - val_loss: 0.6750 - val_acc: 0.5725
Epoch 57/300
 - 78s - loss: 0.8448 - acc: 0.5602 - val_loss: 0.6833 - val_acc: 0.5524
Epoch 58/300
 - 75s - loss: 0.8447 - acc: 0.5590 - val_loss: 0.6796 - val_acc: 0.5571
Epoch 59/300
 - 75s - loss: 0.8448 - acc: 0.5598 - val_loss: 0.6886 - val_acc: 0.5396
Epoch 60/300
 - 68s - loss: 0.8448 - acc: 0.5594 - val_loss: 0.6843 - val_acc: 0.5541
Epoch 61/300
 - 71s - loss: 0.8449 - acc: 0.5600 - val_loss: 0.6708 - val_acc: 0.5761
Epoch 62/300
 - 73s - loss: 0.8448 - acc: 0.5597 - val_loss: 0.6757 - val_acc: 0.5668
Epoch 63/300
 - 83s - loss: 0.8447 - acc: 0.5603 - val_loss: 0.6872 - val_acc: 0.5474
Epoch 64/300
 - 87s - loss: 0.8447 - acc: 0.5596 - val_loss: 0.6733 - val_acc: 0.5759
Epoch 65/300
 - 91s - loss: 0.8448 - acc: 0.5598 - val_loss: 0.6823 - val_acc: 0.5572
Epoch 66/300
 - 94s - loss: 0.8447 - acc: 0.5599 - val_loss: 0.6770 - val_acc: 0.5626
Epoch 67/300
 - 97s - loss: 0.8447 - acc: 0.5597 - val_loss: 0.6856 - val_acc: 0.5443
Epoch 68/300
 - 87s - loss: 0.8447 - acc: 0.5601 - val_loss: 0.6873 - val_acc: 0.5460
Epoch 00068: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 6.67e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.594
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.022 (0.023)       0.182 (0.186)      0.438 (0.443)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.478042777628
auc= 0.593788457447
0.593788457447
this variable bjet_aeta drops the AUC for Trial#== 2
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_aeta']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_29 (Dense)             (None, 128)               768       
_________________________________________________________________
batch_normalization_22 (Batc (None, 128)               512       
_________________________________________________________________
activation_29 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_22 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_30 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_23 (Batc (None, 128)               512       
_________________________________________________________________
activation_30 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_23 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_31 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_24 (Batc (None, 128)               512       
_________________________________________________________________
activation_31 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_24 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_32 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_32 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,586
Trainable params: 34,818
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000            -0.001
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000            -0.009
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    5 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 62s - loss: 0.8585 - acc: 0.5629 - val_loss: 0.6892 - val_acc: 0.5495
Epoch 2/300
 - 63s - loss: 0.8466 - acc: 0.5629 - val_loss: 0.6910 - val_acc: 0.5403
Epoch 3/300
 - 68s - loss: 0.8458 - acc: 0.5608 - val_loss: 0.6731 - val_acc: 0.5691
Epoch 4/300
 - 74s - loss: 0.8454 - acc: 0.5594 - val_loss: 0.6683 - val_acc: 0.5855
Epoch 5/300
 - 78s - loss: 0.8453 - acc: 0.5600 - val_loss: 0.6804 - val_acc: 0.5601
Epoch 6/300
 - 79s - loss: 0.8454 - acc: 0.5597 - val_loss: 0.6763 - val_acc: 0.5674
Epoch 7/300
 - 84s - loss: 0.8454 - acc: 0.5581 - val_loss: 0.6870 - val_acc: 0.5393
Epoch 8/300
 - 76s - loss: 0.8454 - acc: 0.5577 - val_loss: 0.6789 - val_acc: 0.5539
Epoch 9/300
 - 69s - loss: 0.8452 - acc: 0.5581 - val_loss: 0.6881 - val_acc: 0.5473
Epoch 10/300
 - 69s - loss: 0.8451 - acc: 0.5578 - val_loss: 0.6776 - val_acc: 0.5643
Epoch 11/300
 - 71s - loss: 0.8452 - acc: 0.5583 - val_loss: 0.6937 - val_acc: 0.5327
Epoch 12/300
 - 69s - loss: 0.8449 - acc: 0.5587 - val_loss: 0.6867 - val_acc: 0.5452
Epoch 13/300
 - 73s - loss: 0.8450 - acc: 0.5586 - val_loss: 0.6787 - val_acc: 0.5647
Epoch 14/300
 - 67s - loss: 0.8451 - acc: 0.5585 - val_loss: 0.6831 - val_acc: 0.5537
Epoch 15/300
 - 67s - loss: 0.8449 - acc: 0.5583 - val_loss: 0.6833 - val_acc: 0.5512
Epoch 16/300
 - 69s - loss: 0.8449 - acc: 0.5581 - val_loss: 0.6876 - val_acc: 0.5370
Epoch 17/300
 - 65s - loss: 0.8449 - acc: 0.5593 - val_loss: 0.6868 - val_acc: 0.5395
Epoch 18/300
 - 65s - loss: 0.8449 - acc: 0.5588 - val_loss: 0.6830 - val_acc: 0.5515
Epoch 19/300
 - 64s - loss: 0.8450 - acc: 0.5592 - val_loss: 0.6819 - val_acc: 0.5545
Epoch 20/300
 - 75s - loss: 0.8449 - acc: 0.5586 - val_loss: 0.6940 - val_acc: 0.5294
Epoch 21/300
 - 80s - loss: 0.8449 - acc: 0.5591 - val_loss: 0.6763 - val_acc: 0.5668
Epoch 22/300
 - 78s - loss: 0.8449 - acc: 0.5592 - val_loss: 0.6819 - val_acc: 0.5595
Epoch 23/300
 - 86s - loss: 0.8450 - acc: 0.5594 - val_loss: 0.6937 - val_acc: 0.5182
Epoch 24/300
 - 85s - loss: 0.8450 - acc: 0.5580 - val_loss: 0.6770 - val_acc: 0.5621
Epoch 25/300
 - 84s - loss: 0.8449 - acc: 0.5571 - val_loss: 0.6810 - val_acc: 0.5507
Epoch 26/300
 - 72s - loss: 0.8448 - acc: 0.5580 - val_loss: 0.6746 - val_acc: 0.5664
Epoch 27/300
 - 63s - loss: 0.8447 - acc: 0.5593 - val_loss: 0.6834 - val_acc: 0.5415
Epoch 28/300
 - 63s - loss: 0.8449 - acc: 0.5579 - val_loss: 0.6789 - val_acc: 0.5665
Epoch 29/300
 - 64s - loss: 0.8448 - acc: 0.5584 - val_loss: 0.6758 - val_acc: 0.5684
Epoch 30/300
 - 61s - loss: 0.8448 - acc: 0.5586 - val_loss: 0.6744 - val_acc: 0.5762
Epoch 31/300
 - 66s - loss: 0.8447 - acc: 0.5599 - val_loss: 0.6778 - val_acc: 0.5620
Epoch 32/300
 - 69s - loss: 0.8447 - acc: 0.5584 - val_loss: 0.6878 - val_acc: 0.5344
Epoch 33/300
 - 70s - loss: 0.8449 - acc: 0.5588 - val_loss: 0.6856 - val_acc: 0.5486
Epoch 34/300
 - 76s - loss: 0.8448 - acc: 0.5595 - val_loss: 0.6821 - val_acc: 0.5540
Epoch 00034: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 2.44e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.596
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.021 (0.025)       0.184 (0.189)      0.441 (0.444)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.479914265565
auc= 0.596037989492
0.596037989492
this variable bjet_aeta drops the AUC for Trial#== 3
--SKIP FOLLOWING VARS
['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction', 'bjet_aeta']
sigcut-> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
bkgcut-> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
<sig cut>= (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
<bkg cut>= (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_33 (Dense)             (None, 128)               768       
_________________________________________________________________
batch_normalization_25 (Batc (None, 128)               512       
_________________________________________________________________
activation_33 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_25 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_34 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_26 (Batc (None, 128)               512       
_________________________________________________________________
activation_34 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_26 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_35 (Dense)             (None, 128)               16512     
_________________________________________________________________
batch_normalization_27 (Batc (None, 128)               512       
_________________________________________________________________
activation_35 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_27 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_36 (Dense)             (None, 2)                 258       
_________________________________________________________________
activation_36 (Activation)   (None, 2)                 0         
=================================================================
Total params: 35,586
Trainable params: 34,818
Non-trainable params: 768
_________________________________________________________________
---sig_test---
<self.testtree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
--bkg_test---
<self.testtree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToEE_MiNNLO.root
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJetsToMuMu_MiNNLO.root
---sig_train---
<self.traintree_sig> OutTree/sig
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
---bkg_train---
<self.traintree_bkg> OutTree/bkg
/data6/Users/jhchoi/TMVA/TMVA_TOOL/inputs/EEMu_MuMuE_Method/v2405.4/2016preVFP/EEMu_MuMuE_Method_DYJets.root
DataSetInfo              : [jet_test] : Added class "Signal"
                         : Add Tree OutTree/sig of type Signal with 473146 events
                         : Add Tree OutTree/sig of type Signal with 537532 events
DataSetInfo              : [jet_test] : Added class "Background"
                         : Add Tree OutTree/bkg of type Background with 338692 events
                         : Add Tree OutTree/bkg of type Background with 384801 events
>>>>self.dataloader.PrepareTrainingAndTestTree
Set sig cut -> (bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)
Set bkg cut -> (bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)
Factory                  : Booking method: [1mDNN[0m
                         : 
DNN                      : [jet_test] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
DNN                      : [jet_test] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
                         : Load model from file: model.h5
Factory                  : [1mTrain all methods[0m
DataSetFactory           : [jet_test] : Number of events in input trees
                         : Dataset[jet_test] :     Signal     requirement: "(bjet_charge*bjet_partonFlavour < 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Signal          -- number of events passed: 904729  / sum of weights: 904729
                         : Dataset[jet_test] :     Signal          -- efficiency             : 0.89517
                         : Dataset[jet_test] :     Background requirement: "(bjet_charge*bjet_partonFlavour > 0)&&(!Has_bElectron)&&(!Has_bMuon)"
                         : Dataset[jet_test] :     Background      -- number of events passed: 555834  / sum of weights: 555834
                         : Dataset[jet_test] :     Background      -- efficiency             : 0.768265
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] :  you have opted for interpreting the requested number of training/testing events
                         :  to be the number of events AFTER your preselection cuts
                         : 
                         : Dataset[jet_test] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[jet_test] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[jet_test] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[jet_test] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[jet_test] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[jet_test] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 492212
                         : Signal     -- testing events             : 412517
                         : Signal     -- training and testing events: 904729
                         : Dataset[jet_test] : Signal     -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.89517
                         : Background -- training events            : 299533
                         : Background -- testing events             : 256301
                         : Background -- training and testing events: 555834
                         : Dataset[jet_test] : Background -- due to the preselection a scaling factor has been applied to the numbers of requested events: 0.768265
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.063                   -0.355  -0.040            +0.162
                         :     bjet_ChargedEmEnergyFraction:                           -0.063                       +1.000                   -0.083  -0.028            +0.089
                         :         bjet_ChargedMultiplicity:                           -0.355                       -0.083                   +1.000  +0.321            -0.338
                         :                          bjet_pt:                           -0.040                       -0.028                   +0.321  +1.000            -0.001
                         :                fabs(bjet_charge):                           +0.162                       +0.089                   -0.338  -0.001            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
                         :                                   bjet_NeutralHadronEnergyFraction bjet_ChargedEmEnergyFraction bjet_ChargedMultiplicity bjet_pt fabs(bjet_charge)
                         : bjet_NeutralHadronEnergyFraction:                           +1.000                       -0.065                   -0.431  -0.048            +0.301
                         :     bjet_ChargedEmEnergyFraction:                           -0.065                       +1.000                   -0.055  -0.007            +0.051
                         :         bjet_ChargedMultiplicity:                           -0.431                       -0.055                   +1.000  +0.316            -0.365
                         :                          bjet_pt:                           -0.048                       -0.007                   +0.316  +1.000            -0.009
                         :                fabs(bjet_charge):                           +0.301                       +0.051                   -0.365  -0.009            +1.000
                         : --------------------------------------------------------------------------------------------------------------------------------------------------
DataSetFactory           : [jet_test] :  
                         : 
Factory                  : [jet_test] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'bjet_NeutralHadronEnergyFraction' <---> Output : variable 'bjet_NeutralHadronEnergyFraction'
                         : Input : variable 'bjet_ChargedEmEnergyFraction' <---> Output : variable 'bjet_ChargedEmEnergyFraction'
                         : Input : variable 'bjet_ChargedMultiplicity' <---> Output : variable 'bjet_ChargedMultiplicity'
                         : Input : variable 'bjet_pt' <---> Output : variable 'bjet_pt'
                         : Input : variable 'fabs(bjet_charge)' <---> Output : variable 'fabs(bjet_charge)'
TFHandler_Factory        :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                           0.12781                           0.14793   [                            0.0000                            1.0000 ]
                         :     bjet_ChargedEmEnergyFraction:                          0.038120                           0.11661   [                            0.0000                            1.0000 ]
                         :         bjet_ChargedMultiplicity:                            9.5292                            3.9138   [                            0.0000                            49.000 ]
                         :                          bjet_pt:                            60.449                            35.380   [                            30.000                            1226.8 ]
                         :                fabs(bjet_charge):                           0.30021                           0.23275   [                        3.1119e-08                            1.0000 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : ---------------------------------------------------------
                         : Rank : Variable                         : Separation
                         : ---------------------------------------------------------
                         :    1 : fabs(bjet_charge)                : 2.740e-02
                         :    2 : bjet_NeutralHadronEnergyFraction : 2.787e-03
                         :    3 : bjet_ChargedMultiplicity         : 2.675e-03
                         :    4 : bjet_ChargedEmEnergyFraction     : 1.209e-03
                         :    5 : bjet_pt                          : 7.186e-05
                         : ---------------------------------------------------------
Factory                  : Train method: DNN for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ DNN ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Gaussian transformation...
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56014                            1.5233   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.2850                            1.0593   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                        -0.0072674                            1.0081   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                         0.0026765                           0.99566   [                           -3.1255                            5.7307 ]
                         :                fabs(bjet_charge):                           0.12170                            1.2801   [                           -3.2406                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : Option TriesEarlyStopping: Training will stop after 30 number of epochs with no improvement of validation loss
Train on 791745 samples, validate on 668818 samples
Epoch 1/300
 - 74s - loss: 0.8582 - acc: 0.5638 - val_loss: 0.6854 - val_acc: 0.5575
Epoch 2/300
 - 74s - loss: 0.8465 - acc: 0.5621 - val_loss: 0.6816 - val_acc: 0.5576
Epoch 3/300
 - 71s - loss: 0.8458 - acc: 0.5614 - val_loss: 0.6898 - val_acc: 0.5329
Epoch 4/300
 - 73s - loss: 0.8456 - acc: 0.5599 - val_loss: 0.6960 - val_acc: 0.5319
Epoch 5/300
 - 66s - loss: 0.8453 - acc: 0.5602 - val_loss: 0.6884 - val_acc: 0.5377
Epoch 6/300
 - 65s - loss: 0.8452 - acc: 0.5584 - val_loss: 0.6796 - val_acc: 0.5674
Epoch 7/300
 - 64s - loss: 0.8452 - acc: 0.5587 - val_loss: 0.6812 - val_acc: 0.5556
Epoch 8/300
 - 64s - loss: 0.8453 - acc: 0.5578 - val_loss: 0.6715 - val_acc: 0.5727
Epoch 9/300
 - 67s - loss: 0.8452 - acc: 0.5571 - val_loss: 0.6863 - val_acc: 0.5497
Epoch 10/300
 - 70s - loss: 0.8451 - acc: 0.5592 - val_loss: 0.6817 - val_acc: 0.5597
Epoch 11/300
 - 75s - loss: 0.8452 - acc: 0.5590 - val_loss: 0.6867 - val_acc: 0.5455
Epoch 12/300
 - 73s - loss: 0.8452 - acc: 0.5590 - val_loss: 0.6826 - val_acc: 0.5506
Epoch 13/300
 - 71s - loss: 0.8449 - acc: 0.5582 - val_loss: 0.6918 - val_acc: 0.5381
Epoch 14/300
 - 65s - loss: 0.8449 - acc: 0.5583 - val_loss: 0.6793 - val_acc: 0.5626
Epoch 15/300
 - 61s - loss: 0.8449 - acc: 0.5596 - val_loss: 0.6882 - val_acc: 0.5381
Epoch 16/300
 - 64s - loss: 0.8450 - acc: 0.5578 - val_loss: 0.6767 - val_acc: 0.5722
Epoch 17/300
 - 65s - loss: 0.8449 - acc: 0.5581 - val_loss: 0.6807 - val_acc: 0.5539
Epoch 18/300
 - 62s - loss: 0.8448 - acc: 0.5580 - val_loss: 0.6882 - val_acc: 0.5492
Epoch 19/300
 - 70s - loss: 0.8448 - acc: 0.5580 - val_loss: 0.6857 - val_acc: 0.5472
Epoch 20/300
 - 73s - loss: 0.8448 - acc: 0.5582 - val_loss: 0.6760 - val_acc: 0.5678
Epoch 21/300
 - 78s - loss: 0.8448 - acc: 0.5585 - val_loss: 0.6709 - val_acc: 0.5721
Epoch 22/300
 - 80s - loss: 0.8449 - acc: 0.5583 - val_loss: 0.6749 - val_acc: 0.5743
Epoch 23/300
 - 83s - loss: 0.8449 - acc: 0.5592 - val_loss: 0.6817 - val_acc: 0.5573
Epoch 24/300
 - 76s - loss: 0.8449 - acc: 0.5591 - val_loss: 0.6717 - val_acc: 0.5781
Epoch 25/300
 - 72s - loss: 0.8448 - acc: 0.5595 - val_loss: 0.6793 - val_acc: 0.5619
Epoch 26/300
 - 65s - loss: 0.8449 - acc: 0.5589 - val_loss: 0.6744 - val_acc: 0.5704
Epoch 27/300
 - 64s - loss: 0.8448 - acc: 0.5597 - val_loss: 0.6875 - val_acc: 0.5446
Epoch 28/300
 - 66s - loss: 0.8448 - acc: 0.5589 - val_loss: 0.6770 - val_acc: 0.5630
Epoch 29/300
 - 67s - loss: 0.8447 - acc: 0.5594 - val_loss: 0.6814 - val_acc: 0.5499
Epoch 30/300
 - 74s - loss: 0.8448 - acc: 0.5592 - val_loss: 0.6797 - val_acc: 0.5646
Epoch 31/300
 - 74s - loss: 0.8448 - acc: 0.5618 - val_loss: 0.6835 - val_acc: 0.5508
Epoch 32/300
 - 75s - loss: 0.8447 - acc: 0.5609 - val_loss: 0.6820 - val_acc: 0.5480
Epoch 33/300
 - 68s - loss: 0.8449 - acc: 0.5598 - val_loss: 0.6725 - val_acc: 0.5670
Epoch 34/300
 - 68s - loss: 0.8447 - acc: 0.5605 - val_loss: 0.6845 - val_acc: 0.5544
Epoch 35/300
 - 66s - loss: 0.8448 - acc: 0.5606 - val_loss: 0.6791 - val_acc: 0.5617
Epoch 36/300
 - 62s - loss: 0.8448 - acc: 0.5608 - val_loss: 0.6784 - val_acc: 0.5632
Epoch 37/300
 - 65s - loss: 0.8449 - acc: 0.5588 - val_loss: 0.6738 - val_acc: 0.5774
Epoch 38/300
 - 68s - loss: 0.8448 - acc: 0.5582 - val_loss: 0.6843 - val_acc: 0.5580
Epoch 39/300
 - 64s - loss: 0.8447 - acc: 0.5582 - val_loss: 0.6759 - val_acc: 0.5704
Epoch 40/300
 - 65s - loss: 0.8448 - acc: 0.5598 - val_loss: 0.6762 - val_acc: 0.5648
Epoch 41/300
 - 66s - loss: 0.8447 - acc: 0.5597 - val_loss: 0.6900 - val_acc: 0.5371
Epoch 42/300
 - 66s - loss: 0.8447 - acc: 0.5594 - val_loss: 0.6916 - val_acc: 0.5398
Epoch 43/300
 - 69s - loss: 0.8447 - acc: 0.5588 - val_loss: 0.6753 - val_acc: 0.5703
Epoch 44/300
 - 78s - loss: 0.8447 - acc: 0.5606 - val_loss: 0.6964 - val_acc: 0.5148
Epoch 45/300
 - 73s - loss: 0.8447 - acc: 0.5609 - val_loss: 0.6823 - val_acc: 0.5534
Epoch 46/300
 - 67s - loss: 0.8446 - acc: 0.5595 - val_loss: 0.6819 - val_acc: 0.5524
Epoch 47/300
 - 66s - loss: 0.8447 - acc: 0.5591 - val_loss: 0.6848 - val_acc: 0.5445
Epoch 48/300
 - 61s - loss: 0.8447 - acc: 0.5589 - val_loss: 0.6842 - val_acc: 0.5531
Epoch 49/300
 - 62s - loss: 0.8448 - acc: 0.5588 - val_loss: 0.6825 - val_acc: 0.5535
Epoch 50/300
 - 65s - loss: 0.8447 - acc: 0.5590 - val_loss: 0.6799 - val_acc: 0.5611
Epoch 51/300
 - 70s - loss: 0.8446 - acc: 0.5586 - val_loss: 0.6819 - val_acc: 0.5516
Epoch 00051: early stopping
                         : Trained model written to file: jet_test/weights/TrainedModel_DNN.h5
                         : Elapsed time for training with 791745 events: 3.52e+03 sec         
                         : Creating xml weight file: [0;36mjet_test/weights/jet_test_DNN.weights.xml[0m
                         : Creating standalone class: [0;36mjet_test/weights/jet_test_DNN.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : [1mTest all methods[0m
Factory                  : Test method: DNN for Classification performance
                         : 
                         : Load model from file: jet_test/weights/TrainedModel_DNN.h5
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: DNN
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DNN                      : [jet_test] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_DNN            :                         Variable                                Mean                                RMS                        [        Min                                Max ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : bjet_NeutralHadronEnergyFraction:                          -0.56583                            1.5117   [                           -3.2243                            5.7307 ]
                         :     bjet_ChargedEmEnergyFraction:                           -2.3016                            1.0513   [                           -2.7091                            5.7307 ]
                         :         bjet_ChargedMultiplicity:                          0.020091                            1.0203   [                           -3.1869                            5.7307 ]
                         :                          bjet_pt:                          0.095921                            1.0250   [                           -3.1267                            5.7307 ]
                         :                fabs(bjet_charge):                           0.15400                            1.2700   [                           -3.2397                            5.7307 ]
                         : -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : jet_test      DNN            : 0.596
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : jet_test             DNN            : 0.023 (0.024)       0.184 (0.190)      0.440 (0.445)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:jet_test         : Created tree 'TestTree' with 668818 events
                         : 
Dataset:jet_test         : Created tree 'TrainTree' with 791745 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
ref.cut= DNN 0.479050611874
auc= 0.595983418965
0.595983418965
this variable bjet_aeta drops the AUC for Trial#== 4
bjet_aeta  DROP AUC. we need it. Don't remove it from input variable list
no  bjet_aeta -->AUC= 0.595983418965
AUC cut= 0.597
rmlist=> ['bjet_ChargedHadronEnergyFraction', 'bjet_NeutralEmEnergyFraction', 'bjet_MuonEnergyFraction']
/data6/Users/jhchoi/TMVA/TMVA_TOOL/Remove_Unnecessary2
